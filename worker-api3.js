const a31_0x3bcd29=a31_0x426c;(function(_0xa24d88,_0x19e0e4){const _0x2d877b=a31_0x426c,_0x106a73=_0xa24d88();while(!![]){try{const _0x31c205=parseInt(_0x2d877b(0x9b))/0x1+parseInt(_0x2d877b(0xef))/0x2*(-parseInt(_0x2d877b(0xb2))/0x3)+parseInt(_0x2d877b(0xac))/0x4*(parseInt(_0x2d877b(0xdc))/0x5)+parseInt(_0x2d877b(0xa0))/0x6+-parseInt(_0x2d877b(0xe9))/0x7*(-parseInt(_0x2d877b(0xad))/0x8)+-parseInt(_0x2d877b(0x96))/0x9+-parseInt(_0x2d877b(0xb8))/0xa;if(_0x31c205===_0x19e0e4)break;else _0x106a73['push'](_0x106a73['shift']());}catch(_0x1b6678){_0x106a73['push'](_0x106a73['shift']());}}}(a31_0x3b59,0x80fb6),require(a31_0x3bcd29(0x8d))['config']());function a31_0x3b59(){const _0x4aac08=['getBotAll','[checkTeleWebOpen]:\x20Thực\x20thi\x20script\x20','loop',']:\x20Sai\x20aks\x20','elementExistsByXPath','[checkTeleWebOpen]:\x20Thực\x20thi\x20','APIKEY','nextRun','api','[xuLyProfile]:đã\x20bị\x20hủy',']:\x20Bot\x20','dotenv','addData','path','coin','Tìm','[xuLyProfile]:\x20Thử\x20lần\x20','date','[xuLyGame]:Max\x20loop\x20rồi\x20bro','[checkTeleWebOpen]:\x20Không\x20thực\x20thi\x20script\x20','64737EBgFCh','split','[xuLyProfile]:\x20Đang\x20mở\x20profile\x20','SERVER_HOST','./modules/Genlogin','1045492vpTkdp','\x20không\x20trả\x20về\x20status','[xuLyProfile]:\x20Đang\x20mở\x20trình\x20duyệt...','./modules/http','[xuLyProfile]:\x20Lỗi\x20chung\x20xuLyProfile:\x20','1369170bmlAHx',']:\x20XONG\x201\x20LƯỢT','.js','[checkTeleWebOpen]:\x20','[xuLyGame]:\x20checkTeleWebOpen\x20OK','running','[xuLyProfile]:\x20Processing\x20profile:\x20','join','nextRunTime','[xuLyGame]:\x20Loop\x20lại\x20,\x20loop\x20lại\x20lần\x20','length','default','1556JessJu','16LNQeRl','./modules/logger','[loadGame]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','[xuLyGame]:\x20Thực\x20thi\x20','\x20loop','3bYYWdI','[worker-api3]:timeout','env','Fail','\x20lỗi','[loadGame]:\x20Script\x20','23855890NISUwi','[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy','[xuLyGame]:\x20getAks\x20OK','stack','stringify','\x20done','aks','[checkTeleWebOpen]:\x20vào\x20loadGame','timGame','message','[xuLyProfile]:\x20Profile\x20đã\x20chạy\x20thành\x20công\x20với\x20wsEndpoint:','updateData','[xuLyBrowser]:đã\x20bị\x20hủy','\x20Script\x20mode','[xuLyGame]:đã\x20bị\x20hủy','checkProfileIsRun','\x20có\x20lỗi','nextRunStamp','aborted','Vào','\x20Tele\x20K\x20OK','\x20Web\x20OK','postMessage','[xuLyGame]:\x20checkTeleWebOpen\x20có\x20gì\x20đó\x20sai\x20sai\x20rồi\x20bro','activateTab','FistUrl','timestamp','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','status','https://www.google.com','[\x27worker-api3][',']:\x20','No\x20bot\x20found','timeout','[loadGame]:đã\x20bị\x20hủy','8605KLEsgc','nowTime','[loadGame]:\x20Chạy\x20','type','value','openUrl','Done','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','loop\x20new\x20game','[checkTeleWebOpen]:\x20Không\x20tìm\x20thấy\x20game\x20','\x20thất\x20bại','\x20Api\x20mode','[xuLyGame]:\x20','3496206gmevAp','[xuLyProfile]:\x20wsEndpoint:\x20','Start','worker_threads','\x20để\x20kiểm\x20tra\x20wsEndpoint...','name','41960lkgSnE','\x20ko\x20có\x20aks','end','StartApi'];a31_0x3b59=function(){return _0x4aac08;};return a31_0x3b59();}const {Worker,parentPort}=require(a31_0x3bcd29(0xec)),{log,json}=require(a31_0x3bcd29(0xae)),Genlogin=require(a31_0x3bcd29(0x9a)),httpPost=require(a31_0x3bcd29(0x9e)),path=require(a31_0x3bcd29(0x8f)),PQueue=require('p-queue')[a31_0x3bcd29(0xab)],gameQueue=new PQueue({'concurrency':0x2});function a31_0x426c(_0x524351,_0x5da77b){const _0x3b5921=a31_0x3b59();return a31_0x426c=function(_0x426c28,_0x478b1c){_0x426c28=_0x426c28-0x81;let _0x41bfb0=_0x3b5921[_0x426c28];return _0x41bfb0;},a31_0x426c(_0x524351,_0x5da77b);}let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process['env'][a31_0x3bcd29(0x99)],process[a31_0x3bcd29(0xb4)][a31_0x3bcd29(0x88)],!![]);let signal={'aborted':![]};parentPort['on'](a31_0x3bcd29(0xc2),async({profile:_0x10282})=>{const _0x2475a4=a31_0x3bcd29;try{if(_0x10282==_0x2475a4(0xda))signal[_0x2475a4(0xcb)]=!![],log(_0x2475a4(0xb3),null,'w');else{if(signal[_0x2475a4(0xcb)])throw new Error(_0x2475a4(0xda));log(_0x2475a4(0xd7)+_0x10282+']:\x20Api\x20Mode',null,'w');const _0x599480=await xuLyProfile(_0x10282);!_0x599480?(log(_0x2475a4(0xe3)+_0x10282+_0x2475a4(0xc9),null,'w'),parentPort[_0x2475a4(0xcf)]({'success':![],'result':_0x599480})):(log('[xuLyProfile]:\x20Xử\x20lý\x20profile\x20'+_0x10282+'\x20thành\x20công',null,'i'),parentPort[_0x2475a4(0xcf)]({'success':!![],'result':_0x599480}));}}catch(_0x753157){parentPort[_0x2475a4(0xcf)]({'success':![],'error':{'message':_0x753157[_0x2475a4(0xc2)],'stack':_0x753157[_0x2475a4(0xbc)]}});}});async function xuLyProfile(_0x19a53a){const _0x38de5b=a31_0x3bcd29;try{if(signal[_0x38de5b(0xcb)]){log(_0x38de5b(0x8b),null,'w');throw new Error(_0x38de5b(0xda));}profileNameId=_0x19a53a,log(_0x38de5b(0xa6)+JSON[_0x38de5b(0xbd)](_0x19a53a),null,'i');const _0x3194c2=await xuLyBrowser(_0x19a53a);return!_0x3194c2?(log(_0x38de5b(0xd4)+_0x19a53a+_0x38de5b(0xe6),null,'w'),null):(log(_0x38de5b(0xd4)+_0x19a53a+'\x20thành\x20công'),!![]);}catch(_0x56e471){throw new Error('Lỗi\x20xử\x20lý\x20profile:\x20'+_0x56e471[_0x38de5b(0xc2)]);}}async function xuLyEndPoint(_0x35f0d2){const _0x1a5067=a31_0x3bcd29;try{if(signal[_0x1a5067(0xcb)]){log(_0x1a5067(0x8b),null,'w');throw new Error(_0x1a5067(0xda));}const _0x217511=_0x35f0d2[_0x1a5067(0x97)]('-')[0x1];profileId=_0x217511;let {wsEndpoint:_0x4ef3f3}=await genlogin[_0x1a5067(0xc8)](_0x217511);if(signal[_0x1a5067(0xcb)]){log(_0x1a5067(0x8b),null,'w');throw new Error('timeout');}log(_0x1a5067(0xea)+json(_0x4ef3f3),null,'i');if(!_0x4ef3f3){log(_0x1a5067(0x98)+_0x217511+'\x20is\x20not\x20running',null,'i'),await genlogin['runProfile'](_0x217511);for(let _0x218250=0x0;_0x218250<0x5;_0x218250++){if(signal[_0x1a5067(0xcb)]){log(_0x1a5067(0x8b),null,'w');throw new Error(_0x1a5067(0xda));}log(_0x1a5067(0x92)+(_0x218250+0x1)+_0x1a5067(0xed),null,'i'),await delay(0x1388);if(signal[_0x1a5067(0xcb)]){log(_0x1a5067(0x8b),null,'w');throw new Error(_0x1a5067(0xda));}({wsEndpoint:_0x4ef3f3}=await genlogin[_0x1a5067(0xc8)](_0x217511));if(signal['aborted']){log(_0x1a5067(0x8b),null,'w');throw new Error(_0x1a5067(0xda));}if(_0x4ef3f3){log(_0x1a5067(0xc3)+_0x4ef3f3);break;}}if(!_0x4ef3f3)return log('[xuLyProfile]:\x20Không\x20thể\x20lấy\x20được\x20wsEndpoint\x20sau\x205\x20lần\x20thử',null,![]),![];}const _0x5befe9=_0x35f0d2;return await delay(0xbb8),log(_0x1a5067(0x9d),null,'i'),log(_0x1a5067(0xea)+_0x4ef3f3,null,'i'),_0x4ef3f3;}catch(_0x436248){log(_0x1a5067(0x9f)+_0x436248,null,![]);}}async function xuLyBrowser(_0x15591a){const _0x5f314b=a31_0x3bcd29;try{if(signal[_0x5f314b(0xcb)]){log(_0x5f314b(0xc5),null,'w');throw new Error(_0x5f314b(0xda));}let _0x38c5fd=0x0;const _0x195415=await http[_0x5f314b(0x82)](profileNameId);if(!_0x195415){log(_0x5f314b(0xba),null,![]);throw new Error('No\x20bot\x20found');}if(_0x195415[_0x5f314b(0xaa)]<=0x0){log(_0x5f314b(0xb9),null,![]);throw new Error(_0x5f314b(0xd9));}for(const _0x44c307 of _0x195415){if(signal[_0x5f314b(0xcb)]){log('[xuLyBrowser]:đã\x20bị\x20hủy',null,'w');throw new Error(_0x5f314b(0xda));}if(_0x44c307){if(_0x44c307[_0x5f314b(0xe0)]===_0x5f314b(0xf1)){log('['+profileNameId+_0x5f314b(0xa1),null,'i');break;}if(!_0x44c307[_0x5f314b(0xbf)]){log('['+profileNameId+_0x5f314b(0x8c)+json(_0x44c307)+_0x5f314b(0xf0),null,![]);continue;}if(_0x44c307['onOff']==='0'){log('['+profileNameId+']:\x20Bot\x20'+json(_0x44c307[_0x5f314b(0xee)])+'\x20OFF',null,![]);continue;}const _0x4d7d95=await genlogin['nowTime']();if(_0x44c307[_0x5f314b(0xca)]>_0x4d7d95[_0x5f314b(0xd3)]){log('['+profileNameId+_0x5f314b(0x8c)+json(_0x44c307[_0x5f314b(0xee)])+'\x20Chưa\x20tới\x20giờ\x20chạy',null,'w');continue;}switch(_0x44c307[_0x5f314b(0xbf)]){case'A':log('['+profileNameId+_0x5f314b(0xd8)+json(_0x44c307[_0x5f314b(0xee)])+'\x20Tele\x20A\x20OK'),await xuLyGame(_0x44c307,'A');break;case'K':log('['+profileNameId+']:\x20'+json(_0x44c307['name'])+_0x5f314b(0xcd)),await xuLyGame(_0x44c307,'K');break;case'W':log('['+profileNameId+_0x5f314b(0xd8)+json(_0x44c307[_0x5f314b(0xee)])+_0x5f314b(0xce)),await xuLyGame(_0x44c307,'W');break;default:log('['+profileNameId+_0x5f314b(0x85)+json(_0x44c307[_0x5f314b(0xbf)]),null,![]);break;}log('[xuLyBrowser]:\x20Bot\x20OK');}}return!![];}catch(_0x18be3c){return log('[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20'+_0x18be3c,null,![]),log('[xuLyBrowser]:\x20'+json(bots),null,![]),null;}}async function xuLyGame(_0x5170e4,_0xda3690){const _0xb7f8d6=a31_0x3bcd29;try{if(signal['aborted']){log(_0xb7f8d6(0xc7),null,'w');throw new Error(_0xb7f8d6(0xda));}if(_0x5170e4[_0xb7f8d6(0xdf)]===_0xb7f8d6(0x8a)){log(_0xb7f8d6(0xe8)+_0x5170e4[_0xb7f8d6(0xee)]+_0xb7f8d6(0xe7),null,'i');const _0x3aed1b=await genlogin[_0xb7f8d6(0xdd)](),_0x54aba9=await http[_0xb7f8d6(0x8e)](profileNameId,_0x5170e4[_0xb7f8d6(0xee)],_0x3aed1b['date'],'',_0xb7f8d6(0x81),_0xb7f8d6(0xa5)),_0x45a5e8=_0x54aba9['ID'],_0x2c17b0={'bot':_0x5170e4,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0x45a5e8},_0x3cf3b4=await loadGameApi(_0x5170e4['name'],_0x2c17b0);if(!_0x3cf3b4['status'])return log(_0xb7f8d6(0xb0)+_0x5170e4['name']+_0xb7f8d6(0xb6),null,![]),await http[_0xb7f8d6(0xc4)](profileNameId,_0x45a5e8,_0xb7f8d6(0xb5),_0xb7f8d6(0xb5)),null;if(_0x3cf3b4[_0xb7f8d6(0xd5)]==_0xb7f8d6(0x84))return log(_0xb7f8d6(0xb0)+_0x5170e4['name']+'\x20loop',null,'i'),_0xb7f8d6(0x84);if(_0x3cf3b4['status'])return log(_0xb7f8d6(0xb0)+_0x5170e4['name']+_0xb7f8d6(0xbe)),await http[_0xb7f8d6(0xa8)](profileNameId,_0x5170e4['id'],_0x3cf3b4[_0xb7f8d6(0x89)],_0x3cf3b4[_0xb7f8d6(0xca)]),await http[_0xb7f8d6(0xc4)](profileNameId,_0x45a5e8,'Ok','Done',_0x3cf3b4['coin'],_0x3cf3b4['nextRun']),!![];}else{log(_0xb7f8d6(0xe8)+_0x5170e4[_0xb7f8d6(0xee)]+_0xb7f8d6(0xc6),null,'i');const _0x4c353e=await http['getAks'](_0xda3690);if(_0x4c353e){log(_0xb7f8d6(0xbb));let _0x380880=0x0;while(_0x380880<0x2){if(signal[_0xb7f8d6(0xcb)]){log(_0xb7f8d6(0xc7),null,'w');throw new Error('timeout');}const _0x160e6f=await checkTeleWebOpen(_0x5170e4,_0x4c353e);if(_0x160e6f===_0xb7f8d6(0x84))_0x380880++,log(_0xb7f8d6(0xa9)+_0x380880+'/2',null,'i'),await delay(0x3e8);else return _0x160e6f?(log(_0xb7f8d6(0xa4)),!![]):(log(_0xb7f8d6(0xd0),null,![]),null);}return log(_0xb7f8d6(0x94),null,![]),null;}}}catch(_0x5a4a9f){return log('[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Game:\x20'+_0x5a4a9f,null,![]),null;}}async function checkTeleWebOpen(_0x4d1263,_0x17ff37){const _0x19863c=a31_0x3bcd29;try{if(signal[_0x19863c(0xcb)]){log('[checkTeleWebOpen]:đã\x20bị\x20hủy',null,'w');throw new Error('timeout');}let _0x32dcb2=await genlogin[_0x19863c(0xd1)](browser,0x0);const _0x139739=await genlogin[_0x19863c(0x86)](_0x32dcb2,_0x17ff37['InputSearch'],0x7d0);!_0x139739&&(await genlogin['openUrl'](_0x32dcb2,_0x19863c(0xd6)),await delay(0x7d0),await genlogin[_0x19863c(0xe1)](_0x32dcb2,_0x17ff37[_0x19863c(0xd2)]),await delay(0x7d0));log(_0x19863c(0xc0),null,'i');const _0x2f81e8=await genlogin[_0x19863c(0xdd)](),_0x257cb7=await http['addData'](profileNameId,_0x4d1263[_0x19863c(0xee)],_0x2f81e8[_0x19863c(0x93)],'',_0x19863c(0xeb),_0x19863c(0xa5));dataId=_0x257cb7['ID'];const _0x308336={'firstPage':_0x32dcb2,'bot':_0x4d1263,'profileNameId':profileNameId,'getAks':_0x17ff37,'genlogin':genlogin,'http':http,'browser':browser,'dataId':dataId};log('[checkTeleWebOpen]:\x20dataId:\x20'+json(dataId),null,'i');if(timGame){await http[_0x19863c(0xc4)](profileNameId,dataId,_0x19863c(0x91));const _0x25e5f7=await loadGame(_0x19863c(0xc1),_0x308336);if(_0x25e5f7[_0x19863c(0xd5)]==_0x19863c(0x84))return log(_0x19863c(0x87)+_0x4d1263[_0x19863c(0xee)]+'\x20loop',null,'i'),await http['updateData'](profileNameId,dataId,_0x19863c(0xe4)),_0x19863c(0x84);else{if(!_0x25e5f7)return log(_0x19863c(0xe5)+_0x4d1263[_0x19863c(0xee)],null,![]),null;}}await http[_0x19863c(0xc4)](profileNameId,dataId,_0x19863c(0xcc));const _0xe9d27b=await loadGame(_0x4d1263[_0x19863c(0xee)],_0x308336);if(!_0xe9d27b[_0x19863c(0xd5)])return log(_0x19863c(0x95)+_0x4d1263[_0x19863c(0xee)],null,![]),log(_0x19863c(0xa3)+json(_0xe9d27b),null,![]),null;else{if(_0xe9d27b[_0x19863c(0xd5)]==_0x19863c(0x84))return log(_0x19863c(0x87)+_0x4d1263[_0x19863c(0xee)]+_0x19863c(0xb1),null,'i'),await http[_0x19863c(0xc4)](profileNameId,dataId,_0x19863c(0x84)),'loop';}return await http[_0x19863c(0xa8)](profileNameId,_0x4d1263['id'],_0xe9d27b[_0x19863c(0x89)],_0xe9d27b[_0x19863c(0xca)]),await http['updateData'](profileNameId,dataId,'Ok',_0x19863c(0xe2),_0xe9d27b[_0x19863c(0x90)],_0xe9d27b[_0x19863c(0x89)]),log(_0x19863c(0x83)+_0x4d1263['name']+'\x20thành\x20công'),await delay(0x7d0),!![];}catch(_0x22d971){return log('[checkTeleWebOpen]:\x20Lỗi\x20trong\x20quá\x20trình\x20mở\x20trang\x20:\x20'+_0x22d971,null,![]),null;}}async function loadGame(_0x5ba5bc,_0x2818f6){const _0x335dcc=a31_0x3bcd29;try{if(signal[_0x335dcc(0xcb)]){log(_0x335dcc(0xdb),null,'w');throw new Error(_0x335dcc(0xda));}const _0x4d77f6=path[_0x335dcc(0xa7)](__dirname,'scripts',_0x5ba5bc+_0x335dcc(0xa2)),_0x571e76=require(_0x4d77f6);if(typeof _0x571e76==='function'){const _0x592dee=await _0x571e76(_0x2818f6,signal);await delay(0x3e8);if(!_0x592dee[_0x335dcc(0xd5)])return log(_0x335dcc(0xb7)+_0x5ba5bc+_0x335dcc(0x9c),null,![]),null;return _0x592dee[_0x335dcc(0xd5)]===_0x335dcc(0x84)?(log(_0x335dcc(0xde)+_0x5ba5bc+_0x335dcc(0xb1),null,'i'),_0x592dee):(log(_0x335dcc(0xde)+_0x5ba5bc+'\x20'+_0x592dee[_0x335dcc(0xd5)],null,'i'),_0x592dee);}else return await delay(0x3e8),log('[loadGame]:\x20Script\x20'+_0x5ba5bc+'\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ',null,![]),null;}catch(_0x3e0827){return log(_0x335dcc(0xaf)+_0x5ba5bc+':\x20'+_0x3e0827,null,![]),null;}}async function delay(_0xe4a69f){return new Promise(_0x35411a=>{const _0x419c28=a31_0x426c;if(signal['aborted'])throw new Error(_0x419c28(0xda));setTimeout(_0x35411a,_0xe4a69f);});}