const a31_0x4f50a7=a31_0x1373;function a31_0x1373(_0x409e5f,_0x39946c){const _0x55334e=a31_0x5533();return a31_0x1373=function(_0x137339,_0x1431cb){_0x137339=_0x137339-0x172;let _0x3dc91c=_0x55334e[_0x137339];return _0x3dc91c;},a31_0x1373(_0x409e5f,_0x39946c);}(function(_0x280173,_0x23c99b){const _0x1c0d3a=a31_0x1373,_0xdf33e2=_0x280173();while(!![]){try{const _0x23dbd4=parseInt(_0x1c0d3a(0x1a5))/0x1*(parseInt(_0x1c0d3a(0x1a9))/0x2)+parseInt(_0x1c0d3a(0x1be))/0x3+-parseInt(_0x1c0d3a(0x19c))/0x4+parseInt(_0x1c0d3a(0x199))/0x5*(parseInt(_0x1c0d3a(0x1dd))/0x6)+-parseInt(_0x1c0d3a(0x17f))/0x7+-parseInt(_0x1c0d3a(0x19e))/0x8+-parseInt(_0x1c0d3a(0x1a2))/0x9*(-parseInt(_0x1c0d3a(0x1af))/0xa);if(_0x23dbd4===_0x23c99b)break;else _0xdf33e2['push'](_0xdf33e2['shift']());}catch(_0x27da62){_0xdf33e2['push'](_0xdf33e2['shift']());}}}(a31_0x5533,0xd52a3),require(a31_0x4f50a7(0x1dc))[a31_0x4f50a7(0x19b)]());const {Worker,parentPort}=require('worker_threads'),{log,json}=require(a31_0x4f50a7(0x1ae)),Genlogin=require(a31_0x4f50a7(0x180)),httpPost=require(a31_0x4f50a7(0x1a7)),path=require(a31_0x4f50a7(0x1b3)),PQueue=require(a31_0x4f50a7(0x192))[a31_0x4f50a7(0x1cf)],gameQueue=new PQueue({'concurrency':0x2});function a31_0x5533(){const _0xdd52d1=['openUrl','\x20Web\x20OK','nextRun','3981930hGhEku','runProfile','addData','\x20Script\x20mode','getAks','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy','[xuLyGame]:\x20Thực\x20thi\x20','value','[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot','elementExistsByXPath','updateData','env','\x20loop','\x20để\x20kiểm\x20tra\x20wsEndpoint...','[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20','[xuLyProfile]:\x20Không\x20thể\x20lấy\x20được\x20wsEndpoint\x20sau\x205\x20lần\x20thử','APIKEY','default','[checkTeleWebOpen]:\x20Thực\x20thi\x20','[loadGame]:\x20Script\x20','Done','InputSearch',']:\x20Bot\x20','[xuLyBrowser]:\x20Bot\x20OK','\x20Api\x20mode','[\x27worker-api3][','aks','[xuLyGame]:\x20getAks\x20OK','\x20done','\x20thành\x20công','dotenv','24FKuIgj','timestamp','StartApi','[xuLyGame]:\x20checkTeleWebOpen\x20có\x20gì\x20đó\x20sai\x20sai\x20rồi\x20bro','getBotAll','end','https://www.google.com','loop',']:\x20','coin','No\x20bot\x20found','[xuLyProfile]:\x20Đang\x20mở\x20profile\x20','message','[xuLyProfile]:đã\x20bị\x20hủy','loop\x20new\x20game','3896942pOKVPL','./modules/Genlogin','[xuLyGame]:\x20checkTeleWebOpen\x20OK','\x20thất\x20bại','\x20ko\x20có\x20aks','[xuLyGame]:đã\x20bị\x20hủy','Tìm','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','timGame','length','.js','Fail','api','[checkTeleWebOpen]:\x20dataId:\x20','aborted','stack','scripts','[checkTeleWebOpen]:\x20','[checkTeleWebOpen]:\x20vào\x20loadGame','p-queue','[xuLyGame]:\x20Loop\x20lại\x20,\x20loop\x20lại\x20lần\x20','nowTime',']:\x20Api\x20Mode','[checkTeleWebOpen]:\x20Thực\x20thi\x20script\x20','running','[xuLyGame]:Max\x20loop\x20rồi\x20bro','396630MnzPNt','timeout','config','3801340GkcEBq','[xuLyGame]:\x20','12958272tsaYBl','[loadGame]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','name','[loadGame]:đã\x20bị\x20hủy','9KohMDG','[checkTeleWebOpen]:\x20Lỗi\x20trong\x20quá\x20trình\x20mở\x20trang\x20:\x20','function','49013xXxylS','SERVER_HOST','./modules/http','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','34KgnSVT','type','date','nextRunTime','[xuLyBrowser]:đã\x20bị\x20hủy','./modules/logger','15221130DclThS','join',']:\x20Sai\x20aks\x20','nextRunStamp','path','[loadGame]:\x20Chạy\x20','activateTab','split','\x20lỗi','[xuLyBrowser]:\x20',']:\x20XONG\x201\x20LƯỢT','status'];a31_0x5533=function(){return _0xdd52d1;};return a31_0x5533();}let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process[a31_0x4f50a7(0x1c9)][a31_0x4f50a7(0x1a6)],process['env'][a31_0x4f50a7(0x1ce)],!![]);let signal={'aborted':![]};parentPort['on'](a31_0x4f50a7(0x17c),async({profile:_0x2a4355})=>{const _0x2ef465=a31_0x4f50a7;try{if(_0x2a4355=='timeout')signal['aborted']=!![],log('[worker-api3]:timeout',null,'w');else{if(signal[_0x2ef465(0x18d)])throw new Error(_0x2ef465(0x19a));log(_0x2ef465(0x1d7)+_0x2a4355+_0x2ef465(0x195),null,'w');const _0x19af78=await xuLyProfile(_0x2a4355);!_0x19af78?(log(_0x2ef465(0x1a8)+_0x2a4355+'\x20có\x20lỗi',null,'w'),parentPort['postMessage']({'success':![],'result':_0x19af78})):(log('[xuLyProfile]:\x20Xử\x20lý\x20profile\x20'+_0x2a4355+'\x20thành\x20công',null,'i'),parentPort['postMessage']({'success':!![],'result':_0x19af78}));}}catch(_0x587c32){parentPort['postMessage']({'success':![],'error':{'message':_0x587c32['message'],'stack':_0x587c32[_0x2ef465(0x18e)]}});}});async function xuLyProfile(_0x5ab67d){const _0x1bf336=a31_0x4f50a7;try{if(signal[_0x1bf336(0x18d)]){log('[xuLyProfile]:đã\x20bị\x20hủy',null,'w');throw new Error(_0x1bf336(0x19a));}profileNameId=_0x5ab67d,log('[xuLyProfile]:\x20Processing\x20profile:\x20'+JSON['stringify'](_0x5ab67d),null,'i');const _0x5f04e7=await xuLyBrowser(_0x5ab67d);return!_0x5f04e7?(log('[xuLyProfile]:\x20Xử\x20lý\x20browser\x20'+_0x5ab67d+_0x1bf336(0x182),null,'w'),null):(log(_0x1bf336(0x186)+_0x5ab67d+_0x1bf336(0x1db)),!![]);}catch(_0x18a923){throw new Error('Lỗi\x20xử\x20lý\x20profile:\x20'+_0x18a923['message']);}}async function xuLyEndPoint(_0x31f4a8){const _0x3c771b=a31_0x4f50a7;try{if(signal[_0x3c771b(0x18d)]){log(_0x3c771b(0x17d),null,'w');throw new Error(_0x3c771b(0x19a));}const _0x120e5c=_0x31f4a8[_0x3c771b(0x1b6)]('-')[0x1];profileId=_0x120e5c;let {wsEndpoint:_0x386c6e}=await genlogin['checkProfileIsRun'](_0x120e5c);if(signal[_0x3c771b(0x18d)]){log(_0x3c771b(0x17d),null,'w');throw new Error(_0x3c771b(0x19a));}log('[xuLyProfile]:\x20wsEndpoint:\x20'+json(_0x386c6e),null,'i');if(!_0x386c6e){log(_0x3c771b(0x17b)+_0x120e5c+'\x20is\x20not\x20running',null,'i'),await genlogin[_0x3c771b(0x1bf)](_0x120e5c);for(let _0x1c7b42=0x0;_0x1c7b42<0x5;_0x1c7b42++){if(signal[_0x3c771b(0x18d)]){log(_0x3c771b(0x17d),null,'w');throw new Error('timeout');}log('[xuLyProfile]:\x20Thử\x20lần\x20'+(_0x1c7b42+0x1)+_0x3c771b(0x1cb),null,'i'),await delay(0x1388);if(signal[_0x3c771b(0x18d)]){log(_0x3c771b(0x17d),null,'w');throw new Error(_0x3c771b(0x19a));}({wsEndpoint:_0x386c6e}=await genlogin['checkProfileIsRun'](_0x120e5c));if(signal['aborted']){log('[xuLyProfile]:đã\x20bị\x20hủy',null,'w');throw new Error(_0x3c771b(0x19a));}if(_0x386c6e){log('[xuLyProfile]:\x20Profile\x20đã\x20chạy\x20thành\x20công\x20với\x20wsEndpoint:'+_0x386c6e);break;}}if(!_0x386c6e)return log(_0x3c771b(0x1cd),null,![]),![];}const _0x17845e=_0x31f4a8;return await delay(0xbb8),log('[xuLyProfile]:\x20Đang\x20mở\x20trình\x20duyệt...',null,'i'),log('[xuLyProfile]:\x20wsEndpoint:\x20'+_0x386c6e,null,'i'),_0x386c6e;}catch(_0x514b86){log('[xuLyProfile]:\x20Lỗi\x20chung\x20xuLyProfile:\x20'+_0x514b86,null,![]);}}async function xuLyBrowser(_0xbbc1ec){const _0x2c1cc1=a31_0x4f50a7;try{if(signal[_0x2c1cc1(0x18d)]){log(_0x2c1cc1(0x1ad),null,'w');throw new Error('timeout');}let _0x3b6449=0x0;const _0xc00ba5=await http[_0x2c1cc1(0x174)](profileNameId);if(!_0xc00ba5){log(_0x2c1cc1(0x1c3),null,![]);throw new Error('No\x20bot\x20found');}if(_0xc00ba5[_0x2c1cc1(0x188)]<=0x0){log(_0x2c1cc1(0x1c6),null,![]);throw new Error(_0x2c1cc1(0x17a));}for(const _0x3df633 of _0xc00ba5){if(signal[_0x2c1cc1(0x18d)]){log(_0x2c1cc1(0x1ad),null,'w');throw new Error(_0x2c1cc1(0x19a));}if(_0x3df633){if(_0x3df633[_0x2c1cc1(0x1c5)]===_0x2c1cc1(0x175)){log('['+profileNameId+_0x2c1cc1(0x1b9),null,'i');break;}if(!_0x3df633[_0x2c1cc1(0x1d8)]){log('['+profileNameId+_0x2c1cc1(0x1d4)+json(_0x3df633)+_0x2c1cc1(0x183),null,![]);continue;}if(_0x3df633['onOff']==='0'){log('['+profileNameId+_0x2c1cc1(0x1d4)+json(_0x3df633[_0x2c1cc1(0x1a0)])+'\x20OFF',null,![]);continue;}const _0x50274b=await genlogin['nowTime']();if(_0x3df633[_0x2c1cc1(0x1b2)]>_0x50274b[_0x2c1cc1(0x1de)]){log('['+profileNameId+_0x2c1cc1(0x1d4)+json(_0x3df633['name'])+'\x20Chưa\x20tới\x20giờ\x20chạy',null,'w');continue;}switch(_0x3df633[_0x2c1cc1(0x1d8)]){case'A':log('['+profileNameId+']:\x20'+json(_0x3df633[_0x2c1cc1(0x1a0)])+'\x20Tele\x20A\x20OK'),await xuLyGame(_0x3df633,'A');break;case'K':log('['+profileNameId+_0x2c1cc1(0x178)+json(_0x3df633[_0x2c1cc1(0x1a0)])+'\x20Tele\x20K\x20OK'),await xuLyGame(_0x3df633,'K');break;case'W':log('['+profileNameId+']:\x20'+json(_0x3df633[_0x2c1cc1(0x1a0)])+_0x2c1cc1(0x1bc)),await xuLyGame(_0x3df633,'W');break;default:log('['+profileNameId+_0x2c1cc1(0x1b1)+json(_0x3df633[_0x2c1cc1(0x1d8)]),null,![]);break;}log(_0x2c1cc1(0x1d5));}}return!![];}catch(_0x37eaf0){return log(_0x2c1cc1(0x1cc)+_0x37eaf0,null,![]),log(_0x2c1cc1(0x1b8)+json(bots),null,![]),null;}}async function xuLyGame(_0xaee2d,_0x477b70){const _0x231cbc=a31_0x4f50a7;try{if(signal[_0x231cbc(0x18d)]){log(_0x231cbc(0x184),null,'w');throw new Error(_0x231cbc(0x19a));}if(_0xaee2d[_0x231cbc(0x1aa)]===_0x231cbc(0x18b)){log(_0x231cbc(0x19d)+_0xaee2d[_0x231cbc(0x1a0)]+_0x231cbc(0x1d6),null,'i');const _0x50578c=await genlogin[_0x231cbc(0x194)](),_0x3a91d1=await http[_0x231cbc(0x1c0)](profileNameId,_0xaee2d['name'],_0x50578c[_0x231cbc(0x1ab)],'',_0x231cbc(0x172),_0x231cbc(0x197)),_0x4c077b=_0x3a91d1['ID'],_0x40d0da={'bot':_0xaee2d,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0x4c077b},_0x3aa9d1=await loadGameApi(_0xaee2d[_0x231cbc(0x1a0)],_0x40d0da);if(!_0x3aa9d1['status'])return log(_0x231cbc(0x1c4)+_0xaee2d[_0x231cbc(0x1a0)]+_0x231cbc(0x1b7),null,![]),await http[_0x231cbc(0x1c8)](profileNameId,_0x4c077b,_0x231cbc(0x18a),_0x231cbc(0x18a)),null;if(_0x3aa9d1[_0x231cbc(0x1ba)]=='loop')return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0xaee2d[_0x231cbc(0x1a0)]+_0x231cbc(0x1ca),null,'i'),_0x231cbc(0x177);if(_0x3aa9d1[_0x231cbc(0x1ba)])return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0xaee2d[_0x231cbc(0x1a0)]+_0x231cbc(0x1da)),await http[_0x231cbc(0x1ac)](profileNameId,_0xaee2d['id'],_0x3aa9d1[_0x231cbc(0x1bd)],_0x3aa9d1[_0x231cbc(0x1b2)]),await http[_0x231cbc(0x1c8)](profileNameId,_0x4c077b,'Ok',_0x231cbc(0x1d2),_0x3aa9d1['coin'],_0x3aa9d1['nextRun']),!![];}else{log(_0x231cbc(0x19d)+_0xaee2d[_0x231cbc(0x1a0)]+_0x231cbc(0x1c1),null,'i');const _0x57bba2=await http[_0x231cbc(0x1c2)](_0x477b70);if(_0x57bba2){log(_0x231cbc(0x1d9));let _0x3fe716=0x0;while(_0x3fe716<0x2){if(signal[_0x231cbc(0x18d)]){log(_0x231cbc(0x184),null,'w');throw new Error(_0x231cbc(0x19a));}const _0x57ad45=await checkTeleWebOpen(_0xaee2d,_0x57bba2);if(_0x57ad45==='loop')_0x3fe716++,log(_0x231cbc(0x193)+_0x3fe716+'/2',null,'i'),await delay(0x3e8);else return _0x57ad45?(log(_0x231cbc(0x181)),!![]):(log(_0x231cbc(0x173),null,![]),null);}return log(_0x231cbc(0x198),null,![]),null;}}}catch(_0x12997d){return log('[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Game:\x20'+_0x12997d,null,![]),null;}}async function checkTeleWebOpen(_0x37d01e,_0x48ab2c){const _0x58bd41=a31_0x4f50a7;try{if(signal[_0x58bd41(0x18d)]){log('[checkTeleWebOpen]:đã\x20bị\x20hủy',null,'w');throw new Error('timeout');}let _0x2ffdd7=await genlogin[_0x58bd41(0x1b5)](browser,0x0);const _0x4d27d1=await genlogin[_0x58bd41(0x1c7)](_0x2ffdd7,_0x48ab2c[_0x58bd41(0x1d3)],0x7d0);!_0x4d27d1&&(await genlogin[_0x58bd41(0x1bb)](_0x2ffdd7,_0x58bd41(0x176)),await delay(0x7d0),await genlogin[_0x58bd41(0x1bb)](_0x2ffdd7,_0x48ab2c['FistUrl']),await delay(0x7d0));log(_0x58bd41(0x191),null,'i');const _0x1eebce=await genlogin['nowTime'](),_0x36c980=await http[_0x58bd41(0x1c0)](profileNameId,_0x37d01e[_0x58bd41(0x1a0)],_0x1eebce[_0x58bd41(0x1ab)],'','Start','running');dataId=_0x36c980['ID'];const _0x5f20e0={'firstPage':_0x2ffdd7,'bot':_0x37d01e,'profileNameId':profileNameId,'getAks':_0x48ab2c,'genlogin':genlogin,'http':http,'browser':browser,'dataId':dataId};log(_0x58bd41(0x18c)+json(dataId),null,'i');if(timGame){await http[_0x58bd41(0x1c8)](profileNameId,dataId,_0x58bd41(0x185));const _0x1c52be=await loadGame(_0x58bd41(0x187),_0x5f20e0);if(_0x1c52be[_0x58bd41(0x1ba)]=='loop')return log(_0x58bd41(0x1d0)+_0x37d01e[_0x58bd41(0x1a0)]+_0x58bd41(0x1ca),null,'i'),await http[_0x58bd41(0x1c8)](profileNameId,dataId,_0x58bd41(0x17e)),'loop';else{if(!_0x1c52be)return log('[checkTeleWebOpen]:\x20Không\x20tìm\x20thấy\x20game\x20'+_0x37d01e[_0x58bd41(0x1a0)],null,![]),null;}}await http[_0x58bd41(0x1c8)](profileNameId,dataId,'Vào');const _0x3f6605=await loadGame(_0x37d01e['name'],_0x5f20e0);if(!_0x3f6605['status'])return log('[checkTeleWebOpen]:\x20Không\x20thực\x20thi\x20script\x20'+_0x37d01e[_0x58bd41(0x1a0)],null,![]),log(_0x58bd41(0x190)+json(_0x3f6605),null,![]),null;else{if(_0x3f6605[_0x58bd41(0x1ba)]=='loop')return log('[checkTeleWebOpen]:\x20Thực\x20thi\x20'+_0x37d01e['name']+_0x58bd41(0x1ca),null,'i'),await http[_0x58bd41(0x1c8)](profileNameId,dataId,_0x58bd41(0x177)),_0x58bd41(0x177);}return await http[_0x58bd41(0x1ac)](profileNameId,_0x37d01e['id'],_0x3f6605[_0x58bd41(0x1bd)],_0x3f6605[_0x58bd41(0x1b2)]),await http[_0x58bd41(0x1c8)](profileNameId,dataId,'Ok',_0x58bd41(0x1d2),_0x3f6605[_0x58bd41(0x179)],_0x3f6605[_0x58bd41(0x1bd)]),log(_0x58bd41(0x196)+_0x37d01e[_0x58bd41(0x1a0)]+_0x58bd41(0x1db)),await delay(0x7d0),!![];}catch(_0x40f8e5){return log(_0x58bd41(0x1a3)+_0x40f8e5,null,![]),null;}}async function loadGame(_0x28450f,_0x5762b5){const _0x577483=a31_0x4f50a7;try{if(signal[_0x577483(0x18d)]){log(_0x577483(0x1a1),null,'w');throw new Error(_0x577483(0x19a));}const _0x221dab=path[_0x577483(0x1b0)](__dirname,_0x577483(0x18f),_0x28450f+_0x577483(0x189)),_0x585d50=require(_0x221dab);if(typeof _0x585d50===_0x577483(0x1a4)){const _0x565a30=await _0x585d50(_0x5762b5,signal);await delay(0x3e8);if(!_0x565a30['status'])return log('[loadGame]:\x20Script\x20'+_0x28450f+'\x20không\x20trả\x20về\x20status',null,![]),null;return _0x565a30['status']===_0x577483(0x177)?(log(_0x577483(0x1b4)+_0x28450f+_0x577483(0x1ca),null,'i'),_0x565a30):(log(_0x577483(0x1b4)+_0x28450f+'\x20'+_0x565a30[_0x577483(0x1ba)],null,'i'),_0x565a30);}else return await delay(0x3e8),log(_0x577483(0x1d1)+_0x28450f+'\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ',null,![]),null;}catch(_0x323346){return log(_0x577483(0x19f)+_0x28450f+':\x20'+_0x323346,null,![]),null;}}async function delay(_0x1dd89f){return new Promise(_0x4a3fbb=>{const _0x4c4de9=a31_0x1373;if(signal[_0x4c4de9(0x18d)])throw new Error(_0x4c4de9(0x19a));setTimeout(_0x4a3fbb,_0x1dd89f);});}