const a30_0x3173d6=a30_0x5556;(function(_0x2f1dcb,_0xe32eea){const _0x10f59f=a30_0x5556,_0x30e342=_0x2f1dcb();while(!![]){try{const _0x5c4c09=parseInt(_0x10f59f(0x1f3))/0x1+-parseInt(_0x10f59f(0x1ea))/0x2+parseInt(_0x10f59f(0x1f1))/0x3*(parseInt(_0x10f59f(0x1fd))/0x4)+parseInt(_0x10f59f(0x1c9))/0x5*(-parseInt(_0x10f59f(0x1d2))/0x6)+parseInt(_0x10f59f(0x1ca))/0x7*(-parseInt(_0x10f59f(0x1bd))/0x8)+-parseInt(_0x10f59f(0x1be))/0x9*(-parseInt(_0x10f59f(0x1db))/0xa)+parseInt(_0x10f59f(0x1ed))/0xb;if(_0x5c4c09===_0xe32eea)break;else _0x30e342['push'](_0x30e342['shift']());}catch(_0x33fe14){_0x30e342['push'](_0x30e342['shift']());}}}(a30_0x39fc,0x76ec9),require(a30_0x3173d6(0x1eb))[a30_0x3173d6(0x1df)]());const {Worker,parentPort}=require(a30_0x3173d6(0x1c4)),{log,json}=require(a30_0x3173d6(0x200)),Genlogin=require(a30_0x3173d6(0x1fe)),httpPost=require('./modules/http'),path=require(a30_0x3173d6(0x20d)),PQueue=require('p-queue')[a30_0x3173d6(0x1e9)];let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];function a30_0x5556(_0x3bec70,_0x4c7012){const _0x39fcf6=a30_0x39fc();return a30_0x5556=function(_0x5556cc,_0x13329c){_0x5556cc=_0x5556cc-0x1b7;let _0x1580f4=_0x39fcf6[_0x5556cc];return _0x1580f4;},a30_0x5556(_0x3bec70,_0x4c7012);}genlogin=new Genlogin('',!![]);const http=new httpPost(process[a30_0x3173d6(0x1c3)][a30_0x3173d6(0x208)],process[a30_0x3173d6(0x1c3)]['APIKEY'],!![]);let signal={'aborted':![]},firstRun=!![],maxBotThreads=0x1;parentPort['on'](a30_0x3173d6(0x205),async _0x5676a0=>{const _0x4d2d4f=a30_0x3173d6,{profile:_0x2061d1,maxBot:_0x229cfd}=_0x5676a0;try{if(_0x2061d1=='timeout')signal[_0x4d2d4f(0x1f2)]=!![],log('[worker-api2]:timeout',null,'w');else{firstRun&&(firstRun=![],maxBotThreads=parseInt(_0x229cfd),botQueue=new PQueue({'concurrency':maxBotThreads}),log(_0x4d2d4f(0x1dd)+maxBotThreads,null,'w'));if(signal['aborted'])throw new Error(_0x4d2d4f(0x1c5));log(_0x4d2d4f(0x1f7)+_0x2061d1+_0x4d2d4f(0x1e3),null,'w');const _0x4f0292=await xuLyProfile(_0x2061d1);!_0x4f0292?(log(_0x4d2d4f(0x1b7)+_0x2061d1+_0x4d2d4f(0x1dc),null,'w'),parentPort['postMessage']({'success':![],'result':_0x4f0292})):(log(_0x4d2d4f(0x1b7)+_0x2061d1+_0x4d2d4f(0x206),null,'i'),parentPort['postMessage']({'success':!![],'result':_0x4f0292}));}}catch(_0x190b8c){parentPort[_0x4d2d4f(0x201)]({'success':![],'error':{'message':_0x190b8c[_0x4d2d4f(0x205)],'stack':_0x190b8c['stack']}});}});async function xuLyProfile(_0x210603){const _0x382ebb=a30_0x3173d6;try{if(signal[_0x382ebb(0x1f2)]){log('[xuLyProfile]:đã\x20bị\x20hủy',null,'w');throw new Error('timeout');}profileNameId=_0x210603,log(_0x382ebb(0x1cd)+JSON[_0x382ebb(0x202)](_0x210603),null,'i');const _0x55a1a7=await xuLyBrowser(_0x210603);return!_0x55a1a7?(log(_0x382ebb(0x1ee)+_0x210603+_0x382ebb(0x1e5),null,'w'),null):(log(_0x382ebb(0x1ee)+_0x210603+'\x20thành\x20công'),!![]);}catch(_0x3f9f76){throw new Error('Lỗi\x20xử\x20lý\x20profile:\x20'+_0x3f9f76[_0x382ebb(0x205)]);}}function a30_0x39fc(){const _0x327e60=['name','length',']:\x20Api\x20Mode','toolApi','\x20thất\x20bại','[xuLyGame]:\x20Thực\x20thi\x20',']:\x20XONG\x201\x20LƯỢT','value','default','274768ZxJMbZ','dotenv','[xuLyBrowser]:\x20','2988293BfgYDj','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ','addData','3hNEAgC','aborted','574397flxeOQ','[xuLyGame]:đã\x20bị\x20hủy','[loadGameApi]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','\x20vào\x20hàng\x20đợi\x20max:','[\x27worker-api2][','nextRun','getBotAll','nowTime',']:\x20Bot\x20','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy','553716LZBeOb','./modules/Genlogin','[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Bot:\x20','./modules/logger','postMessage','stringify','Fail','[loadGameApi]:\x20Chạy\x20','message','\x20thành\x20công','date','SERVER_HOST','Done','push','end','\x20Chưa\x20tới\x20giờ\x20chạy','path','[xuLyBrowser]:\x20Bot\x20','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','\x20loop','aks','onOff','[xuLyBrowser]:\x20Thêm\x20Bot\x20','type','40TgCsTV','2276145lTwmwz','[xuLyBrowser]:đã\x20bị\x20hủy','nextRunStamp','[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20','\x20Api\x20mode','env','worker_threads','timeout','StartApi','status','loop','2385QTKpHL','643958dvGJrM','\x20vào\x20hàng\x20đợi.','api','[xuLyProfile]:\x20Processing\x20profile:\x20','join','No\x20bot\x20found','\x20OFF','add','8286jXPbyo','\x20đã\x20bị\x20hủy','updateData','coin','function','[xuLyGame]:\x20','\x20lỗi','\x20done','.js','30Vernps','\x20có\x20lỗi','[worker-api2]:\x20Max\x20Bot\x20threads:\x20','[loadGameApi]:\x20Script\x20','config','running'];a30_0x39fc=function(){return _0x327e60;};return a30_0x39fc();}async function xuLyBrowser(_0x14892d){const _0x7e7436=a30_0x3173d6;try{if(signal[_0x7e7436(0x1f2)]){log(_0x7e7436(0x1bf),null,'w');throw new Error(_0x7e7436(0x1c5));}let _0x5bd1d8=0x0;const _0x650691=await http[_0x7e7436(0x1f9)](profileNameId);if(!_0x650691){log(_0x7e7436(0x1fc),null,![]);throw new Error(_0x7e7436(0x1cf));}if(_0x650691[_0x7e7436(0x1e2)]<=0x0){log('[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot',null,![]);throw new Error(_0x7e7436(0x1cf));}const _0x226516=[];for(const _0x9d50bb of _0x650691){if(!_0x9d50bb)continue;if(_0x9d50bb[_0x7e7436(0x1bc)]!='api')continue;if(signal['aborted']){log(_0x7e7436(0x20e)+_0x9d50bb[_0x7e7436(0x1e1)]+_0x7e7436(0x1d3),null,'w');throw new Error(_0x7e7436(0x1c5));}if(_0x9d50bb[_0x7e7436(0x1e8)]===_0x7e7436(0x20b)){log('['+profileNameId+_0x7e7436(0x1e7),null,'i');break;}if(_0x9d50bb[_0x7e7436(0x1ba)]==='0'){log('['+profileNameId+_0x7e7436(0x1fb)+json(_0x9d50bb['name'])+_0x7e7436(0x1d0),null,![]);continue;}if(!_0x9d50bb[_0x7e7436(0x1b9)]){log('['+profileNameId+_0x7e7436(0x1fb)+json(_0x9d50bb)+'\x20ko\x20có\x20aks',null,![]);continue;}const _0x1ada32=await genlogin['nowTime']();if(_0x9d50bb['nextRunStamp']>_0x1ada32['timestamp']){log('['+profileNameId+_0x7e7436(0x1fb)+json(_0x9d50bb['name'])+_0x7e7436(0x20c),null,'w');continue;}log(_0x7e7436(0x1bb)+_0x9d50bb[_0x7e7436(0x1e1)]+_0x7e7436(0x1f6)+maxBotThreads,null,'i'),_0x226516[_0x7e7436(0x20a)](botQueue[_0x7e7436(0x1d1)](()=>xuLyGame(_0x9d50bb,_0x9d50bb['aks']))),log('[xuLyBrowser]:\x20Đã\x20thêm\x20profile\x20'+_0x9d50bb[_0x7e7436(0x1e1)]+_0x7e7436(0x1cb)),await delay(0x3e8);}return await Promise['all'](_0x226516),log('[xuLyBrowser]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20bots\x20thành\x20công'),!![];}catch(_0x411ae8){return log(_0x7e7436(0x1c1)+_0x411ae8,null,![]),log(_0x7e7436(0x1ec)+json(bots),null,![]),null;}}async function xuLyGame(_0xdcef44,_0x341e1c){const _0x169f30=a30_0x3173d6;try{if(signal[_0x169f30(0x1f2)]){log(_0x169f30(0x1f4),null,'w');throw new Error('timeout');}if(_0xdcef44[_0x169f30(0x1bc)]===_0x169f30(0x1cc)){log(_0x169f30(0x1d7)+_0xdcef44[_0x169f30(0x1e1)]+_0x169f30(0x1c2),null,'i');const _0x20e922=await genlogin[_0x169f30(0x1fa)](),_0x55379e=await http[_0x169f30(0x1f0)](profileNameId,_0xdcef44[_0x169f30(0x1e1)],_0x20e922[_0x169f30(0x207)],'',_0x169f30(0x1c6),_0x169f30(0x1e0)),_0x43aa7f=_0x55379e['ID'],_0x46a7d3={'bot':_0xdcef44,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0x43aa7f},_0x562ac5=await loadGameApi(_0xdcef44[_0x169f30(0x1e1)],_0x46a7d3);if(!_0x562ac5[_0x169f30(0x1c7)])return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0xdcef44['name']+_0x169f30(0x1d8),null,![]),await http[_0x169f30(0x1d4)](profileNameId,_0x43aa7f,_0x169f30(0x203),_0x169f30(0x203)),null;if(_0x562ac5[_0x169f30(0x1c7)]=='loop')return log(_0x169f30(0x1e6)+_0xdcef44[_0x169f30(0x1e1)]+'\x20loop',null,'i'),await http[_0x169f30(0x1d4)](profileNameId,_0x43aa7f,_0x169f30(0x1c8),'loop'),_0x169f30(0x1c8);if(_0x562ac5[_0x169f30(0x1c7)])return log(_0x169f30(0x1e6)+_0xdcef44['name']+_0x169f30(0x1d9)),await http['nextRunTime'](profileNameId,_0xdcef44['id'],_0x562ac5[_0x169f30(0x1f8)],_0x562ac5[_0x169f30(0x1c0)]),await http[_0x169f30(0x1d4)](profileNameId,_0x43aa7f,'Ok',_0x169f30(0x209),_0x562ac5[_0x169f30(0x1d5)],_0x562ac5[_0x169f30(0x1f8)]),!![];}return null;}catch(_0x1bf48e){return log(_0x169f30(0x1ff)+_0x1bf48e,null,![]),null;}}async function loadGameApi(_0xfa4e42,_0x2df05b){const _0x3b156f=a30_0x3173d6;try{const _0x2d59ae=path[_0x3b156f(0x1ce)](__dirname,_0x3b156f(0x1e4),_0xfa4e42+_0x3b156f(0x1da)),_0xa57662=require(_0x2d59ae);if(typeof _0xa57662===_0x3b156f(0x1d6)){const _0x4561c2=await _0xa57662(_0x2df05b);return await delay(0x3e8),_0x4561c2['status']==='loop'?(log(_0x3b156f(0x204)+_0xfa4e42+_0x3b156f(0x1b8)),_0x4561c2):(log(_0x3b156f(0x204)+_0xfa4e42+'\x20'+_0x4561c2[_0x3b156f(0x1c7)]),_0x4561c2);}else return await delay(0x3e8),log(_0x3b156f(0x1de)+_0xfa4e42+_0x3b156f(0x1ef)),null;}catch(_0xbcf965){return log(_0x3b156f(0x1f5)+_0xfa4e42+':\x20'+_0xbcf965,![]),null;}}async function delay(_0x4f03f7){return new Promise(_0x35ab76=>{const _0x1a9d34=a30_0x5556;if(signal[_0x1a9d34(0x1f2)])throw new Error(_0x1a9d34(0x1c5));setTimeout(_0x35ab76,_0x4f03f7);});}