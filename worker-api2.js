const a0_0x10c4a6=a0_0x3efc;(function(_0x1bc5ba,_0x381a0e){const _0x4f11c3=a0_0x3efc,_0x1e9e0d=_0x1bc5ba();while(!![]){try{const _0xc2dd8a=-parseInt(_0x4f11c3(0x231))/0x1*(parseInt(_0x4f11c3(0x211))/0x2)+parseInt(_0x4f11c3(0x213))/0x3+-parseInt(_0x4f11c3(0x1ed))/0x4*(parseInt(_0x4f11c3(0x21e))/0x5)+parseInt(_0x4f11c3(0x228))/0x6+-parseInt(_0x4f11c3(0x1fb))/0x7*(-parseInt(_0x4f11c3(0x22c))/0x8)+parseInt(_0x4f11c3(0x223))/0x9+-parseInt(_0x4f11c3(0x1e6))/0xa*(parseInt(_0x4f11c3(0x1f2))/0xb);if(_0xc2dd8a===_0x381a0e)break;else _0x1e9e0d['push'](_0x1e9e0d['shift']());}catch(_0x168d67){_0x1e9e0d['push'](_0x1e9e0d['shift']());}}}(a0_0xd815,0xcdcca),require(a0_0x10c4a6(0x206))[a0_0x10c4a6(0x1ec)]());const {Worker,parentPort}=require('worker_threads'),{log,json}=require('./modules/logger'),Genlogin=require('./modules/Genlogin'),httpPost=require(a0_0x10c4a6(0x20c)),path=require('path'),PQueue=require(a0_0x10c4a6(0x1e5))['default'];let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process[a0_0x10c4a6(0x20d)]['SERVER_HOST'],process[a0_0x10c4a6(0x20d)][a0_0x10c4a6(0x209)],!![]);let signal={'aborted':![]},firstRun=!![],maxBotThreads=0x1;parentPort['on']('message',async _0x32ca6d=>{const _0x1da014=a0_0x10c4a6,{profile:_0x486a5f,maxBot:_0x3a37d5}=_0x32ca6d;try{if(_0x486a5f==_0x1da014(0x214))signal[_0x1da014(0x1e7)]=!![],log(_0x1da014(0x229),null,'w');else{firstRun&&(firstRun=![],maxBotThreads=parseInt(_0x3a37d5),botQueue=new PQueue({'concurrency':maxBotThreads}),log(_0x1da014(0x1ef)+maxBotThreads,null,'w'));if(signal[_0x1da014(0x1e7)])throw new Error(_0x1da014(0x214));log('[\x27worker-api2]['+_0x486a5f+']:\x20Api\x20Mode',null,'w');const _0x527c9b=await xuLyProfile(_0x486a5f);!_0x527c9b?(log(_0x1da014(0x1fd)+_0x486a5f+_0x1da014(0x22b),null,'w'),parentPort[_0x1da014(0x1f4)]({'success':![],'result':_0x527c9b})):(log(_0x1da014(0x1fd)+_0x486a5f+'\x20thành\x20công',null,'i'),parentPort[_0x1da014(0x1f4)]({'success':!![],'result':_0x527c9b}));}}catch(_0x30850c){parentPort[_0x1da014(0x1f4)]({'success':![],'error':{'message':_0x30850c[_0x1da014(0x20b)],'stack':_0x30850c[_0x1da014(0x21a)]}});}});async function xuLyProfile(_0x3fb8a1){const _0x4f5226=a0_0x10c4a6;try{if(signal[_0x4f5226(0x1e7)]){log('[xuLyProfile]:đã\x20bị\x20hủy',null,'w');throw new Error(_0x4f5226(0x214));}profileNameId=_0x3fb8a1,log(_0x4f5226(0x1fa)+JSON['stringify'](_0x3fb8a1),null,'i');const _0x5ba989=await xuLyBrowser(_0x3fb8a1);return!_0x5ba989?(log(_0x4f5226(0x212)+_0x3fb8a1+'\x20thất\x20bại',null,'w'),null):(log(_0x4f5226(0x212)+_0x3fb8a1+_0x4f5226(0x1f3)),!![]);}catch(_0x5bb420){throw new Error(_0x4f5226(0x203)+_0x5bb420[_0x4f5226(0x20b)]);}}function a0_0xd815(){const _0x143c5e=['\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ','[xuLyGame]:\x20Thực\x20thi\x20','.js','[xuLyBrowser]:\x20Bot\x20','74585yIvKzB','\x20Api\x20mode','p-queue','2230BVygTp','aborted','\x20đã\x20bị\x20hủy','function','\x20Chưa\x20tới\x20giờ\x20chạy','api','config','4HhaYaY','[xuLyBrowser]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20bots\x20thành\x20công','[worker-api2]:\x20Max\x20Bot\x20threads:\x20','[xuLyGame]:\x20','\x20loop','36641bCrWrP','\x20thành\x20công','postMessage','StartApi','Fail','[loadGameApi]:\x20Script\x20','\x20OFF','name','[xuLyProfile]:\x20Processing\x20profile:\x20','49neLzum','type','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','\x20ko\x20có\x20aks','running','[loadGameApi]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','\x20lỗi','nextRunStamp','Lỗi\x20xử\x20lý\x20profile:\x20','updateData','length','dotenv','[loadGameApi]:\x20Chạy\x20','[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20','APIKEY',']:\x20Bot\x20','message','./modules/http','env','addData','loop','[xuLyBrowser]:đã\x20bị\x20hủy','26rNhpnL','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','4525467cUMBUr','timeout','join','getBotAll','status','date','\x20done','stack','[xuLyBrowser]:\x20','end','[xuLyGame]:đã\x20bị\x20hủy','6560090fpfwed','nextRun','nowTime','push','toolApi','4130955MGWUQy','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy',']:\x20XONG\x201\x20LƯỢT','coin','timestamp','5715450itRUsQ','[worker-api2]:timeout','No\x20bot\x20found','\x20có\x20lỗi','1082664sepNGS'];a0_0xd815=function(){return _0x143c5e;};return a0_0xd815();}async function xuLyBrowser(_0x5ebb95){const _0x5a20d6=a0_0x10c4a6;try{if(signal[_0x5a20d6(0x1e7)]){log(_0x5a20d6(0x210),null,'w');throw new Error(_0x5a20d6(0x214));}let _0x320705=0x0;const _0x2ccb74=await http[_0x5a20d6(0x216)](profileNameId);if(!_0x2ccb74){log(_0x5a20d6(0x224),null,![]);throw new Error(_0x5a20d6(0x22a));}if(_0x2ccb74[_0x5a20d6(0x205)]<=0x0){log('[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot',null,![]);throw new Error(_0x5a20d6(0x22a));}const _0x415146=[];for(const _0x301ba6 of _0x2ccb74){if(!_0x301ba6)continue;if(_0x301ba6['type']!='api')continue;if(signal['aborted']){log(_0x5a20d6(0x230)+_0x301ba6['name']+_0x5a20d6(0x1e8),null,'w');throw new Error(_0x5a20d6(0x214));}if(_0x301ba6['value']===_0x5a20d6(0x21c)){log('['+profileNameId+_0x5a20d6(0x225),null,'i');break;}if(_0x301ba6['onOff']==='0'){log('['+profileNameId+_0x5a20d6(0x20a)+json(_0x301ba6[_0x5a20d6(0x1f9)])+_0x5a20d6(0x1f8),null,![]);continue;}if(!_0x301ba6['aks']){log('['+profileNameId+_0x5a20d6(0x20a)+json(_0x301ba6)+_0x5a20d6(0x1fe),null,![]);continue;}const _0x345d2a=await genlogin[_0x5a20d6(0x220)]();if(_0x301ba6[_0x5a20d6(0x202)]>_0x345d2a[_0x5a20d6(0x227)]){log('['+profileNameId+']:\x20Bot\x20'+json(_0x301ba6[_0x5a20d6(0x1f9)])+_0x5a20d6(0x1ea),null,'w');continue;}log('[xuLyBrowser]:\x20Thêm\x20Bot\x20'+_0x301ba6['name']+'\x20vào\x20hàng\x20đợi\x20max:'+maxBotThreads,null,'i'),_0x415146[_0x5a20d6(0x221)](botQueue['add'](()=>xuLyGame(_0x301ba6,_0x301ba6['aks']))),log('[xuLyBrowser]:\x20Đã\x20thêm\x20profile\x20'+_0x301ba6[_0x5a20d6(0x1f9)]+'\x20vào\x20hàng\x20đợi.'),await delay(0x3e8);}return await Promise['all'](_0x415146),log(_0x5a20d6(0x1ee)),!![];}catch(_0x39b1ac){return log(_0x5a20d6(0x208)+_0x39b1ac,null,![]),log(_0x5a20d6(0x21b)+json(bots),null,![]),null;}}async function xuLyGame(_0x346522,_0x23f402){const _0xd77a9a=a0_0x10c4a6;try{if(signal[_0xd77a9a(0x1e7)]){log(_0xd77a9a(0x21d),null,'w');throw new Error('timeout');}if(_0x346522[_0xd77a9a(0x1fc)]===_0xd77a9a(0x1eb)){log(_0xd77a9a(0x1f0)+_0x346522['name']+_0xd77a9a(0x232),null,'i');const _0x216957=await genlogin[_0xd77a9a(0x220)](),_0x229d40=await http[_0xd77a9a(0x20e)](profileNameId,_0x346522[_0xd77a9a(0x1f9)],_0x216957[_0xd77a9a(0x218)],'',_0xd77a9a(0x1f5),_0xd77a9a(0x1ff)),_0x4b5b48=_0x229d40['ID'],_0x4a1ce9={'bot':_0x346522,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0x4b5b48},_0x37966d=await loadGameApi(_0x346522[_0xd77a9a(0x1f9)],_0x4a1ce9);if(!_0x37966d[_0xd77a9a(0x217)])return log(_0xd77a9a(0x22e)+_0x346522[_0xd77a9a(0x1f9)]+_0xd77a9a(0x201),null,![]),await http[_0xd77a9a(0x204)](profileNameId,_0x4b5b48,_0xd77a9a(0x1f6),_0xd77a9a(0x1f6)),null;if(_0x37966d[_0xd77a9a(0x217)]==_0xd77a9a(0x20f))return log(_0xd77a9a(0x22e)+_0x346522['name']+_0xd77a9a(0x1f1),null,'i'),await http[_0xd77a9a(0x204)](profileNameId,_0x4b5b48,_0xd77a9a(0x20f),_0xd77a9a(0x20f)),'loop';if(_0x37966d[_0xd77a9a(0x217)])return log(_0xd77a9a(0x22e)+_0x346522['name']+_0xd77a9a(0x219)),await http['nextRunTime'](profileNameId,_0x346522['id'],_0x37966d['nextRun'],_0x37966d[_0xd77a9a(0x202)]),await http[_0xd77a9a(0x204)](profileNameId,_0x4b5b48,'Ok','Done',_0x37966d[_0xd77a9a(0x226)],_0x37966d[_0xd77a9a(0x21f)]),!![];}return null;}catch(_0x106e42){return log('[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Bot:\x20'+_0x106e42,null,![]),null;}}function a0_0x3efc(_0x392529,_0x246bb9){const _0xd815f1=a0_0xd815();return a0_0x3efc=function(_0x3efcfd,_0x165430){_0x3efcfd=_0x3efcfd-0x1e5;let _0x5a62c8=_0xd815f1[_0x3efcfd];return _0x5a62c8;},a0_0x3efc(_0x392529,_0x246bb9);}async function loadGameApi(_0x3905e3,_0x10e52b){const _0x2a5b85=a0_0x10c4a6;try{const _0x5642e1=path[_0x2a5b85(0x215)](__dirname,_0x2a5b85(0x222),_0x3905e3+_0x2a5b85(0x22f)),_0x506f71=require(_0x5642e1);if(typeof _0x506f71===_0x2a5b85(0x1e9)){const _0x396907=await _0x506f71(_0x10e52b);return await delay(0x3e8),_0x396907[_0x2a5b85(0x217)]===_0x2a5b85(0x20f)?(log(_0x2a5b85(0x207)+_0x3905e3+_0x2a5b85(0x1f1)),_0x396907):(log(_0x2a5b85(0x207)+_0x3905e3+'\x20'+_0x396907['status']),_0x396907);}else return await delay(0x3e8),log(_0x2a5b85(0x1f7)+_0x3905e3+_0x2a5b85(0x22d)),null;}catch(_0x2cc3f8){return log(_0x2a5b85(0x200)+_0x3905e3+':\x20'+_0x2cc3f8,![]),null;}}async function delay(_0x1e4937){return new Promise(_0x5b4f33=>{const _0x477864=a0_0x3efc;if(signal[_0x477864(0x1e7)])throw new Error(_0x477864(0x214));setTimeout(_0x5b4f33,_0x1e4937);});}