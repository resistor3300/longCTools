const a30_0x534522=a30_0x4e2b;(function(_0x1a39e2,_0x1d6977){const _0x1d96e7=a30_0x4e2b,_0x110e15=_0x1a39e2();while(!![]){try{const _0x3ca9c9=parseInt(_0x1d96e7(0xad))/0x1*(-parseInt(_0x1d96e7(0xaf))/0x2)+-parseInt(_0x1d96e7(0x87))/0x3+parseInt(_0x1d96e7(0x6f))/0x4*(-parseInt(_0x1d96e7(0xb1))/0x5)+parseInt(_0x1d96e7(0x7a))/0x6*(parseInt(_0x1d96e7(0x9d))/0x7)+-parseInt(_0x1d96e7(0xa3))/0x8+parseInt(_0x1d96e7(0xb6))/0x9+parseInt(_0x1d96e7(0x6e))/0xa;if(_0x3ca9c9===_0x1d6977)break;else _0x110e15['push'](_0x110e15['shift']());}catch(_0x406365){_0x110e15['push'](_0x110e15['shift']());}}}(a30_0x117a,0xae334),require(a30_0x534522(0x69))[a30_0x534522(0xa0)]());const {Worker,parentPort}=require(a30_0x534522(0x91)),{log,json}=require(a30_0x534522(0x9c)),Genlogin=require(a30_0x534522(0x73)),httpPost=require('./modules/http'),path=require(a30_0x534522(0x76)),PQueue=require('p-queue')[a30_0x534522(0xa5)];let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process[a30_0x534522(0xb9)][a30_0x534522(0x72)],process['env'][a30_0x534522(0xa8)],!![]);let signal={'aborted':![]},firstRun=!![],maxBotThreads=0x1;parentPort['on'](a30_0x534522(0xb4),async _0x1b9a5f=>{const _0x54ff10=a30_0x534522,{profile:_0x1cfba5,maxBot:_0x735215}=_0x1b9a5f;try{if(_0x1cfba5==_0x54ff10(0x94))signal[_0x54ff10(0x92)]=!![],log(_0x54ff10(0xbc),null,'w');else{firstRun&&(firstRun=![],maxBotThreads=parseInt(_0x735215),botQueue=new PQueue({'concurrency':maxBotThreads}),log('[worker-api2]:\x20Max\x20Bot\x20threads:\x20'+maxBotThreads,null,'w'));if(signal[_0x54ff10(0x92)])throw new Error(_0x54ff10(0x94));log(_0x54ff10(0x89)+_0x1cfba5+_0x54ff10(0x9e),null,'w');const _0x150ec8=await xuLyProfile(_0x1cfba5);!_0x150ec8?(log(_0x54ff10(0xb7)+_0x1cfba5+_0x54ff10(0xa6),null,'w'),parentPort[_0x54ff10(0x8d)]({'success':![],'result':_0x150ec8})):(log('[xuLyProfile]:\x20Xử\x20lý\x20profile\x20'+_0x1cfba5+_0x54ff10(0xac),null,'i'),parentPort[_0x54ff10(0x8d)]({'success':!![],'result':_0x150ec8}));}}catch(_0xa7ff23){parentPort['postMessage']({'success':![],'error':{'message':_0xa7ff23[_0x54ff10(0xb4)],'stack':_0xa7ff23[_0x54ff10(0x9a)]}});}});async function xuLyProfile(_0xb6e37){const _0xc22c5c=a30_0x534522;try{if(signal[_0xc22c5c(0x92)]){log(_0xc22c5c(0x78),null,'w');throw new Error(_0xc22c5c(0x94));}profileNameId=_0xb6e37,log(_0xc22c5c(0x7d)+JSON[_0xc22c5c(0x98)](_0xb6e37),null,'i');const _0x38fc5e=await xuLyBrowser(_0xb6e37);return!_0x38fc5e?(log('[xuLyProfile]:\x20Xử\x20lý\x20browser\x20'+_0xb6e37+_0xc22c5c(0x79),null,'w'),null):(log(_0xc22c5c(0x90)+_0xb6e37+_0xc22c5c(0xac)),!![]);}catch(_0x477fe5){throw new Error(_0xc22c5c(0x8a)+_0x477fe5[_0xc22c5c(0xb4)]);}}async function xuLyBrowser(_0x3ff8fc){const _0x33e111=a30_0x534522;try{if(signal[_0x33e111(0x92)]){log(_0x33e111(0xb5),null,'w');throw new Error(_0x33e111(0x94));}let _0x74cc03=0x0;const _0x31c5ee=await http[_0x33e111(0x6d)](profileNameId);if(!_0x31c5ee){log(_0x33e111(0xba),null,![]);throw new Error(_0x33e111(0xab));}if(_0x31c5ee[_0x33e111(0x9b)]<=0x0){log(_0x33e111(0x83),null,![]);throw new Error(_0x33e111(0xab));}const _0x7a0a89=[];for(const _0x426dfb of _0x31c5ee){if(!_0x426dfb)continue;if(_0x426dfb[_0x33e111(0x99)]!=_0x33e111(0xbd))continue;if(signal[_0x33e111(0x92)]){log(_0x33e111(0x7b)+_0x426dfb[_0x33e111(0x6b)]+'\x20đã\x20bị\x20hủy',null,'w');throw new Error(_0x33e111(0x94));}if(_0x426dfb[_0x33e111(0x6c)]===_0x33e111(0x96)){log('['+profileNameId+_0x33e111(0x84),null,'i');break;}if(_0x426dfb[_0x33e111(0x86)]==='0'){log('['+profileNameId+_0x33e111(0x71)+json(_0x426dfb[_0x33e111(0x6b)])+_0x33e111(0xa4),null,![]);continue;}if(!_0x426dfb[_0x33e111(0xaa)]){log('['+profileNameId+_0x33e111(0x71)+json(_0x426dfb)+_0x33e111(0xb3),null,![]);continue;}const _0x3bde6b=await genlogin[_0x33e111(0x81)]();if(_0x426dfb[_0x33e111(0x95)]>_0x3bde6b[_0x33e111(0x70)]){log('['+profileNameId+_0x33e111(0x71)+json(_0x426dfb[_0x33e111(0x6b)])+_0x33e111(0x82),null,'w');continue;}log(_0x33e111(0xa1)+_0x426dfb[_0x33e111(0x6b)]+_0x33e111(0xb8)+maxBotThreads,null,'i'),_0x7a0a89['push'](botQueue[_0x33e111(0x7f)](()=>xuLyGame(_0x426dfb,_0x426dfb['aks']))),log('[xuLyBrowser]:\x20Đã\x20thêm\x20profile\x20'+_0x426dfb[_0x33e111(0x6b)]+'\x20vào\x20hàng\x20đợi.'),await delay(0x3e8);}return await Promise[_0x33e111(0x97)](_0x7a0a89),log(_0x33e111(0xbb)),!![];}catch(_0x4de0a8){return log('[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20'+_0x4de0a8,null,![]),log('[xuLyBrowser]:\x20'+json(bots),null,![]),null;}}function a30_0x117a(){const _0x50b9fd=['[xuLyProfile]:đã\x20bị\x20hủy','\x20thất\x20bại','15486vBaVHp','[xuLyBrowser]:\x20Bot\x20','[loadGameApi]:\x20Chạy\x20','[xuLyProfile]:\x20Processing\x20profile:\x20','nextRun','add','join','nowTime','\x20Chưa\x20tới\x20giờ\x20chạy','[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot',']:\x20XONG\x201\x20LƯỢT','\x20loop','onOff','3993630nRxSwO','status','[\x27worker-api2][','Lỗi\x20xử\x20lý\x20profile:\x20','running','[xuLyGame]:đã\x20bị\x20hủy','postMessage','[loadGameApi]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','updateData','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','worker_threads','aborted','[loadGameApi]:\x20Script\x20','timeout','nextRunStamp','end','all','stringify','type','stack','length','./modules/logger','385IyZsuD',']:\x20Api\x20Mode','Done','config','[xuLyBrowser]:\x20Thêm\x20Bot\x20','loop','9899752gntojj','\x20OFF','default','\x20có\x20lỗi','date','APIKEY','function','aks','No\x20bot\x20found','\x20thành\x20công','431fFmewk','toolApi','482pbOhdA','nextRunTime','4597805qihkcg','.js','\x20ko\x20có\x20aks','message','[xuLyBrowser]:đã\x20bị\x20hủy','533727qpBPfD','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','\x20vào\x20hàng\x20đợi\x20max:','env','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy','[xuLyBrowser]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20bots\x20thành\x20công','[worker-api2]:timeout','api','dotenv','Fail','name','value','getBotAll','41043770uJEPdf','4malmem','timestamp',']:\x20Bot\x20','SERVER_HOST','./modules/Genlogin','\x20done','StartApi','path','[xuLyGame]:\x20Thực\x20thi\x20'];a30_0x117a=function(){return _0x50b9fd;};return a30_0x117a();}function a30_0x4e2b(_0x5901a2,_0x333c89){const _0x117a25=a30_0x117a();return a30_0x4e2b=function(_0x4e2b97,_0x3f9cca){_0x4e2b97=_0x4e2b97-0x69;let _0x4205f7=_0x117a25[_0x4e2b97];return _0x4205f7;},a30_0x4e2b(_0x5901a2,_0x333c89);}async function xuLyGame(_0x19325b,_0x2c0ec7){const _0x442555=a30_0x534522;try{if(signal[_0x442555(0x92)]){log(_0x442555(0x8c),null,'w');throw new Error(_0x442555(0x94));}if(_0x19325b[_0x442555(0x99)]===_0x442555(0xbd)){log('[xuLyGame]:\x20'+_0x19325b[_0x442555(0x6b)]+'\x20Api\x20mode',null,'i');const _0x68c38a=await genlogin[_0x442555(0x81)](),_0x279796=await http['addData'](profileNameId,_0x19325b[_0x442555(0x6b)],_0x68c38a[_0x442555(0xa7)],'',_0x442555(0x75),_0x442555(0x8b)),_0x2b4292=_0x279796['ID'],_0xc4e3fd={'bot':_0x19325b,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0x2b4292},_0x5865aa=await loadGameApi(_0x19325b['name'],_0xc4e3fd);if(!_0x5865aa[_0x442555(0x88)])return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0x19325b[_0x442555(0x6b)]+'\x20lỗi',null,![]),await http[_0x442555(0x8f)](profileNameId,_0x2b4292,'Fail',_0x442555(0x6a)),null;if(_0x5865aa[_0x442555(0x88)]==_0x442555(0xa2))return log(_0x442555(0x77)+_0x19325b[_0x442555(0x6b)]+_0x442555(0x85),null,'i'),await http[_0x442555(0x8f)](profileNameId,_0x2b4292,_0x442555(0xa2),_0x442555(0xa2)),_0x442555(0xa2);if(_0x5865aa[_0x442555(0x88)])return log(_0x442555(0x77)+_0x19325b[_0x442555(0x6b)]+_0x442555(0x74)),await http[_0x442555(0xb0)](profileNameId,_0x19325b['id'],_0x5865aa['nextRun'],_0x5865aa[_0x442555(0x95)]),await http['updateData'](profileNameId,_0x2b4292,'Ok',_0x442555(0x9f),_0x5865aa['coin'],_0x5865aa[_0x442555(0x7e)]),!![];}return null;}catch(_0x407b14){return log('[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Bot:\x20'+_0x407b14,null,![]),null;}}async function loadGameApi(_0x2188e6,_0x3ff2e7){const _0x583bc5=a30_0x534522;try{const _0x1671d9=path[_0x583bc5(0x80)](__dirname,_0x583bc5(0xae),_0x2188e6+_0x583bc5(0xb2)),_0x3f237d=require(_0x1671d9);if(typeof _0x3f237d===_0x583bc5(0xa9)){const _0xd70df7=await _0x3f237d(_0x3ff2e7);return await delay(0x3e8),_0xd70df7['status']===_0x583bc5(0xa2)?(log(_0x583bc5(0x7c)+_0x2188e6+'\x20loop'),_0xd70df7):(log(_0x583bc5(0x7c)+_0x2188e6+'\x20'+_0xd70df7[_0x583bc5(0x88)]),_0xd70df7);}else return await delay(0x3e8),log(_0x583bc5(0x93)+_0x2188e6+'\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ'),null;}catch(_0x353993){return log(_0x583bc5(0x8e)+_0x2188e6+':\x20'+_0x353993,![]),null;}}async function delay(_0x38f33b){return new Promise(_0x43d784=>{const _0x14474f=a30_0x4e2b;if(signal['aborted'])throw new Error(_0x14474f(0x94));setTimeout(_0x43d784,_0x38f33b);});}