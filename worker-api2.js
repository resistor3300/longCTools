const a30_0x2db70e=a30_0x11e9;(function(_0x461285,_0x36f79f){const _0x25c0a6=a30_0x11e9,_0x1c45d4=_0x461285();while(!![]){try{const _0x1e4740=-parseInt(_0x25c0a6(0x1b8))/0x1*(parseInt(_0x25c0a6(0x1b0))/0x2)+parseInt(_0x25c0a6(0x1d3))/0x3+parseInt(_0x25c0a6(0x1a5))/0x4+-parseInt(_0x25c0a6(0x1c0))/0x5*(-parseInt(_0x25c0a6(0x19d))/0x6)+-parseInt(_0x25c0a6(0x1a7))/0x7*(-parseInt(_0x25c0a6(0x1ce))/0x8)+parseInt(_0x25c0a6(0x1b1))/0x9+-parseInt(_0x25c0a6(0x1e4))/0xa;if(_0x1e4740===_0x36f79f)break;else _0x1c45d4['push'](_0x1c45d4['shift']());}catch(_0x415e97){_0x1c45d4['push'](_0x1c45d4['shift']());}}}(a30_0xf35c,0x9f0a7),require('dotenv')[a30_0x2db70e(0x1c1)]());const {Worker,parentPort}=require(a30_0x2db70e(0x1ac)),{log,json}=require(a30_0x2db70e(0x1b5)),Genlogin=require(a30_0x2db70e(0x1a0)),httpPost=require(a30_0x2db70e(0x1d7)),path=require(a30_0x2db70e(0x1d8)),PQueue=require(a30_0x2db70e(0x1a4))[a30_0x2db70e(0x1b7)];let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process['env'][a30_0x2db70e(0x1af)],process[a30_0x2db70e(0x19c)][a30_0x2db70e(0x1d9)],!![]);let signal={'aborted':![]},firstRun=!![],maxBotThreads=0x1;function a30_0xf35c(){const _0x7d9cdc=['push','[xuLyGame]:\x20','[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot','[worker-api2]:timeout','status','[loadGameApi]:\x20Chạy\x20','nextRun','coin','[loadGameApi]:\x20Script\x20','Fail','No\x20bot\x20found','env','30aZEnPu','timestamp','[loadGameApi]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','./modules/Genlogin','[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy','StartApi','[worker-api2]:\x20Max\x20Bot\x20threads:\x20','p-queue','1174788akeOut','\x20OFF','21AqRTYf',']:\x20XONG\x201\x20LƯỢT','function','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','aborted','worker_threads','timeout','\x20vào\x20hàng\x20đợi.','SERVER_HOST','512114Ttkjni','1244133AHHouR','postMessage','length','nowTime','./modules/logger','[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Bot:\x20','default','1bmkIlU','running','onOff','updateData','[xuLyBrowser]:đã\x20bị\x20hủy','api','[xuLyProfile]:\x20Processing\x20profile:\x20','\x20đã\x20bị\x20hủy','1036075bhTPlF','config','\x20loop','[xuLyBrowser]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20bots\x20thành\x20công','nextRunStamp','loop','[xuLyGame]:\x20Thực\x20thi\x20','name','add','\x20lỗi','message','stack','stringify',']:\x20Bot\x20','2742232csPEMA','all','[\x27worker-api2][','[xuLyBrowser]:\x20Bot\x20','[xuLyBrowser]:\x20Thêm\x20Bot\x20','1215618wqeGQL','aks','\x20ko\x20có\x20aks',']:\x20Api\x20Mode','./modules/http','path','APIKEY','Done','[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20','\x20thành\x20công','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','type','nextRunTime','\x20thất\x20bại','[xuLyGame]:đã\x20bị\x20hủy','\x20vào\x20hàng\x20đợi\x20max:','[xuLyBrowser]:\x20Đã\x20thêm\x20profile\x20','19940640WawgVR','\x20Chưa\x20tới\x20giờ\x20chạy','\x20có\x20lỗi','addData'];a30_0xf35c=function(){return _0x7d9cdc;};return a30_0xf35c();}parentPort['on'](a30_0x2db70e(0x1ca),async _0xba92df=>{const _0x4b108a=a30_0x2db70e,{profile:_0x307a2d,maxBot:_0x73c6b6}=_0xba92df;try{if(_0x307a2d=='timeout')signal[_0x4b108a(0x1ab)]=!![],log(_0x4b108a(0x1eb),null,'w');else{firstRun&&(firstRun=![],maxBotThreads=parseInt(_0x73c6b6),botQueue=new PQueue({'concurrency':maxBotThreads}),log(_0x4b108a(0x1a3)+maxBotThreads,null,'w'));if(signal[_0x4b108a(0x1ab)])throw new Error(_0x4b108a(0x1ad));log(_0x4b108a(0x1d0)+_0x307a2d+_0x4b108a(0x1d6),null,'w');const _0x1fb736=await xuLyProfile(_0x307a2d);!_0x1fb736?(log(_0x4b108a(0x1dd)+_0x307a2d+_0x4b108a(0x1e6),null,'w'),parentPort['postMessage']({'success':![],'result':_0x1fb736})):(log('[xuLyProfile]:\x20Xử\x20lý\x20profile\x20'+_0x307a2d+_0x4b108a(0x1dc),null,'i'),parentPort[_0x4b108a(0x1b2)]({'success':!![],'result':_0x1fb736}));}}catch(_0x11d6c3){parentPort[_0x4b108a(0x1b2)]({'success':![],'error':{'message':_0x11d6c3[_0x4b108a(0x1ca)],'stack':_0x11d6c3[_0x4b108a(0x1cb)]}});}});async function xuLyProfile(_0x1f3e3c){const _0x55c3ab=a30_0x2db70e;try{if(signal['aborted']){log('[xuLyProfile]:đã\x20bị\x20hủy',null,'w');throw new Error('timeout');}profileNameId=_0x1f3e3c,log(_0x55c3ab(0x1be)+JSON[_0x55c3ab(0x1cc)](_0x1f3e3c),null,'i');const _0x59a47f=await xuLyBrowser(_0x1f3e3c);return!_0x59a47f?(log(_0x55c3ab(0x1aa)+_0x1f3e3c+_0x55c3ab(0x1e0),null,'w'),null):(log(_0x55c3ab(0x1aa)+_0x1f3e3c+_0x55c3ab(0x1dc)),!![]);}catch(_0x505d4e){throw new Error('Lỗi\x20xử\x20lý\x20profile:\x20'+_0x505d4e[_0x55c3ab(0x1ca)]);}}function a30_0x11e9(_0x3530e5,_0xa44f94){const _0xf35c9b=a30_0xf35c();return a30_0x11e9=function(_0x11e946,_0x218b5d){_0x11e946=_0x11e946-0x19b;let _0x341e12=_0xf35c9b[_0x11e946];return _0x341e12;},a30_0x11e9(_0x3530e5,_0xa44f94);}async function xuLyBrowser(_0x24e8af){const _0x5c3835=a30_0x2db70e;try{if(signal[_0x5c3835(0x1ab)]){log(_0x5c3835(0x1bc),null,'w');throw new Error(_0x5c3835(0x1ad));}let _0x521d3f=0x0;const _0x491760=await http['getBotAll'](profileNameId);if(!_0x491760){log(_0x5c3835(0x1a1),null,![]);throw new Error(_0x5c3835(0x19b));}if(_0x491760[_0x5c3835(0x1b3)]<=0x0){log(_0x5c3835(0x1ea),null,![]);throw new Error(_0x5c3835(0x19b));}const _0x25caf3=[];for(const _0x78fe0e of _0x491760){if(!_0x78fe0e)continue;if(_0x78fe0e[_0x5c3835(0x1de)]!=_0x5c3835(0x1bd))continue;if(signal['aborted']){log(_0x5c3835(0x1d1)+_0x78fe0e[_0x5c3835(0x1c7)]+_0x5c3835(0x1bf),null,'w');throw new Error(_0x5c3835(0x1ad));}if(_0x78fe0e['value']==='end'){log('['+profileNameId+_0x5c3835(0x1a8),null,'i');break;}if(_0x78fe0e[_0x5c3835(0x1ba)]==='0'){log('['+profileNameId+_0x5c3835(0x1cd)+json(_0x78fe0e[_0x5c3835(0x1c7)])+_0x5c3835(0x1a6),null,![]);continue;}if(!_0x78fe0e[_0x5c3835(0x1d4)]){log('['+profileNameId+']:\x20Bot\x20'+json(_0x78fe0e)+_0x5c3835(0x1d5),null,![]);continue;}const _0x3fb947=await genlogin['nowTime']();if(_0x78fe0e[_0x5c3835(0x1c4)]>_0x3fb947[_0x5c3835(0x19e)]){log('['+profileNameId+_0x5c3835(0x1cd)+json(_0x78fe0e[_0x5c3835(0x1c7)])+_0x5c3835(0x1e5),null,'w');continue;}log(_0x5c3835(0x1d2)+_0x78fe0e['name']+_0x5c3835(0x1e2)+maxBotThreads,null,'i'),_0x25caf3[_0x5c3835(0x1e8)](botQueue[_0x5c3835(0x1c8)](()=>xuLyGame(_0x78fe0e,_0x78fe0e[_0x5c3835(0x1d4)]))),log(_0x5c3835(0x1e3)+_0x78fe0e[_0x5c3835(0x1c7)]+_0x5c3835(0x1ae)),await delay(0x3e8);}return await Promise[_0x5c3835(0x1cf)](_0x25caf3),log(_0x5c3835(0x1c3)),!![];}catch(_0x1b6d2c){return log(_0x5c3835(0x1db)+_0x1b6d2c,null,![]),log('[xuLyBrowser]:\x20'+json(bots),null,![]),null;}}async function xuLyGame(_0x598dce,_0x3c12f3){const _0x7f64dc=a30_0x2db70e;try{if(signal[_0x7f64dc(0x1ab)]){log(_0x7f64dc(0x1e1),null,'w');throw new Error('timeout');}if(_0x598dce[_0x7f64dc(0x1de)]===_0x7f64dc(0x1bd)){log(_0x7f64dc(0x1e9)+_0x598dce[_0x7f64dc(0x1c7)]+'\x20Api\x20mode',null,'i');const _0x4aec6d=await genlogin[_0x7f64dc(0x1b4)](),_0x2a7f69=await http[_0x7f64dc(0x1e7)](profileNameId,_0x598dce[_0x7f64dc(0x1c7)],_0x4aec6d['date'],'',_0x7f64dc(0x1a2),_0x7f64dc(0x1b9)),_0xdc4da5=_0x2a7f69['ID'],_0x3859ee={'bot':_0x598dce,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0xdc4da5},_0x16f0c1=await loadGameApi(_0x598dce['name'],_0x3859ee);if(!_0x16f0c1['status'])return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0x598dce[_0x7f64dc(0x1c7)]+_0x7f64dc(0x1c9),null,![]),await http[_0x7f64dc(0x1bb)](profileNameId,_0xdc4da5,_0x7f64dc(0x1f1),_0x7f64dc(0x1f1)),null;if(_0x16f0c1[_0x7f64dc(0x1ec)]=='loop')return log(_0x7f64dc(0x1c6)+_0x598dce[_0x7f64dc(0x1c7)]+'\x20loop',null,'i'),await http[_0x7f64dc(0x1bb)](profileNameId,_0xdc4da5,_0x7f64dc(0x1c5),_0x7f64dc(0x1c5)),_0x7f64dc(0x1c5);if(_0x16f0c1[_0x7f64dc(0x1ec)])return log(_0x7f64dc(0x1c6)+_0x598dce[_0x7f64dc(0x1c7)]+'\x20done'),await http[_0x7f64dc(0x1df)](profileNameId,_0x598dce['id'],_0x16f0c1[_0x7f64dc(0x1ee)],_0x16f0c1[_0x7f64dc(0x1c4)]),await http['updateData'](profileNameId,_0xdc4da5,'Ok',_0x7f64dc(0x1da),_0x16f0c1[_0x7f64dc(0x1ef)],_0x16f0c1['nextRun']),!![];}return null;}catch(_0x59d71f){return log(_0x7f64dc(0x1b6)+_0x59d71f,null,![]),null;}}async function loadGameApi(_0xc02a77,_0x129407){const _0x528c48=a30_0x2db70e;try{const _0x13bfe6=path['join'](__dirname,'toolApi',_0xc02a77+'.js'),_0x4bbef2=require(_0x13bfe6);if(typeof _0x4bbef2===_0x528c48(0x1a9)){const _0x28d757=await _0x4bbef2(_0x129407);return await delay(0x3e8),_0x28d757['status']===_0x528c48(0x1c5)?(log(_0x528c48(0x1ed)+_0xc02a77+_0x528c48(0x1c2)),_0x28d757):(log(_0x528c48(0x1ed)+_0xc02a77+'\x20'+_0x28d757[_0x528c48(0x1ec)]),_0x28d757);}else return await delay(0x3e8),log(_0x528c48(0x1f0)+_0xc02a77+'\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ'),null;}catch(_0x514d59){return log(_0x528c48(0x19f)+_0xc02a77+':\x20'+_0x514d59,![]),null;}}async function delay(_0x54cb8b){return new Promise(_0x185f8e=>{const _0x3a934c=a30_0x11e9;if(signal[_0x3a934c(0x1ab)])throw new Error(_0x3a934c(0x1ad));setTimeout(_0x185f8e,_0x54cb8b);});}