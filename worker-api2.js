const a30_0x5d4420=a30_0x4a59;(function(_0x280186,_0x4e37ba){const _0x57d42a=a30_0x4a59,_0x200374=_0x280186();while(!![]){try{const _0x153129=parseInt(_0x57d42a(0x13e))/0x1+parseInt(_0x57d42a(0xfd))/0x2*(parseInt(_0x57d42a(0xff))/0x3)+-parseInt(_0x57d42a(0x11f))/0x4*(parseInt(_0x57d42a(0x102))/0x5)+parseInt(_0x57d42a(0x101))/0x6+-parseInt(_0x57d42a(0x10c))/0x7+-parseInt(_0x57d42a(0x120))/0x8+parseInt(_0x57d42a(0xfe))/0x9*(parseInt(_0x57d42a(0x106))/0xa);if(_0x153129===_0x4e37ba)break;else _0x200374['push'](_0x200374['shift']());}catch(_0x18df8f){_0x200374['push'](_0x200374['shift']());}}}(a30_0x4947,0x97fb6),require('dotenv')[a30_0x5d4420(0x145)]());const {Worker,parentPort}=require(a30_0x5d4420(0x137)),{log,json}=require(a30_0x5d4420(0x10a)),Genlogin=require(a30_0x5d4420(0x143)),httpPost=require('./modules/http'),path=require(a30_0x5d4420(0x13d)),PQueue=require(a30_0x5d4420(0x127))[a30_0x5d4420(0x13b)];let genlogin,profileNameId,profileId,browser,dataId;const timGame=!![];genlogin=new Genlogin('',!![]);const http=new httpPost(process[a30_0x5d4420(0xfa)]['SERVER_HOST'],process[a30_0x5d4420(0xfa)]['APIKEY'],!![]);let signal={'aborted':![]},firstRun=!![],maxBotThreads=0x1;parentPort['on'](a30_0x5d4420(0x142),async _0x55fedd=>{const _0x55608f=a30_0x5d4420,{profile:_0xff547e,maxBot:_0x33f06f}=_0x55fedd;try{if(_0xff547e==_0x55608f(0x111))signal[_0x55608f(0x11d)]=!![],log(_0x55608f(0x13f),null,'w');else{firstRun&&(firstRun=![],maxBotThreads=parseInt(_0x33f06f),botQueue=new PQueue({'concurrency':maxBotThreads}),log(_0x55608f(0x12b)+maxBotThreads,null,'w'));if(signal[_0x55608f(0x11d)])throw new Error('timeout');log('[\x27worker-api2]['+_0xff547e+_0x55608f(0x147),null,'w');const _0x41e8cf=await xuLyProfile(_0xff547e);!_0x41e8cf?(log(_0x55608f(0x139)+_0xff547e+'\x20có\x20lỗi',null,'w'),parentPort[_0x55608f(0x11a)]({'success':![],'result':_0x41e8cf})):(log(_0x55608f(0x139)+_0xff547e+'\x20thành\x20công',null,'i'),parentPort[_0x55608f(0x11a)]({'success':!![],'result':_0x41e8cf}));}}catch(_0x254363){parentPort[_0x55608f(0x11a)]({'success':![],'error':{'message':_0x254363[_0x55608f(0x142)],'stack':_0x254363['stack']}});}});function a30_0x4a59(_0x38c531,_0x2d4ffc){const _0x494783=a30_0x4947();return a30_0x4a59=function(_0x4a599b,_0x148fdd){_0x4a599b=_0x4a599b-0xf8;let _0x4fa77e=_0x494783[_0x4a599b];return _0x4fa77e;},a30_0x4a59(_0x38c531,_0x2d4ffc);}async function xuLyProfile(_0x54c589){const _0x4d91f9=a30_0x5d4420;try{if(signal[_0x4d91f9(0x11d)]){log(_0x4d91f9(0x113),null,'w');throw new Error(_0x4d91f9(0x111));}profileNameId=_0x54c589,log(_0x4d91f9(0x13c)+JSON[_0x4d91f9(0x121)](_0x54c589),null,'i');const _0x1148b2=await xuLyBrowser(_0x54c589);return!_0x1148b2?(log('[xuLyProfile]:\x20Xử\x20lý\x20browser\x20'+_0x54c589+_0x4d91f9(0x100),null,'w'),null):(log(_0x4d91f9(0x11e)+_0x54c589+_0x4d91f9(0x10e)),!![]);}catch(_0x4651c8){throw new Error(_0x4d91f9(0x134)+_0x4651c8[_0x4d91f9(0x142)]);}}async function xuLyBrowser(_0x184530){const _0x1c5f40=a30_0x5d4420;try{if(signal[_0x1c5f40(0x11d)]){log(_0x1c5f40(0x10f),null,'w');throw new Error(_0x1c5f40(0x111));}let _0x3c337c=0x0;const _0x1a8654=await http[_0x1c5f40(0x136)](profileNameId);if(!_0x1a8654){log('[xuLyBrowser]:\x20Bot\x20không\x20tìm\x20thấy',null,![]);throw new Error(_0x1c5f40(0x11c));}if(_0x1a8654[_0x1c5f40(0x103)]<=0x0){log('[xuLyBrowser]:\x20không\x20lấy\x20được\x20bot',null,![]);throw new Error('No\x20bot\x20found');}const _0x1b44d9=[];for(const _0x36100f of _0x1a8654){if(!_0x36100f)continue;if(_0x36100f['type']!=_0x1c5f40(0x122))continue;if(signal[_0x1c5f40(0x11d)]){log(_0x1c5f40(0x131)+_0x36100f[_0x1c5f40(0x109)]+_0x1c5f40(0x119),null,'w');throw new Error('timeout');}if(_0x36100f[_0x1c5f40(0x12c)]==='end'){log('['+profileNameId+_0x1c5f40(0x110),null,'i');break;}if(_0x36100f['onOff']==='0'){log('['+profileNameId+_0x1c5f40(0x116)+json(_0x36100f['name'])+_0x1c5f40(0x114),null,![]);continue;}if(!_0x36100f[_0x1c5f40(0x107)]){log('['+profileNameId+_0x1c5f40(0x116)+json(_0x36100f)+_0x1c5f40(0x130),null,![]);continue;}const _0x37ef3c=await genlogin[_0x1c5f40(0x115)]();if(_0x36100f['nextRunStamp']>_0x37ef3c['timestamp']){log('['+profileNameId+_0x1c5f40(0x116)+json(_0x36100f[_0x1c5f40(0x109)])+_0x1c5f40(0x108),null,'w');continue;}log(_0x1c5f40(0x104)+_0x36100f[_0x1c5f40(0x109)]+_0x1c5f40(0x12e)+maxBotThreads,null,'i'),_0x1b44d9['push'](botQueue['add'](()=>xuLyGame(_0x36100f,_0x36100f[_0x1c5f40(0x107)]))),log(_0x1c5f40(0xfc)+_0x36100f[_0x1c5f40(0x109)]+_0x1c5f40(0x124)),await delay(0x3e8);}return await Promise['all'](_0x1b44d9),log(_0x1c5f40(0x132)),!![];}catch(_0x135ac7){return log(_0x1c5f40(0x144)+_0x135ac7,null,![]),log('[xuLyBrowser]:\x20'+json(bots),null,![]),null;}}async function xuLyGame(_0x391136,_0x6639fe){const _0xcda9fa=a30_0x5d4420;try{if(signal[_0xcda9fa(0x11d)]){log(_0xcda9fa(0x135),null,'w');throw new Error(_0xcda9fa(0x111));}if(_0x391136[_0xcda9fa(0x12f)]==='api'){log(_0xcda9fa(0xf9)+_0x391136[_0xcda9fa(0x109)]+_0xcda9fa(0x140),null,'i');const _0x15aa4d=await genlogin[_0xcda9fa(0x115)](),_0x49e598=await http[_0xcda9fa(0x126)](profileNameId,_0x391136[_0xcda9fa(0x109)],_0x15aa4d['date'],'',_0xcda9fa(0x128),'running'),_0xb774c6=_0x49e598['ID'],_0x494649={'bot':_0x391136,'profileNameId':profileNameId,'genlogin':genlogin,'http':http,'dataId':_0xb774c6},_0xea8a00=await loadGameApi(_0x391136['name'],_0x494649);if(!_0xea8a00[_0xcda9fa(0x12d)])return log('[xuLyGame]:\x20Thực\x20thi\x20'+_0x391136[_0xcda9fa(0x109)]+'\x20lỗi',null,![]),await http[_0xcda9fa(0x117)](profileNameId,_0xb774c6,_0xcda9fa(0xf8),'Fail'),null;if(_0xea8a00[_0xcda9fa(0x12d)]=='loop')return log(_0xcda9fa(0x129)+_0x391136[_0xcda9fa(0x109)]+'\x20loop',null,'i'),await http[_0xcda9fa(0x117)](profileNameId,_0xb774c6,_0xcda9fa(0xfb),_0xcda9fa(0xfb)),_0xcda9fa(0xfb);if(_0xea8a00[_0xcda9fa(0x12d)])return log(_0xcda9fa(0x129)+_0x391136['name']+_0xcda9fa(0x11b)),await http[_0xcda9fa(0x138)](profileNameId,_0x391136['id'],_0xea8a00[_0xcda9fa(0x12a)],_0xea8a00[_0xcda9fa(0x105)]),await http['updateData'](profileNameId,_0xb774c6,'Ok',_0xcda9fa(0x112),_0xea8a00['coin'],_0xea8a00[_0xcda9fa(0x12a)]),!![];}return null;}catch(_0x1a0ef1){return log(_0xcda9fa(0x10b)+_0x1a0ef1,null,![]),null;}}function a30_0x4947(){const _0x31b8fa=['[xuLyGame]:\x20Thực\x20thi\x20','nextRun','[worker-api2]:\x20Max\x20Bot\x20threads:\x20','value','status','\x20vào\x20hàng\x20đợi\x20max:','type','\x20ko\x20có\x20aks','[xuLyBrowser]:\x20Bot\x20','[xuLyBrowser]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20bots\x20thành\x20công','\x20không\x20phải\x20là\x20một\x20hàm\x20hợp\x20lệ','Lỗi\x20xử\x20lý\x20profile:\x20','[xuLyGame]:đã\x20bị\x20hủy','getBotAll','worker_threads','nextRunTime','[xuLyProfile]:\x20Xử\x20lý\x20profile\x20','function','default','[xuLyProfile]:\x20Processing\x20profile:\x20','path','440875pZXPqq','[worker-api2]:timeout','\x20Api\x20mode','[loadGameApi]:\x20Chạy\x20','message','./modules/Genlogin','[xuLyBrowser]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20browser:\x20','config','\x20loop',']:\x20Api\x20Mode','Fail','[xuLyGame]:\x20','env','loop','[xuLyBrowser]:\x20Đã\x20thêm\x20profile\x20','1069630TWBQyC','153081rDfaPI','6yjYquL','\x20thất\x20bại','3239622SxLiOL','1945GGkCHr','length','[xuLyBrowser]:\x20Thêm\x20Bot\x20','nextRunStamp','730tNxpdt','aks','\x20Chưa\x20tới\x20giờ\x20chạy','name','./modules/logger','[xuLyGame]:\x20Lỗi\x20trong\x20quá\x20trình\x20xử\x20lý\x20Bot:\x20','6218303qaAlbN','[loadGameApi]:\x20Lỗi\x20khi\x20load\x20và\x20thực\x20thi\x20script\x20','\x20thành\x20công','[xuLyBrowser]:đã\x20bị\x20hủy',']:\x20XONG\x201\x20LƯỢT','timeout','Done','[xuLyProfile]:đã\x20bị\x20hủy','\x20OFF','nowTime',']:\x20Bot\x20','updateData','.js','\x20đã\x20bị\x20hủy','postMessage','\x20done','No\x20bot\x20found','aborted','[xuLyProfile]:\x20Xử\x20lý\x20browser\x20','12216qjXxmY','4745968BDacQM','stringify','api','join','\x20vào\x20hàng\x20đợi.','[loadGameApi]:\x20Script\x20','addData','p-queue','StartApi'];a30_0x4947=function(){return _0x31b8fa;};return a30_0x4947();}async function loadGameApi(_0x38c3f6,_0x438f3a){const _0x1c12bd=a30_0x5d4420;try{const _0xf2e46=path[_0x1c12bd(0x123)](__dirname,'toolApi',_0x38c3f6+_0x1c12bd(0x118)),_0x229348=require(_0xf2e46);if(typeof _0x229348===_0x1c12bd(0x13a)){const _0x9fed1e=await _0x229348(_0x438f3a);return await delay(0x3e8),_0x9fed1e[_0x1c12bd(0x12d)]===_0x1c12bd(0xfb)?(log(_0x1c12bd(0x141)+_0x38c3f6+_0x1c12bd(0x146)),_0x9fed1e):(log(_0x1c12bd(0x141)+_0x38c3f6+'\x20'+_0x9fed1e[_0x1c12bd(0x12d)]),_0x9fed1e);}else return await delay(0x3e8),log(_0x1c12bd(0x125)+_0x38c3f6+_0x1c12bd(0x133)),null;}catch(_0x983300){return log(_0x1c12bd(0x10d)+_0x38c3f6+':\x20'+_0x983300,![]),null;}}async function delay(_0x40619c){return new Promise(_0x5f1ba7=>{const _0x233711=a30_0x4a59;if(signal[_0x233711(0x11d)])throw new Error(_0x233711(0x111));setTimeout(_0x5f1ba7,_0x40619c);});}