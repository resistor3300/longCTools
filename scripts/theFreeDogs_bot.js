function a0_0x415c(){const _0x484e26=['][Lỗi]:\x20','switchFrame','replace','readFile','][click][Lỗi]:\x20','maxday','][lamQuest]Không\x20tìm\x20thấy\x20quest','split','651WSTBrN','][lamQuest]Click\x20quest\x20OK','tapElement','6lhCHyD','NextRunStamp','][lamQuest]Làm\x20Quest\x20nè','//i[contains(@class,\x27_close-icon\x27)]','][lamQuest]Không\x20click\x20được\x20vào\x20quest','8bnRwLt','utf8',']Xử\x20lý\x20thoigianconlai\x20OK','toLocaleDateString','en-GB',']Ra\x20game\x20nè',']Vào\x20game\x20OK',']Auto\x20tap\x20','Không\x20tìm\x20thấy\x20dailyLeft','url',']Đã\x20đạt\x20đến\x20hạn\x20ngày','\x20OK','\x20nè','Iframe','Không\x20tìm\x20thấy\x20iframe',']nextRunAt:\x20','dailyLeft',']không\x20xử\x20lý\x20được\x20thoigianconlai','][autoTap]\x20Đã\x20tap\x20xong','9517160Uvghcm','00h00m','129143yFlXUl',']Tìm\x20thấy\x20dailyLeft','][thoigianconlai]:\x20','closePopup','2889261BlFXrB','floor','getTextByXPath','Không\x20tìm\x20thấy\x20quest','][autoTap]\x20Đã\x20đạt\x20đến\x20hạn\x20ngày','][click]Không\x20click\x20được\x20vào\x20','mainframe',']không\x20Tìm\x20thấy\x20dailyLeft',']Tìm\x20thấy\x20coin:\x20','length','][autotap]\x20Đang\x20chờ\x20tap\x20xong\x20','updateData','load','1h00m','][click]Click\x20','javascript','-autoTap',']tìm\x20thấy\x20closePopup',']Không\x20tìm\x20thấy\x20iframe','elementExistsByXPath','//p[text()=\x27Quest\x27]',']Không\x20xử\x20lý\x20fullHp','now','join','900835ZbjQaA','error:\x20','dirname','quest','NextRun',']Đã\x20tìm\x20thấy\x20iframe','][autoTap]\x20Đã\x20đạt\x20đến\x20số\x20lần\x20thử\x20tối\x20đa\x20','150743GJuvFN','470412GajFeo',']Vào\x20game\x20nè','2142eNyoAB','][xuLyFullHp]:\x20','click','][thoigianconlai]:Xử\x20lý\x20gian\x20còn\x20lại\x20nè','Không\x20xử\x20lý\x20fullHp',']không\x20Tìm\x20thấy\x20coinTag','toLocaleTimeString'];a0_0x415c=function(){return _0x484e26;};return a0_0x415c();}const a0_0xd22dfb=a0_0x4d6c;(function(_0x8b4a5a,_0x549a46){const _0xad529c=a0_0x4d6c,_0x2e1e98=_0x8b4a5a();while(!![]){try{const _0x4c074b=-parseInt(_0xad529c(0x1f8))/0x1+parseInt(_0xad529c(0x1fb))/0x2*(-parseInt(_0xad529c(0x20a))/0x3)+parseInt(_0xad529c(0x1f9))/0x4+-parseInt(_0xad529c(0x1f1))/0x5*(parseInt(_0xad529c(0x20d))/0x6)+parseInt(_0xad529c(0x1d5))/0x7*(-parseInt(_0xad529c(0x212))/0x8)+-parseInt(_0xad529c(0x1d9))/0x9+parseInt(_0xad529c(0x1d3))/0xa;if(_0x4c074b===_0x549a46)break;else _0x2e1e98['push'](_0x2e1e98['shift']());}catch(_0x55fc72){_0x2e1e98['push'](_0x2e1e98['shift']());}}}(a0_0x415c,0x28a7c));import{log,json}from'../modules/logger.js';function a0_0x4d6c(_0x31b662,_0x1a5e84){const _0x415c8e=a0_0x415c();return a0_0x4d6c=function(_0x4d6c7f,_0x269595){_0x4d6c7f=_0x4d6c7f-0x1c8;let _0x426e34=_0x415c8e[_0x4d6c7f];return _0x426e34;},a0_0x4d6c(_0x31b662,_0x1a5e84);}import a0_0x10a1d8 from'path';import{fileURLToPath}from'url';import a0_0x52b396 from'fs/promises';const __filename=fileURLToPath(import.meta[a0_0xd22dfb(0x1c9)]),__dirname=a0_0x10a1d8[a0_0xd22dfb(0x1f3)](__filename);export default async function (context,signal){const _0x212468=a0_0xd22dfb,choMs=ms=>new Promise(resolve=>setTimeout(resolve,ms)),{firstPage,bot,profileNameId,getAks,genlogin,http,browser,dataId,screenDataBuffer2,tasksDataBuffer2,taskIndex}=context;let currentPage=firstPage,subframe;const botName=bot['name'];let screenData=new Int32Array(screenDataBuffer2),tasksData=new Int32Array(tasksDataBuffer2),demLoop=0x0,remainTime;const xpath={'closePopup':_0x212468(0x210),'dailyLeft':'//div[contains(@class,\x20\x27tap-bottom\x20Slide-in-left\x27)]','coin':'//div[contains(@class,\x20\x27content-top\x20Slide-in-top\x27)]','quest':_0x212468(0x1ed)};try{subframe=await vaoGame();if(!subframe){log(profileNameId,'['+botName+']Không\x20tìm\x20thấy\x20iframe',![]);throw new Error(_0x212468(0x1ce));}log(profileNameId,'['+botName+_0x212468(0x218)),await delay(0x3e8);const closePopup=await genlogin[_0x212468(0x1ec)](profileNameId,subframe,xpath['closePopup'],0x3e8);if(closePopup){log(profileNameId,'['+botName+_0x212468(0x1ea)),await delay(0x3e8);const clicked=await click(xpath[_0x212468(0x1d8)]);!clicked&&log(profileNameId,'['+botName+']Không\x20click\x20được\x20vào\x20closePopup',![]),log(profileNameId,'['+botName+']Click\x20closePopup\x20OK');}await delay(0x7d0);const dailyLeft=await genlogin[_0x212468(0x1ec)](profileNameId,subframe,xpath[_0x212468(0x1d0)],0x3e8);if(!dailyLeft){log(profileNameId,'['+botName+_0x212468(0x1e0),null,![]);throw new Error(_0x212468(0x1c8));}log(profileNameId,'['+botName+_0x212468(0x1d6),null,'i');const fullHp=await genlogin['getTextByXPath'](profileNameId,subframe,xpath[_0x212468(0x1d0)],0x7d0),kq10=await xuLyFullHp(fullHp);if(!kq10){log(profileNameId,'['+botName+_0x212468(0x1ee),null,![]);throw new Error(_0x212468(0x1ff));}if(kq10[_0x212468(0x20c)]==='maxday')return await http[_0x212468(0x1e4)](profileNameId,profileNameId,dataId,_0x212468(0x207)),log(profileNameId,'['+botName+_0x212468(0x1ca),null,'w'),!![];await http['updateData'](profileNameId,profileNameId,dataId,kq10['tapElement']);kq10[_0x212468(0x20c)]===_0x212468(0x207)?remainTime='4h00m':remainTime=_0x212468(0x1e6);remainTime=_0x212468(0x1d4),autoTap(kq10[_0x212468(0x20c)]);let maxAttempts=0x14,attempt=0x0;await new Promise(resolve=>{const checkTapStatus=async()=>{const _0x2a8a38=a0_0x4d6c;attempt++;if(attempt>maxAttempts){log(profileNameId,'['+botName+_0x2a8a38(0x1f7)+attempt,null,'w'),resolve(null);return;}const fullHp=await genlogin[_0x2a8a38(0x1db)](profileNameId,subframe,xpath[_0x2a8a38(0x1d0)],0x7d0),kq10=await xuLyFullHp(fullHp);if(kq10[_0x2a8a38(0x20c)]===_0x2a8a38(0x207)){log(profileNameId,'['+botName+_0x2a8a38(0x1dd),null,'w'),resolve(null);return;}else{if(kq10[_0x2a8a38(0x20c)]<=0x1e){log(profileNameId,'['+botName+_0x2a8a38(0x1d2)),resolve(!![]);return;}}log(profileNameId,'['+botName+_0x2a8a38(0x1e3)+kq10[_0x2a8a38(0x20c)]+'|'+attempt,null,'i'),setTimeout(checkTapStatus,0x1388);};checkTapStatus();}),await delay(0x7d0);const coinTag=await genlogin[_0x212468(0x1ec)](profileNameId,subframe,xpath['coin'],0x3e8);if(!coinTag){log(profileNameId,'['+botName+_0x212468(0x200));throw new Error('Không\x20tìm\x20thấy\x20coinTag');}log(profileNameId,'['+botName+']Tìm\x20thấy\x20coinTag');const coin=await genlogin['getTextByXPath'](profileNameId,subframe,xpath['coin'],0x7d0);if(!coin){log(profileNameId,'['+botName+']Không\x20tìm\x20thấy\x20coin',![]);throw new Error('Không\x20tìm\x20thấy\x20coin');}await http[_0x212468(0x1e4)](profileNameId,profileNameId,dataId,null,null,coin),log(profileNameId,'['+botName+_0x212468(0x1e1)+coin);const remainT=await thoigianconlai(remainTime);return!remainT&&log(profileNameId,'['+botName+_0x212468(0x1d1),null,![]),log(profileNameId,'['+botName+_0x212468(0x214)),log(profileNameId,'['+botName+_0x212468(0x1cf)+remainT[_0x212468(0x1f5)]),{'status':!![],'coin':coin,'nextRun':remainT['NextRun'],'nextRunStamp':remainT[_0x212468(0x20e)]};}catch(error){log(profileNameId,'['+botName+'][Lỗi]:\x20'+error,![]);}async function vaoGame(){const _0x4a3c56=_0x212468;try{log(profileNameId,'['+botName+_0x4a3c56(0x1fa));const subframe0=await genlogin[_0x4a3c56(0x203)](profileNameId,currentPage,getAks[_0x4a3c56(0x1cd)],0x2710);if(!subframe0){log(profileNameId,'['+botName+_0x4a3c56(0x1eb),![]);throw new Error(_0x4a3c56(0x1ce));}return log(profileNameId,'['+botName+_0x4a3c56(0x1f6)),subframe0;}catch(error){return log(profileNameId,'['+botName+_0x4a3c56(0x202)+error,![]),null;}}async function raGame(){const _0x16226c=_0x212468;try{log(profileNameId,'['+botName+_0x16226c(0x217)),currentPage=genlogin[_0x16226c(0x203)](profileNameId,currentPage,_0x16226c(0x1df),0x7d0);if(!currentPage){log(profileNameId,'['+botName+']Không\x20tìm\x20thấy\x20main\x20frame',![]);throw new Error('Không\x20tìm\x20thấy\x20main\x20frame');}return currentPage;}catch(error){return log(profileNameId,'['+botName+_0x16226c(0x202)+error,![]),null;}}async function click(xpath){const _0x4a3b94=_0x212468;try{await delay(0x3e8);const clicked=await genlogin[_0x4a3b94(0x1fd)](profileNameId,subframe,{'xpath':xpath,'mainframe':currentPage,'browser':browser},0x3e8);await delay(0x3e8);if(!clicked)return log(profileNameId,'['+botName+_0x4a3b94(0x1de)+xpath,null,![]),null;return log(profileNameId,'['+botName+_0x4a3b94(0x1e7)+xpath+_0x4a3b94(0x1cb)),clicked;}catch(error){return log(profileNameId,'['+botName+_0x4a3b94(0x206)+error,null,![]),null;}}async function xuLyFullHp(fullHp){const _0x21561c=_0x212468;try{let fullhp0=fullHp['trim']()[_0x21561c(0x204)](/,/g,''),parts=fullhp0[_0x21561c(0x209)]('\x20'),tapCountPart=parts[_0x21561c(0x1e2)]>=0x3?parseInt(parts[parts['length']-0x3]):null,dayleft=parts[_0x21561c(0x1e2)]>=0x4?parseInt(parts[0x3]):null,daylimit=parts[_0x21561c(0x1e2)]>=0x6?parseInt(parts[0x5]):null,tapElement=tapCountPart;return dayleft!==null&&dayleft<=0x0&&(tapElement=_0x21561c(0x207)),{'tapElement':tapElement,'dayleft':dayleft,'daylimit':daylimit};}catch(error){return log(profileNameId,'['+botName+_0x21561c(0x1fc)+error,null,![]),null;}}async function autoTap(tapElement){const _0x7245ba=_0x212468;try{log(profileNameId,'['+botName+_0x7245ba(0x219)+tapElement+_0x7245ba(0x1cc));let codeAutoTap=await getFile(botName+_0x7245ba(0x1e9));return await genlogin[_0x7245ba(0x1e8)](profileNameId,subframe,codeAutoTap),log(profileNameId,'['+botName+_0x7245ba(0x219)+tapElement+_0x7245ba(0x1cb)),!![];}catch(error){return log(profileNameId,'['+botName+'][autoTap]:\x20'+error,null,![]),null;}}async function getFile(nameFile){const _0x22f7e3=_0x212468;try{const filePath=a0_0x10a1d8[_0x22f7e3(0x1f0)](__dirname,_0x22f7e3(0x1e8),nameFile),code=await a0_0x52b396[_0x22f7e3(0x205)](filePath,_0x22f7e3(0x213));return code;}catch(e){log(profileNameId,_0x22f7e3(0x1f2)+e['message'],null,![]);}}async function lamQuest(){const _0x494bda=_0x212468;try{log(profileNameId,'['+botName+_0x494bda(0x20f));const kq10=await genlogin[_0x494bda(0x1ec)](profileNameId,subframe,xpath[_0x494bda(0x1f4)],0x7d0);if(!kq10){log(profileNameId,'['+botName+_0x494bda(0x208),![]);throw new Error(_0x494bda(0x1dc));}log(profileNameId,'['+botName+'][lamQuest]Tìm\x20thấy\x20quest');const clicked=await click(xpath[_0x494bda(0x1f4)]);if(!clicked){log(profileNameId,'['+botName+_0x494bda(0x211),![]);throw new Error('Không\x20click\x20được\x20vào\x20quest');}return log(profileNameId,'['+botName+_0x494bda(0x20b)),!![];}catch(error){return log(profileNameId,'['+botName+'][lamQuest]:\x20'+error,null,![]),null;}}async function thoigianconlai(thoigianconlai){const _0x226788=_0x212468;try{log(profileNameId,'['+botName+_0x226788(0x1fe));let hour0=thoigianconlai[_0x226788(0x209)]('h')[0x0],minute0=thoigianconlai[_0x226788(0x209)]('h')[0x1][_0x226788(0x209)]('m')[0x0],hour=parseInt(hour0),minutes=parseInt(minute0),seconds=parseInt(0x0),totalSeconds=parseInt(hour*0xe10+minutes*0x3c+seconds);const unixTime=Math[_0x226788(0x1da)](Date[_0x226788(0x1ef)]()/0x3e8),newUnixTime=unixTime+totalSeconds,newDate=new Date(newUnixTime*0x3e8),formattedDate=newDate[_0x226788(0x215)](),formattedTime=newDate[_0x226788(0x201)](_0x226788(0x216),{'hour12':![]});let NextRun=formattedDate+'\x20'+formattedTime;return{'NextRun':NextRun,'NextRunStamp':newUnixTime};}catch(error){return log(profileNameId,'['+botName+_0x226788(0x1d7)+error,null,![]),null;}}async function delay(ms){return new Promise(async resolve=>{setTimeout(resolve,ms);});}async function cTimeout(){const _0x193cdc=_0x212468;if(Atomics[_0x193cdc(0x1e5)](tasksData,taskIndex)===0x1)return!![];return![];}};