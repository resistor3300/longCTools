function a0_0x9484(_0x5269fd,_0x1bda76){const _0x36ecc3=a0_0x36ec();return a0_0x9484=function(_0x948470,_0x403168){_0x948470=_0x948470-0x88;let _0x3171a8=_0x36ecc3[_0x948470];return _0x3171a8;},a0_0x9484(_0x5269fd,_0x1bda76);}const a0_0x57078b=a0_0x9484;(function(_0x40a434,_0x36eff0){const _0x5c040f=a0_0x9484,_0x940459=_0x40a434();while(!![]){try{const _0xe6fb2e=-parseInt(_0x5c040f(0xb8))/0x1*(parseInt(_0x5c040f(0x94))/0x2)+-parseInt(_0x5c040f(0xac))/0x3*(parseInt(_0x5c040f(0xb7))/0x4)+-parseInt(_0x5c040f(0xc7))/0x5*(parseInt(_0x5c040f(0x9a))/0x6)+parseInt(_0x5c040f(0x9d))/0x7*(-parseInt(_0x5c040f(0xb2))/0x8)+parseInt(_0x5c040f(0x9e))/0x9*(-parseInt(_0x5c040f(0x9b))/0xa)+parseInt(_0x5c040f(0xa9))/0xb*(parseInt(_0x5c040f(0xc5))/0xc)+-parseInt(_0x5c040f(0x8d))/0xd*(-parseInt(_0x5c040f(0xa0))/0xe);if(_0xe6fb2e===_0x36eff0)break;else _0x940459['push'](_0x940459['shift']());}catch(_0x389cd9){_0x940459['push'](_0x940459['shift']());}}}(a0_0x36ec,0x87d67));import{log,json}from'../modules/logger.js';function a0_0x36ec(){const _0x42ae6a=['88410MdqWsg','load','4h00m','now',']Đã\x20đạt\x20đến\x20hạn\x20ngày','\x20nè','closePopup','Không\x20tìm\x20thấy\x20iframe','utf8','187NkpvMF','-autoTap','message','95757BOTeOa',']không\x20Tìm\x20thấy\x20dailyLeft',']nextRunAt:\x20','Không\x20tìm\x20thấy\x20dailyLeft','//div[contains(@class,\x20\x27content-top\x20Slide-in-top\x27)]','url','2360MWUIPZ','][lamQuest]Tìm\x20thấy\x20quest',']Click\x20closePopup\x20OK','quest','NextRunStamp','40TKUHfG','85PPpKWB','\x20OK','length',']tìm\x20thấy\x20closePopup','dailyLeft','name','maxday','mainframe',']Không\x20click\x20được\x20vào\x20closePopup',']không\x20Tìm\x20thấy\x20coinTag','javascript','][autoTap]:\x20','switchFrame','189756dnIGxY','][Lỗi]:\x20','925ENTBau',']Tìm\x20thấy\x20coin:\x20','Iframe','][autotap]\x20Đang\x20chờ\x20tap\x20xong\x20','][lamQuest]Không\x20tìm\x20thấy\x20quest','][lamQuest]Làm\x20Quest\x20nè','tapElement','dirname','][thoigianconlai]:Xử\x20lý\x20gian\x20còn\x20lại\x20nè','][thoigianconlai]:\x20','error:\x20','toLocaleDateString',']Vào\x20game\x20OK',']Auto\x20tap\x20','//p[text()=\x27Quest\x27]',']Ra\x20game\x20nè','readFile',']Không\x20tìm\x20thấy\x20coin','NextRun','][lamQuest]:\x20','][autoTap]\x20Đã\x20đạt\x20đến\x20số\x20lần\x20thử\x20tối\x20đa\x20','Không\x20click\x20được\x20vào\x20quest',']Không\x20tìm\x20thấy\x20iframe',']không\x20xử\x20lý\x20được\x20thoigianconlai',']Không\x20xử\x20lý\x20fullHp','getTextByXPath','5837QQmkKg','updateData',']Không\x20tìm\x20thấy\x20main\x20frame','elementExistsByXPath','Không\x20tìm\x20thấy\x20quest','floor','en-GB','22766tgutIe','][xuLyFullHp]:\x20','split',']Đã\x20tìm\x20thấy\x20iframe','][autoTap]\x20Đã\x20đạt\x20đến\x20hạn\x20ngày','][lamQuest]Không\x20click\x20được\x20vào\x20quest','600pFeQbs','1090350buuKQX','coin','11375FNEQOx','63mEfuYk',']Tìm\x20thấy\x20dailyLeft'];a0_0x36ec=function(){return _0x42ae6a;};return a0_0x36ec();}import a0_0x473efa from'path';import{fileURLToPath}from'url';import a0_0x31273e from'fs/promises';const __filename=fileURLToPath(import.meta[a0_0x57078b(0xb1)]),__dirname=a0_0x473efa[a0_0x57078b(0xce)](__filename);export default async function (context,signal){const _0x9de45c=a0_0x57078b,choMs=ms=>new Promise(resolve=>setTimeout(resolve,ms)),{firstPage,bot,profileNameId,getAks,genlogin,http,browser,dataId,screenDataBuffer2,tasksDataBuffer2,taskIndex}=context;let currentPage=firstPage,subframe;const botName=bot[_0x9de45c(0xbd)];let screenData=new Int32Array(screenDataBuffer2),tasksData=new Int32Array(tasksDataBuffer2),demLoop=0x0,remainTime;const xpath={'closePopup':'//i[contains(@class,\x27_close-icon\x27)]','dailyLeft':'//div[contains(@class,\x20\x27tap-bottom\x20Slide-in-left\x27)]','coin':_0x9de45c(0xb0),'quest':_0x9de45c(0xd5)};try{subframe=await vaoGame();if(!subframe){log(profileNameId,'['+botName+_0x9de45c(0x89),![]);throw new Error(_0x9de45c(0xa7));}log(profileNameId,'['+botName+_0x9de45c(0xd3)),await delay(0x3e8);const closePopup=await genlogin[_0x9de45c(0x90)](profileNameId,subframe,xpath[_0x9de45c(0xa6)],0x3e8);if(closePopup){log(profileNameId,'['+botName+_0x9de45c(0xbb)),await delay(0x3e8);const clicked=await click(xpath[_0x9de45c(0xa6)]);!clicked&&log(profileNameId,'['+botName+_0x9de45c(0xc0),![]),log(profileNameId,'['+botName+_0x9de45c(0xb4));}await delay(0x7d0);const dailyLeft=await genlogin['elementExistsByXPath'](profileNameId,subframe,xpath[_0x9de45c(0xbc)],0x3e8);if(!dailyLeft){log(profileNameId,'['+botName+_0x9de45c(0xad),null,![]);throw new Error(_0x9de45c(0xaf));}log(profileNameId,'['+botName+_0x9de45c(0x9f),null,'i');const fullHp=await genlogin['getTextByXPath'](profileNameId,subframe,xpath[_0x9de45c(0xbc)],0x7d0),kq10=await xuLyFullHp(fullHp);if(!kq10){log(profileNameId,'['+botName+_0x9de45c(0x8b),null,![]);throw new Error('Không\x20xử\x20lý\x20fullHp');}kq10[_0x9de45c(0xcd)]===_0x9de45c(0xbe)&&(await http[_0x9de45c(0x8e)](profileNameId,profileNameId,dataId,'maxday'),log(profileNameId,'['+botName+_0x9de45c(0xa4),null,'w'));await http[_0x9de45c(0x8e)](profileNameId,profileNameId,dataId,kq10[_0x9de45c(0xcd)]);if(kq10[_0x9de45c(0xcd)]===_0x9de45c(0xbe))remainTime=_0x9de45c(0xa2);else{remainTime='1h00m',autoTap(kq10['tapElement']);let maxAttempts=0x14,attempt=0x0;await new Promise(resolve=>{const checkTapStatus=async()=>{const _0x48bdb5=a0_0x9484;attempt++;if(attempt>maxAttempts){log(profileNameId,'['+botName+_0x48bdb5(0xdb)+attempt,null,'w'),resolve(null);return;}const fullHp=await genlogin[_0x48bdb5(0x8c)](profileNameId,subframe,xpath[_0x48bdb5(0xbc)],0x7d0),kq10=await xuLyFullHp(fullHp);if(kq10[_0x48bdb5(0xcd)]===_0x48bdb5(0xbe)){log(profileNameId,'['+botName+_0x48bdb5(0x98),null,'w'),resolve(null);return;}else{if(kq10[_0x48bdb5(0xcd)]<=0x1e){log(profileNameId,'['+botName+'][autoTap]\x20Đã\x20tap\x20xong'),resolve(!![]);return;}}log(profileNameId,'['+botName+_0x48bdb5(0xca)+kq10['tapElement']+'|'+attempt,null,'i'),setTimeout(checkTapStatus,0x1388);};checkTapStatus();}),await delay(0x7d0);}const coinTag=await genlogin[_0x9de45c(0x90)](profileNameId,subframe,xpath[_0x9de45c(0x9c)],0x3e8);!coinTag?log(profileNameId,'['+botName+_0x9de45c(0xc1),null,![]):log(profileNameId,'['+botName+']Tìm\x20thấy\x20coinTag');const coin=await genlogin[_0x9de45c(0x8c)](profileNameId,subframe,xpath[_0x9de45c(0x9c)],0x7d0);!coin?log(profileNameId,'['+botName+_0x9de45c(0xd8),null,![]):(await http[_0x9de45c(0x8e)](profileNameId,profileNameId,dataId,null,null,coin),log(profileNameId,'['+botName+_0x9de45c(0xc8)+coin));const remainT=await thoigianconlai(remainTime);return!remainT&&log(profileNameId,'['+botName+_0x9de45c(0x8a),null,![]),log(profileNameId,'['+botName+']Xử\x20lý\x20thoigianconlai\x20OK'),log(profileNameId,'['+botName+_0x9de45c(0xae)+remainT['NextRun']),await clearVar(),{'status':!![],'coin':coin,'nextRun':remainT[_0x9de45c(0xd9)],'nextRunStamp':remainT[_0x9de45c(0xb6)]};}catch(error){return log(profileNameId,'['+botName+_0x9de45c(0xc6)+error,![]),await clearVar(),null;}async function vaoGame(){const _0xbfcd8f=_0x9de45c;try{log(profileNameId,'['+botName+']Vào\x20game\x20nè');const subframe0=await genlogin[_0xbfcd8f(0xc4)](profileNameId,currentPage,getAks[_0xbfcd8f(0xc9)],0x2710);if(!subframe0){log(profileNameId,'['+botName+_0xbfcd8f(0x89),![]);throw new Error(_0xbfcd8f(0xa7));}return log(profileNameId,'['+botName+_0xbfcd8f(0x97)),subframe0;}catch(error){return log(profileNameId,'['+botName+_0xbfcd8f(0xc6)+error,![]),null;}}async function raGame(){const _0x41e23a=_0x9de45c;try{log(profileNameId,'['+botName+_0x41e23a(0xd6)),currentPage=genlogin[_0x41e23a(0xc4)](profileNameId,currentPage,_0x41e23a(0xbf),0x7d0);if(!currentPage){log(profileNameId,'['+botName+_0x41e23a(0x8f),![]);throw new Error('Không\x20tìm\x20thấy\x20main\x20frame');}return currentPage;}catch(error){return log(profileNameId,'['+botName+_0x41e23a(0xc6)+error,![]),null;}}async function click(xpath){const _0x19d9d0=_0x9de45c;try{await delay(0x3e8);const clicked=await genlogin['click'](profileNameId,subframe,{'xpath':xpath,'mainframe':currentPage,'browser':browser},0x3e8);await delay(0x3e8);if(!clicked)return log(profileNameId,'['+botName+'][click]Không\x20click\x20được\x20vào\x20'+xpath,null,![]),null;return log(profileNameId,'['+botName+'][click]Click\x20'+xpath+_0x19d9d0(0xb9)),clicked;}catch(error){return log(profileNameId,'['+botName+'][click][Lỗi]:\x20'+error,null,![]),null;}}async function xuLyFullHp(fullHp){const _0xa3dec=_0x9de45c;try{let fullhp0=fullHp['trim']()['replace'](/,/g,''),parts=fullhp0[_0xa3dec(0x96)]('\x20'),tapCountPart=parts[_0xa3dec(0xba)]>=0x3?parseInt(parts[parts[_0xa3dec(0xba)]-0x3]):null,dayleft=parts['length']>=0x4?parseInt(parts[0x3]):null,daylimit=parts[_0xa3dec(0xba)]>=0x6?parseInt(parts[0x5]):null,tapElement=tapCountPart;return dayleft!==null&&dayleft<=0x0&&(tapElement=_0xa3dec(0xbe)),{'tapElement':tapElement,'dayleft':dayleft,'daylimit':daylimit};}catch(error){return log(profileNameId,'['+botName+_0xa3dec(0x95)+error,null,![]),null;}}async function autoTap(tapElement){const _0x9c7314=_0x9de45c;try{log(profileNameId,'['+botName+_0x9c7314(0xd4)+tapElement+_0x9c7314(0xa5));let codeAutoTap=await getFile(botName+_0x9c7314(0xaa));return await genlogin['javascript'](profileNameId,subframe,codeAutoTap),log(profileNameId,'['+botName+_0x9c7314(0xd4)+tapElement+_0x9c7314(0xb9)),!![];}catch(error){return log(profileNameId,'['+botName+_0x9c7314(0xc3)+error,null,![]),null;}}async function getFile(nameFile){const _0x3e87ec=_0x9de45c;try{const filePath=a0_0x473efa['join'](__dirname,_0x3e87ec(0xc2),nameFile),code=await a0_0x31273e[_0x3e87ec(0xd7)](filePath,_0x3e87ec(0xa8));return code;}catch(e){log(profileNameId,_0x3e87ec(0xd1)+e[_0x3e87ec(0xab)],null,![]);}}async function lamQuest(){const _0x3a49cc=_0x9de45c;try{log(profileNameId,'['+botName+_0x3a49cc(0xcc));const kq10=await genlogin[_0x3a49cc(0x90)](profileNameId,subframe,xpath[_0x3a49cc(0xb5)],0x7d0);if(!kq10){log(profileNameId,'['+botName+_0x3a49cc(0xcb),![]);throw new Error(_0x3a49cc(0x91));}log(profileNameId,'['+botName+_0x3a49cc(0xb3));const clicked=await click(xpath[_0x3a49cc(0xb5)]);if(!clicked){log(profileNameId,'['+botName+_0x3a49cc(0x99),![]);throw new Error(_0x3a49cc(0x88));}return log(profileNameId,'['+botName+'][lamQuest]Click\x20quest\x20OK'),!![];}catch(error){return log(profileNameId,'['+botName+_0x3a49cc(0xda)+error,null,![]),null;}}async function thoigianconlai(thoigianconlai){const _0x2bb35d=_0x9de45c;try{log(profileNameId,'['+botName+_0x2bb35d(0xcf));let hour0=thoigianconlai['split']('h')[0x0],minute0=thoigianconlai['split']('h')[0x1][_0x2bb35d(0x96)]('m')[0x0],hour=parseInt(hour0),minutes=parseInt(minute0),seconds=parseInt(0x0),totalSeconds=parseInt(hour*0xe10+minutes*0x3c+seconds);const unixTime=Math[_0x2bb35d(0x92)](Date[_0x2bb35d(0xa3)]()/0x3e8),newUnixTime=unixTime+totalSeconds,newDate=new Date(newUnixTime*0x3e8),formattedDate=newDate[_0x2bb35d(0xd2)](),formattedTime=newDate['toLocaleTimeString'](_0x2bb35d(0x93),{'hour12':![]});let NextRun=formattedDate+'\x20'+formattedTime;return{'NextRun':NextRun,'NextRunStamp':newUnixTime};}catch(error){return log(profileNameId,'['+botName+_0x2bb35d(0xd0)+error,null,![]),null;}}async function delay(ms){return new Promise(async resolve=>{setTimeout(resolve,ms);});}async function cTimeout(){const _0x5c75c5=_0x9de45c;if(Atomics[_0x5c75c5(0xa1)](tasksData,taskIndex)===0x1)return!![];return![];}async function clearVar(){currentPage=null,subframe=null,screenData=null,tasksData=null;}};