(function(_0x5c181c,_0x56c97f){const _0x206b94=a0_0x58c5,_0xf61c15=_0x5c181c();while(!![]){try{const _0xd91420=-parseInt(_0x206b94(0x11d))/0x1+parseInt(_0x206b94(0xfb))/0x2+-parseInt(_0x206b94(0xf3))/0x3*(-parseInt(_0x206b94(0x11e))/0x4)+parseInt(_0x206b94(0xf8))/0x5+-parseInt(_0x206b94(0x107))/0x6*(parseInt(_0x206b94(0x103))/0x7)+-parseInt(_0x206b94(0xf4))/0x8*(parseInt(_0x206b94(0x106))/0x9)+parseInt(_0x206b94(0x10c))/0xa;if(_0xd91420===_0x56c97f)break;else _0xf61c15['push'](_0xf61c15['shift']());}catch(_0x135e15){_0xf61c15['push'](_0xf61c15['shift']());}}}(a0_0x494f,0x7bef3));import{log,json}from'../modules/logger.js';export default async function (context,signal){const _0x397eb6=a0_0x58c5,choMs=ms=>new Promise(resolve=>setTimeout(resolve,ms)),{firstPage,bot,profileNameId,getAks,genlogin,http,browser,dataId,screenDataBuffer2,tasksDataBuffer2,taskIndex}=context;let currentPage=firstPage,subframe;const botName=bot[_0x397eb6(0x113)];let screenData=new Int32Array(screenDataBuffer2),tasksData=new Int32Array(tasksDataBuffer2),demLoop=0x0,remainTime;const xpath={'yespacClaim':_0x397eb6(0x121),'dailyPopupClose':_0x397eb6(0x118),'progressValue':_0x397eb6(0x11f),'coin':'//div[contains(@class,\x20\x27coin-value-block\x27)]'};try{subframe=await vaoGame();if(!subframe){log(profileNameId,'['+botName+_0x397eb6(0xff),![]);throw new Error(_0x397eb6(0x102));}log(profileNameId,'['+botName+']Vào\x20game\x20OK'),await delay(0x3e8),await checkClosePopup(),await delay(0x3e8),await diChuyenChuotZigZag();const kqClaim=await choNhatCoinXong();!kqClaim&&log(profileNameId,'['+botName+_0x397eb6(0xf7),null,![]);log(profileNameId,'['+botName+']nhặt\x20coin\x20OK');const coin=await getCoin();!coin&&log(profileNameId,'['+botName+_0x397eb6(0x131),![]);await http[_0x397eb6(0xf1)](profileNameId,profileNameId,dataId,null,null,coin),log(profileNameId,'['+botName+_0x397eb6(0x114)+coin);const remainT=await thoigianconlai(_0x397eb6(0x104));return!remainT&&log(profileNameId,'['+botName+']không\x20xử\x20lý\x20được\x20thoigianconlai',null,![]),log(profileNameId,'['+botName+_0x397eb6(0xe7)),log(profileNameId,'['+botName+']nextRunAt:\x20'+remainT['NextRun']),await clearVar(),{'status':!![],'coin':coin,'nextRun':remainT[_0x397eb6(0x119)],'nextRunStamp':remainT['NextRunStamp']};}catch(error){return log(profileNameId,'['+botName+_0x397eb6(0xf2)+error,![]),await clearVar(),{'status':![],'coin':0x0,'nextRun':0x0,'nextRunStamp':0x0};}async function vaoGame(){const _0x1691a0=_0x397eb6;try{log(profileNameId,'['+botName+_0x1691a0(0xf5));const subframe0=await genlogin[_0x1691a0(0x101)](profileNameId,currentPage,getAks[_0x1691a0(0x100)],0x2710);if(!subframe0){log(profileNameId,'['+botName+_0x1691a0(0xff),![]);throw new Error('Không\x20tìm\x20thấy\x20iframe');}return log(profileNameId,'['+botName+_0x1691a0(0x10f)),subframe0;}catch(error){return log(profileNameId,'['+botName+_0x1691a0(0xf2)+error,![]),null;}}async function raGame(){const _0x41f531=_0x397eb6;try{log(profileNameId,'['+botName+_0x41f531(0x111)),currentPage=genlogin[_0x41f531(0x101)](profileNameId,currentPage,_0x41f531(0x123),0x7d0);if(!currentPage){log(profileNameId,'['+botName+_0x41f531(0x12d),![]);throw new Error(_0x41f531(0xe5));}return currentPage;}catch(error){return log(profileNameId,'['+botName+_0x41f531(0xf2)+error,![]),null;}}async function click(xpath){const _0x11a1a8=_0x397eb6;try{await delay(0x3e8);const clicked=await genlogin[_0x11a1a8(0xe8)](profileNameId,subframe,{'xpath':xpath,'mainframe':currentPage,'browser':browser},0x3e8);await delay(0x3e8);if(!clicked)return log(profileNameId,'['+botName+'][click]Không\x20click\x20được\x20vào\x20'+xpath,null,![]),null;return log(profileNameId,'['+botName+_0x11a1a8(0xe9)+xpath+_0x11a1a8(0x108)),clicked;}catch(error){return log(profileNameId,'['+botName+_0x11a1a8(0x128)+error,null,![]),null;}}async function checkClosePopup(){const _0x2610e4=_0x397eb6,xpathClosePopup={'yespacClaim':'(//div[contains(@class,\x27home-daily-gift-popup\x27)and\x20not(contains(@style,\x27display:\x20none\x27))]//div[contains(@class,\x27popup-gift\x27)]//span[text()=\x27Claim\x27])[1]','yespacClaim1':_0x2610e4(0x10e),'dailyPopupClose':_0x2610e4(0x118),'dailyPopupClose1':'//div[contains(@class,\x27van-overlay\x27)and\x20not(contains(@style,\x27display:\x20none\x27))]//img[contains(@class,\x27rebate-close\x27)]','dailyPopupClose2':_0x2610e4(0x125),'dailyPopupClose3':_0x2610e4(0xf9),'dailyPopupClose4':'//div[contains(@class,\x27home-bonus-week-popup\x27)and\x20not(contains(@style,\x27display:\x20none\x27))]//img[contains(@class,\x27popup-close\x27)]'},keys=Object[_0x2610e4(0x10b)](xpathClosePopup),lastKey=keys[keys[_0x2610e4(0xef)]-0x1];try{log(profileNameId,'['+botName+'][checkClosePopup]\x20checkClosePopup\x20nè',null,'i','-');let demLoop=0x0;const maxDemLoop=0xa;let kqWhile=0x0;while(demLoop<maxDemLoop){demLoop++;for(const [key,xpath]of Object[_0x2610e4(0x126)](xpathClosePopup)){log(profileNameId,'['+botName+_0x2610e4(0x10d)+xpath+_0x2610e4(0xfe)+demLoop,null,'i');const kq=await genlogin[_0x2610e4(0x110)](profileNameId,subframe,xpath,0x3e8);if(kq){log(profileNameId,'['+botName+_0x2610e4(0x12b)+xpath,null,'i'),await click(xpath,0x3e8),await delay(0x1f4);break;}else key==lastKey&&(kqWhile=0x1);}if(kqWhile===0x1)break;}return!![];}catch(error){return log(profileNameId,'['+botName+'][checkClosePopup]\x20error:\x20'+error[_0x2610e4(0xe4)],null,![]),null;}}async function getToaDo(){const _0x284b3f=_0x397eb6;try{log(profileNameId,'['+botName+_0x284b3f(0x124));const kqCenterPoint=await genlogin[_0x284b3f(0xf0)](profileNameId,currentPage);if(!kqCenterPoint)return log(profileNameId,'['+botName+']Không\x20lấy\x20được\x20centerPoint',null,![]),null;return log(profileNameId,'['+botName+_0x284b3f(0xea)+json(kqCenterPoint)),kqCenterPoint;}catch(error){return log(profileNameId,'['+botName+_0x284b3f(0xed)+error,null,![]),null;}}async function diChuyenChuotZigZag(){const _0x4b0bc8=_0x397eb6;try{log(profileNameId,'['+botName+_0x4b0bc8(0x10a));const centerP=await getToaDo();if(!centerP)return log(profileNameId,'['+botName+'][diChuyenChuotZigZag]Không\x20tìm\x20thayas\x20centerP',null,![]),null;return log(profileNameId,'['+botName+_0x4b0bc8(0xee)+json(centerP)),genlogin['moveMouseSpiral'](profileNameId,currentPage,centerP['x'],centerP['y'],0xfa,0x30d40,0x3c),log(profileNameId,'['+botName+_0x4b0bc8(0x127)),!![];}catch(error){log(profileNameId,'['+botName+_0x4b0bc8(0x12c)+error['message'],null,![]);}}async function choNhatCoinXong(){const _0x37b32e=_0x397eb6;try{let maxAttempts=0x78,attempt=0x0;while(attempt<maxAttempts){attempt++;const coinLeft=await genlogin[_0x37b32e(0x11c)](profileNameId,subframe,xpath[_0x37b32e(0x112)],0x7d0);if(!coinLeft)return log(profileNameId,'['+botName+_0x37b32e(0x133),![]),null;log(profileNameId,'['+botName+_0x37b32e(0x117)+coinLeft);if(parseInt(coinLeft)<=0x32)return log(profileNameId,'['+botName+_0x37b32e(0x12e)),!![];log(profileNameId,'['+botName+_0x37b32e(0x11a)+coinLeft+'|'+attempt),await delay(0x1388);}return log(profileNameId,'['+botName+_0x37b32e(0x11b)+attempt),null;}catch(e){return log(profileNameId,'['+botName+_0x37b32e(0x109)+e['message'],null,![]),null;}}async function lamQuest(){const _0x113fe0=_0x397eb6;try{log(profileNameId,'['+botName+_0x113fe0(0xfd));const kq10=await genlogin['elementExistsByXPath'](profileNameId,subframe,xpath[_0x113fe0(0x120)],0x7d0);if(!kq10){log(profileNameId,'['+botName+_0x113fe0(0x116),![]);throw new Error('Không\x20tìm\x20thấy\x20quest');}log(profileNameId,'['+botName+_0x113fe0(0x132));const clicked=await click(xpath[_0x113fe0(0x120)]);if(!clicked){log(profileNameId,'['+botName+_0x113fe0(0x115),![]);throw new Error(_0x113fe0(0xf6));}return log(profileNameId,'['+botName+_0x113fe0(0xeb)),!![];}catch(error){return log(profileNameId,'['+botName+'][lamQuest]:\x20'+error,null,![]),null;}}async function getCoin(){const _0x18fe9b=_0x397eb6;try{log(profileNameId,'['+botName+_0x18fe9b(0x122));const coin=await genlogin['getTextByXPath'](profileNameId,subframe,xpath[_0x18fe9b(0x129)],0x7d0);if(!coin)return log(profileNameId,'['+botName+'][getCoin]:\x20Không\x20tìm\x20thấy\x20coin',null,![]),null;return log(profileNameId,'['+botName+_0x18fe9b(0x130)+coin),coin;}catch(error){return log(profileNameId,'['+botName+_0x18fe9b(0x105)+error,null,![]),null;}}async function thoigianconlai(thoigianconlai){const _0x64ef71=_0x397eb6;try{log(profileNameId,'['+botName+_0x64ef71(0xe6));let parts=thoigianconlai[_0x64ef71(0xfc)](':'),hour0=parseInt(parts[0x0]),minute0=parseInt(parts[0x1]),second0=parseInt(parts[0x2]),hours=parseInt(hour0),minutes=parseInt(minute0),seconds=parseInt(second0),totalSeconds=parseInt(hours*0xe10+minutes*0x3c+seconds);const unixTime=Math['floor'](Date[_0x64ef71(0x12f)]()/0x3e8),newUnixTime=unixTime+totalSeconds,newDate=new Date(newUnixTime*0x3e8),formattedDate=newDate[_0x64ef71(0xfa)](),formattedTime=newDate['toLocaleTimeString'](_0x64ef71(0xec),{'hour12':![]});let NextRun=formattedDate+'\x20'+formattedTime;return{'NextRun':NextRun,'NextRunStamp':newUnixTime};}catch(error){return log(profileNameId,'['+botName+'][thoigianconlai]:\x20'+error,null,![]),null;}}async function delay(ms){return new Promise(async resolve=>{setTimeout(resolve,ms);});}async function cTimeout(){const _0x4f1e3b=_0x397eb6;if(Atomics[_0x4f1e3b(0x12a)](tasksData,taskIndex)===0x1)return!![];return![];}async function clearVar(){currentPage=null,subframe=null,screenData=null,tasksData=null;}}function a0_0x58c5(_0x474198,_0x3e35ac){const _0x494f19=a0_0x494f();return a0_0x58c5=function(_0x58c567,_0x5e3604){_0x58c567=_0x58c567-0xe4;let _0x1fbaff=_0x494f19[_0x58c567];return _0x1fbaff;},a0_0x58c5(_0x474198,_0x3e35ac);}function a0_0x494f(){const _0x37d799=['][lamQuest]Click\x20quest\x20OK','en-GB','][getToaDo]:\x20','][diChuyenChuotZigZag]Tìm\x20thayas\x20centerP:\x20','length','centerPoint','updateData','][Lỗi]:\x20','3RShkPs','13912IiScwp',']Vào\x20game\x20nè','Không\x20click\x20được\x20vào\x20quest',']lỗi\x20nhặt\x20coin','431185wegCML','//div[contains(@class,\x27van-overlay\x27)and\x20not(contains(@style,\x27display:\x20none\x27))]//img[contains(@class,\x27close-icon\x27)]','toLocaleDateString','1446158ijqcJn','split','][lamQuest]Làm\x20Quest\x20nè','\x20demLoop:',']Không\x20tìm\x20thấy\x20iframe','Iframe','switchFrame','Không\x20tìm\x20thấy\x20iframe','3752luuqff','00:05:00','][getCoin]:\x20','4995CnNSUE','1188YjFpcH','\x20OK','][choNhatCoinXong]\x20error:\x20','][diChuyenChuotZigZag]\x20diChuyenChuotZigZag\x20nè','keys','4603450zsagnS','][checkClosePopup]\x20XPath:\x20','(//div[contains(@class,\x27van-overlay\x27)and\x20not(contains(@style,\x27display:\x20none\x27))]//div[contains(@class,\x27popup-bonus\x27)]//span[text()=\x27Claim\x27])[1]',']Đã\x20tìm\x20thấy\x20iframe','elementExistsByXPath',']Ra\x20game\x20nè','progressValue','name',']Tìm\x20thấy\x20coin:\x20','][lamQuest]Không\x20click\x20được\x20vào\x20quest','][lamQuest]Không\x20tìm\x20thấy\x20quest','][choNhatCoinXong]\x20Tìm\x20thấy\x20coinLeft:\x20','//div[contains(@class,\x27popup-content\x20home-daily-task-popup\x27)]//div[contains(@class,\x27popup-close\x27)]','NextRun','][autotap]\x20Đang\x20chờ\x20nhặt\x20coin\x20xong\x20','][choNhatCoinXong]\x20Đã\x20đạt\x20đến\x20số\x20lần\x20thử\x20tối\x20đa\x20','getTextByXPath','209343RtMhSL','2074360ZIsomR','//p[contains(@class,\x20\x27progress-value\x27)]/text()[1]','quest','(//span[text()=\x27Claim\x27])[1]','][getCoin]:\x20Xử\x20lý\x20coin\x20nè','mainframe',']get\x20tọa\x20độ\x20nè','//div[contains(@class,\x27popup-content\x27)]//img[contains(@class,\x27popup-close\x27)]','entries','][diChuyenChuotZigZag]\x20bắt\x20đầu\x20Di\x20chuyển\x20chuột\x20ZigZag','][click][Lỗi]:\x20','coin','load','][checkClosePopup]\x20Click:\x20','][diChuyenChuotZigZag]\x20error:\x20',']Không\x20tìm\x20thấy\x20main\x20frame','][choNhatCoinXong]\x20nhặt\x20coin\x20xong','now','][getCoin]:\x20Tìm\x20thấy\x20coin:\x20',']Không\x20tìm\x20thấy\x20coin','][lamQuest]Tìm\x20thấy\x20quest','][choNhatCoinXong]\x20Không\x20tìm\x20thấy\x20coinLeft','message','Không\x20tìm\x20thấy\x20main\x20frame','][thoigianconlai]:Xử\x20lý\x20gian\x20còn\x20lại\x20nè',']Xử\x20lý\x20thoigianconlai\x20OK','click','][click]Click\x20',']Lấy\x20được\x20centerPoint\x20'];a0_0x494f=function(){return _0x37d799;};return a0_0x494f();};