function a0_0x5d79(_0x8e7e40,_0x37b041){const _0x39b376=a0_0x39b3();return a0_0x5d79=function(_0x5d7982,_0x5345e3){_0x5d7982=_0x5d7982-0x1a1;let _0x4817a2=_0x39b376[_0x5d7982];return _0x4817a2;},a0_0x5d79(_0x8e7e40,_0x37b041);}function a0_0x39b3(){const _0x5156f8=['click',']không\x20xử\x20lý\x20được\x20thoigianconlai',']Tìm\x20thấy\x20coin:\x20','][thoigianconlai]:Xử\x20lý\x20gian\x20còn\x20lại\x20nè','split','name','getTextByXPath','][thoigianconlai]:\x20','][lamQuest]Tìm\x20thấy\x20quest','][closePopup]Tìm\x20thấy\x20play','(//span[contains(text(),\x20\x27Leaders\x27)])[last()]','(//button[contains(text(),\x20\x27Play\x20Now\x27)])[last()]','][closePopup]Không\x20tìm\x20thấy\x20play','][choDoMinXong]\x20Đã\x20click\x20vào\x20playAgain','11nUEbSn',']nextRunAt:\x20',']không\x20Tìm\x20thấy\x20coinTag','quest',']Vào\x20game\x20nè','][choDoMinXong]\x20Đã\x20chơi\x20xong\x20',']Không\x20tìm\x20thấy\x20coin',']Tìm\x20thấy\x20coinTag',']Đã\x20tìm\x20thấy\x20iframe',']Không\x20tìm\x20thấy\x20iframe','join','][click][Lỗi]:\x20','play','][lamQuest]:\x20','value','toLocaleTimeString','1895VwjEoI','00:05:00','next','Không\x20tìm\x20thấy\x20coinTag','Không\x20tìm\x20thấy\x20quest','Không\x20tìm\x20thấy\x20coin',']Vào\x20game\x20OK','][click]Không\x20click\x20được\x20vào\x20','133928DEBVRZ','\x20OK','playAgain','366664WiLzuy','(//button[contains(text(),\x20\x27Next\x27)])[last()]','mainframe','[getFile]\x20error:\x20','][choDoMinXong]Không\x20click\x20được\x20vào\x20playAgain','message','NextRun','//button[contains(@class,\x20\x27_playButton_\x27)]','85761lxwUGY','][Lỗi]:\x20','][lamQuest]Không\x20click\x20được\x20vào\x20quest','Không\x20click\x20được\x20vào\x20quest','838310FSTbMJ','Không\x20tìm\x20thấy\x20iframe','//h6[text()=\x27Leave\x27]','load','(//span[contains(text(),\x20\x27Sweep\x27)])[last()]','][closePopup]Không\x20click\x20được\x20vào\x20play','][closePopup]Tìm\x20thấy\x20playNow','elementExistsByXPath','Iframe','switchFrame','//button[text()=\x27Leave\x27]','coin','9WhtrXD','][autoDoMin]:\x20','][lamQuest]Không\x20tìm\x20thấy\x20quest',']autoDoMin\x20OK','//h1[contains(@class,\x20\x27tgui-c6d7432a5c12debe\x27)]','5733096aWMTqh','toLocaleDateString','en-GB','playNow','javascript','\x20lần','readFile','][autoDoMin]Auto\x20dò\x20mìn\x20nè','][closePopup]Click\x20next\x20OK','][closePopup]Click\x20play\x20OK','][click]Click\x20','][closePopup]Không\x20tìm\x20thấy\x20playNow','NextRunStamp','now','][autoDoMin]Auto\x20dò\x20mìn\x20OK','6NUhVjs','1772vnwQlB','][closePopup][Lỗi]:\x20','][autoTap]:\x20','//h6[text()=\x27Next\x27]','//button[text()=\x27Play\x20Now\x27]','614789lstZak','soLuotChoiToiDaMotLan','][lamQuest]Click\x20quest\x20OK','promises','][closePopup]Click\x20playNow\x20OK','3kTCYYM','floor'];a0_0x39b3=function(){return _0x5156f8;};return a0_0x39b3();}(function(_0x35d431,_0x48f3ad){const _0x4d7a01=a0_0x5d79,_0x5d49f4=_0x35d431();while(!![]){try{const _0xb601ed=parseInt(_0x4d7a01(0x1ac))/0x1+parseInt(_0x4d7a01(0x1a4))/0x2*(parseInt(_0x4d7a01(0x1db))/0x3)+parseInt(_0x4d7a01(0x1d1))/0x4*(parseInt(_0x4d7a01(0x1fb))/0x5)+-parseInt(_0x4d7a01(0x1d0))/0x6*(-parseInt(_0x4d7a01(0x1d6))/0x7)+parseInt(_0x4d7a01(0x1a1))/0x8+parseInt(_0x4d7a01(0x1bc))/0x9*(parseInt(_0x4d7a01(0x1b0))/0xa)+parseInt(_0x4d7a01(0x1eb))/0xb*(-parseInt(_0x4d7a01(0x1c1))/0xc);if(_0xb601ed===_0x48f3ad)break;else _0x5d49f4['push'](_0x5d49f4['shift']());}catch(_0x51c7af){_0x5d49f4['push'](_0x5d49f4['shift']());}}}(a0_0x39b3,0x240af));import{log,json}from'../modules/logger.js';export default async function (context,signal){const _0x21defc=a0_0x5d79,choMs=ms=>new Promise(resolve=>setTimeout(resolve,ms)),{firstPage,bot,profileNameId,getAks,genlogin,http,browser,dataId,screenDataBuffer2,tasksDataBuffer2,taskIndex}=context;let currentPage=firstPage,subframe;const botName=bot[_0x21defc(0x1e2)];let screenData=new Int32Array(screenDataBuffer2),tasksData=new Int32Array(tasksDataBuffer2),demLoop=0x0,remainTime;const xpath={'PopupPlayButton':_0x21defc(0x1ab),'Sweep':_0x21defc(0x1b4),'Next':_0x21defc(0x1a5),'startGame':'(//button[contains(text(),\x20\x27Start\x20Game\x27)])[last()]','playNow':_0x21defc(0x1e8),'playNow1':_0x21defc(0x1d5),'playAgain':'//span[text()=\x27Play\x20Again\x27]','closeButton':'//button[contains(@class,\x20\x27_closeButton_\x27)]','Leave':_0x21defc(0x1ba),'Leaders':_0x21defc(0x1e7),'coin1':'//span[contains(@class,\x20\x27yellow\x27)]','coin':_0x21defc(0x1c0),'Leave':_0x21defc(0x1b2)};let soLuotChoiToiDaMotLan=0x5,thoiGianChoChoiToiaDaMotLan=0x78;parseInt(bot['botSet'][_0x21defc(0x1d7)][_0x21defc(0x1f9)])>0x0&&(soLuotChoiToiDaMotLan=parseInt(bot['botSet']['soLuotChoiToiDaMotLan'][_0x21defc(0x1f9)]),thoiGianChoChoiToiaDaMotLan=soLuotChoiToiDaMotLan*0x3c);try{subframe=await vaoGame();if(!subframe){log(profileNameId,'['+botName+_0x21defc(0x1f4),![]);throw new Error(_0x21defc(0x1b1));}log(profileNameId,'['+botName+_0x21defc(0x201)),await delay(0x3e8),await closePopup(),await autoDoMin(),await delay(0x7d0);const kqDoMin=await choDoMinXong(soLuotChoiToiDaMotLan);!kqDoMin?log(profileNameId,'['+botName+']có\x20vấn\x20đề\x20gì\x20đó\x20với\x20autoDoMin',null,![]):log(profileNameId,'['+botName+_0x21defc(0x1bf));await delay(0x7d0);const coinTag=await genlogin[_0x21defc(0x1b7)](profileNameId,subframe,xpath[_0x21defc(0x1bb)],0x3e8);if(!coinTag){log(profileNameId,'['+botName+_0x21defc(0x1ed));throw new Error(_0x21defc(0x1fe));}log(profileNameId,'['+botName+_0x21defc(0x1f2));const coin=await genlogin[_0x21defc(0x1e3)](profileNameId,subframe,xpath[_0x21defc(0x1bb)],0x7d0);if(!coin){log(profileNameId,'['+botName+_0x21defc(0x1f1),![]);throw new Error(_0x21defc(0x200));}await http['updateData'](profileNameId,profileNameId,dataId,null,null,coin),log(profileNameId,'['+botName+_0x21defc(0x1df)+coin);const remainT=await thoigianconlai(_0x21defc(0x1fc));return!remainT&&log(profileNameId,'['+botName+_0x21defc(0x1de),null,![]),log(profileNameId,'['+botName+']Xử\x20lý\x20thoigianconlai\x20OK'),log(profileNameId,'['+botName+_0x21defc(0x1ec)+remainT[_0x21defc(0x1aa)]),await clearVar(),{'status':!![],'coin':coin,'nextRun':remainT[_0x21defc(0x1aa)],'nextRunStamp':remainT[_0x21defc(0x1cd)]};}catch(error){return log(profileNameId,'['+botName+_0x21defc(0x1ad)+error,null,![]),await clearVar(),null;}async function vaoGame(){const _0x1dcec2=_0x21defc;try{log(profileNameId,'['+botName+_0x1dcec2(0x1ef));const subframe0=await genlogin[_0x1dcec2(0x1b9)](profileNameId,currentPage,getAks[_0x1dcec2(0x1b8)],0x2710);if(!subframe0){log(profileNameId,'['+botName+_0x1dcec2(0x1f4),![]);throw new Error('Không\x20tìm\x20thấy\x20iframe');}return log(profileNameId,'['+botName+_0x1dcec2(0x1f3)),subframe0;}catch(error){return log(profileNameId,'['+botName+'][Lỗi]:\x20'+error,![]),null;}}async function raGame(){const _0xdd80fc=_0x21defc;try{log(profileNameId,'['+botName+']Ra\x20game\x20nè'),currentPage=genlogin[_0xdd80fc(0x1b9)](profileNameId,currentPage,_0xdd80fc(0x1a6),0x7d0);if(!currentPage){log(profileNameId,'['+botName+']Không\x20tìm\x20thấy\x20main\x20frame',![]);throw new Error('Không\x20tìm\x20thấy\x20main\x20frame');}return currentPage;}catch(error){return log(profileNameId,'['+botName+_0xdd80fc(0x1ad)+error,![]),null;}}async function click(xpath){const _0x207545=_0x21defc;try{await delay(0x3e8);const clicked=await genlogin[_0x207545(0x1dd)](profileNameId,subframe,{'xpath':xpath,'mainframe':currentPage,'browser':browser},0x3e8);await delay(0x3e8);if(!clicked)return log(profileNameId,'['+botName+_0x207545(0x202)+xpath,null,![]),null;return log(profileNameId,'['+botName+_0x207545(0x1cb)+xpath+_0x207545(0x1a2)),clicked;}catch(error){return log(profileNameId,'['+botName+_0x207545(0x1f6)+error,null,![]),null;}}async function closePopup(){const _0x33caa7=_0x21defc,cpXpath={'playNow':'//span[text()=\x27Play\x20Now\x27]','play':'//span[text()=\x27Play\x27]','next':_0x33caa7(0x1d4),'startGame':'//h6[text()=\x27Start\x20Game\x27]'};try{log(profileNameId,'['+botName+'][closePopup]vaof\x20closePopup\x20nè'),await delay(0x3e8);let demLoop=0x0;const maxDemLoop=0xa;while(demLoop<maxDemLoop){demLoop++;const kqPlay=await genlogin[_0x33caa7(0x1b7)](profileNameId,subframe,cpXpath['play'],0x3e8);if(!kqPlay)log(profileNameId,'['+botName+_0x33caa7(0x1e9),null,![]);else{log(profileNameId,'['+botName+_0x33caa7(0x1e6));const clicked=await click(cpXpath[_0x33caa7(0x1f7)]);!clicked?log(profileNameId,'['+botName+_0x33caa7(0x1b5),null,![]):log(profileNameId,'['+botName+_0x33caa7(0x1ca));continue;}const kqNext=await genlogin[_0x33caa7(0x1b7)](profileNameId,subframe,cpXpath[_0x33caa7(0x1fd)],0x3e8);if(!kqNext)log(profileNameId,'['+botName+'][closePopup]Không\x20tìm\x20thấy\x20next',null,![]);else{log(profileNameId,'['+botName+'][closePopup]Tìm\x20thấy\x20next');const clicked=await click(cpXpath['next']);!clicked?log(profileNameId,'['+botName+'][closePopup]Không\x20click\x20được\x20vào\x20next',null,![]):log(profileNameId,'['+botName+_0x33caa7(0x1c9));continue;}const kqPlayNow=await genlogin[_0x33caa7(0x1b7)](profileNameId,subframe,cpXpath['playNow'],0x3e8);if(!kqPlayNow)log(profileNameId,'['+botName+_0x33caa7(0x1cc),null,![]);else{log(profileNameId,'['+botName+_0x33caa7(0x1b6));const clicked=await click(cpXpath[_0x33caa7(0x1c4)]);!clicked?log(profileNameId,'['+botName+'][closePopup]Không\x20click\x20được\x20vào\x20playNow',null,![]):log(profileNameId,'['+botName+_0x33caa7(0x1da));continue;}break;}}catch(error){return log(profileNameId,'['+botName+_0x33caa7(0x1d2)+error,null,![]),null;}}async function autoDoMin(){const _0x11658e=_0x21defc;try{log(profileNameId,'['+botName+_0x11658e(0x1c8));let codeAutoTap=await getFile(botName+'-autoTap');return genlogin[_0x11658e(0x1c5)](profileNameId,subframe,codeAutoTap),log(profileNameId,'['+botName+_0x11658e(0x1cf)),!![];}catch(error){return log(profileNameId,'['+botName+_0x11658e(0x1bd)+error,null,![]),null;}}async function choDoMinXong(count){const _0x1ca502=_0x21defc;try{let maxAttempts=thoiGianChoChoiToiaDaMotLan,LoutChoiXong=0x0,attempt=0x0;while(attempt<maxAttempts){attempt++;const kq10=await genlogin[_0x1ca502(0x1b7)](profileNameId,subframe,xpath[_0x1ca502(0x1a3)],0x3e8);if(kq10){LoutChoiXong++,log(profileNameId,'['+botName+_0x1ca502(0x1f0)+LoutChoiXong+'/'+count+_0x1ca502(0x1c6));if(LoutChoiXong>=count)break;const kq11=await click(xpath['playAgain']);if(!kq11){log(profileNameId,'['+botName+_0x1ca502(0x1a8),null,![]);break;}log(profileNameId,'['+botName+_0x1ca502(0x1ea));}log(profileNameId,'['+botName+'][choDoMinXong]\x20Đang\x20chờ\x20tap\x20xong\x20'+attempt+'|'+maxAttempts),await delay(0x1388);}return!![];}catch(error){return log(profileNameId,'['+botName+_0x1ca502(0x1d3)+error,null,![]),null;}}async function getFile(nameFile){const _0x2e5bde=_0x21defc;try{const fs=require('fs'),path=require('path'),filePath=path[_0x2e5bde(0x1f5)](__dirname,_0x2e5bde(0x1c5),nameFile),code=await fs[_0x2e5bde(0x1d9)][_0x2e5bde(0x1c7)](filePath,'utf8');return code;}catch(e){log(_0x2e5bde(0x1a7)+e[_0x2e5bde(0x1a9)]);}}async function lamQuest(){const _0x253c73=_0x21defc;try{log(profileNameId,'['+botName+'][lamQuest]Làm\x20Quest\x20nè');const kq10=await genlogin[_0x253c73(0x1b7)](profileNameId,subframe,xpath[_0x253c73(0x1ee)],0x7d0);if(!kq10){log(profileNameId,'['+botName+_0x253c73(0x1be),![]);throw new Error(_0x253c73(0x1ff));}log(profileNameId,'['+botName+_0x253c73(0x1e5));const clicked=await click(xpath[_0x253c73(0x1ee)]);if(!clicked){log(profileNameId,'['+botName+_0x253c73(0x1ae),![]);throw new Error(_0x253c73(0x1af));}return log(profileNameId,'['+botName+_0x253c73(0x1d8)),!![];}catch(error){return log(profileNameId,'['+botName+_0x253c73(0x1f8)+error,null,![]),null;}}async function thoigianconlai(thoigianconlai){const _0x3fb52e=_0x21defc;try{log(profileNameId,'['+botName+_0x3fb52e(0x1e0));let parts=thoigianconlai[_0x3fb52e(0x1e1)](':'),hour0=parseInt(parts[0x0]),minute0=parseInt(parts[0x1]),second0=parseInt(parts[0x2]),hours=parseInt(hour0),minutes=parseInt(minute0),seconds=parseInt(second0),totalSeconds=parseInt(hours*0xe10+minutes*0x3c+seconds);const unixTime=Math[_0x3fb52e(0x1dc)](Date[_0x3fb52e(0x1ce)]()/0x3e8),newUnixTime=unixTime+totalSeconds,newDate=new Date(newUnixTime*0x3e8),formattedDate=newDate[_0x3fb52e(0x1c2)](),formattedTime=newDate[_0x3fb52e(0x1fa)](_0x3fb52e(0x1c3),{'hour12':![]});let NextRun=formattedDate+'\x20'+formattedTime;return{'NextRun':NextRun,'NextRunStamp':newUnixTime};}catch(error){return log(profileNameId,'['+botName+_0x3fb52e(0x1e4)+error,null,![]),null;}}async function delay(ms){return new Promise(async resolve=>{setTimeout(resolve,ms);});}async function cTimeout(){const _0x43cc28=_0x21defc;if(Atomics[_0x43cc28(0x1b3)](tasksData,taskIndex)===0x1)return!![];return![];}async function clearVar(){currentPage=null,subframe=null,screenData=null,tasksData=null;}};