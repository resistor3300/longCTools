const a29_0x509ba9=a29_0x5764;(function(_0x209149,_0x726d99){const _0x17385d=a29_0x5764,_0x53be8e=_0x209149();while(!![]){try{const _0x432d90=parseInt(_0x17385d(0x223))/0x1*(parseInt(_0x17385d(0x1ec))/0x2)+parseInt(_0x17385d(0x219))/0x3+parseInt(_0x17385d(0x21a))/0x4*(-parseInt(_0x17385d(0x1ed))/0x5)+parseInt(_0x17385d(0x228))/0x6*(-parseInt(_0x17385d(0x225))/0x7)+-parseInt(_0x17385d(0x1e3))/0x8*(parseInt(_0x17385d(0x1f4))/0x9)+-parseInt(_0x17385d(0x1f0))/0xa+-parseInt(_0x17385d(0x213))/0xb*(-parseInt(_0x17385d(0x209))/0xc);if(_0x432d90===_0x726d99)break;else _0x53be8e['push'](_0x53be8e['shift']());}catch(_0x4e1835){_0x53be8e['push'](_0x53be8e['shift']());}}}(a29_0x28a6,0x38b29),require(a29_0x509ba9(0x1e8))[a29_0x509ba9(0x210)]());const {Worker,parentPort}=require(a29_0x509ba9(0x222)),{AbortController}=require(a29_0x509ba9(0x206)),{log,json}=require(a29_0x509ba9(0x20e)),Genlogin=require(a29_0x509ba9(0x1e9)),httpPost=require('./modules/http'),PQueue=require(a29_0x509ba9(0x1e5))[a29_0x509ba9(0x200)];let profileQueue,genlogin,profileNameId,profileId,browser,http;function a29_0x28a6(){const _0x119a7b=['nextrunstamp','[\x27worker-api1][','3872143EHpyEF','stringify','exit','[xuLyTask]:\x20không\x20lấy\x20được\x20profile','profiles','[xuLyProfiles]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20profiles\x20thành\x20công','1125552yICHrT','64KhrcnS','success','profile\x20','getTask','\x20ok','[xuLyTask]:\x20Hoàn\x20thành\x20xử\x20lý\x20task:\x20','[xuLyTungProfile]:\x20Kết\x20thúc\x20worker\x20','./worker-api2.js','worker_threads','26473yEoSHq','value','812938qCGVSI','[xuLyTask]:\x20Lỗi\x20while:\x20','date','18vGIYAS','[xuLyProfiles]:\x20Task\x20','3070840HOcKwY','[xuLyTungProfile]3:\x20Lỗi\x20xử\x20lý\x20profile\x20','p-queue','\x20đã\x20bị\x20hủy\x20trước\x20khi\x20bắt\x20đầu','env','dotenv','./modules/Genlogin','name','[xuLyTask]:\x20Tasks:\x20','10GWlhbO','104770AMuKAx','[xuLyTask]:\x20Không\x20lấy\x20được\x20dữ\x20liệu\x20profiles\x20','\x20đã\x20bị\x20hủy','2638340Vffxbj','message','[\x27worker-api1]:\x20','aborted','9KbvVPf','\x20timed\x20out.','timeout','\x20đã\x20thoát\x20với\x20mã\x20lỗi\x20','add','postMessage','\x20set\x20timeout:\x20','delayOpenProfile','error','\x20vào\x20hàng\x20đợi\x20max:','APIKEY','[xuLyTask]:\x20Task\x20','default','[xuLyTungProfile]1:\x20Đã\x20xử\x20lý\x20profile\x20','length','[xuLyTask]:\x20currentDateTime:\x20','\x20vào\x20hàng\x20đợi.','[xuLyTungProfile]4:\x20Worker\x20','abort-controller','No\x20profile\x20found','profileThreads','36uBsruC','[xuLyTungProfile]:profile\x20','\x20|\x20nextrun:\x20','[xuLyProfiles]:\x20Lỗi\x20:\x20','[xuLyTask]:\x20Chờ\x205\x20giây\x20trước\x20khi\x20xử\x20lý\x20task\x20tiếp\x20theo...','./modules/logger','botThreads','config'];a29_0x28a6=function(){return _0x119a7b;};return a29_0x28a6();}genlogin=new Genlogin('',!![]),http=new httpPost(process[a29_0x509ba9(0x1e7)]['SERVER_HOST'],process[a29_0x509ba9(0x1e7)][a29_0x509ba9(0x1fe)],!![]);let signal={'aborted':![]},firstRun=!![],delayOpenProfile=0xbb8,profileTimeout=0x5265c0,botTimeout=0x5265c0,profileThreads=0x1,maxBotThreads=0x1;function a29_0x5764(_0x17e650,_0x347248){const _0x28a696=a29_0x28a6();return a29_0x5764=function(_0x57649d,_0xbe8001){_0x57649d=_0x57649d-0x1e3;let _0x28979a=_0x28a696[_0x57649d];return _0x28979a;},a29_0x5764(_0x17e650,_0x347248);}parentPort['on'](a29_0x509ba9(0x1f1),async _0x1cf0c2=>{const _0x8a8353=a29_0x509ba9;try{if(_0x1cf0c2==='timeout')signal[_0x8a8353(0x1f3)]=!![];else{const {task:_0x5d4068}=_0x1cf0c2;log(_0x8a8353(0x212)+_0x5d4068[_0x8a8353(0x1ea)]+']:\x20Api\x20Mode',null,'w');if(signal['aborted'])throw new Error(_0x8a8353(0x1f6));const _0x426fed=await xuLyTask(_0x5d4068);log(_0x8a8353(0x1f2)+json(_0x426fed),null,'w'),!_0x426fed?parentPort['postMessage']({'success':![],'result':_0x426fed}):parentPort[_0x8a8353(0x1f9)]({'success':!![],'result':_0x426fed});}}catch(_0x4133e9){parentPort[_0x8a8353(0x1f9)]({'success':![],'error':_0x4133e9[_0x8a8353(0x1f1)]});}});async function xuLyTask(_0xe6d10e){const _0x33c753=a29_0x509ba9;try{if(signal[_0x33c753(0x1f3)]){log(_0x33c753(0x1ff)+_0xe6d10e[_0x33c753(0x1ea)]+_0x33c753(0x1e6),null,'w');throw new Error(_0x33c753(0x1f6));}const _0x564ebb=await genlogin['nowTime'](),_0x3f0e13=_0x564ebb[_0x33c753(0x227)];if(_0x3f0e13<_0xe6d10e[_0x33c753(0x211)])return log('[xuLyTask]:\x20Task\x20'+JSON['stringify'](_0xe6d10e[_0x33c753(0x1ea)])+'\x20chưa\x20đến\x20thời\x20gian\x20chạy',null,'i'),log(_0x33c753(0x203)+JSON[_0x33c753(0x214)](_0x564ebb)+'\x20|\x20nextrun:\x20'+JSON[_0x33c753(0x214)](_0xe6d10e['nextrun']),null,'w'),log(_0x33c753(0x203)+JSON[_0x33c753(0x214)](_0x3f0e13)+_0x33c753(0x20b)+JSON[_0x33c753(0x214)](taskNextRunDateTime),null,'w'),log(_0x33c753(0x20d),null,'i'),await delay(0x1388),null;let _0x3f191c=await http[_0x33c753(0x21d)](_0xe6d10e[_0x33c753(0x1ea)]);if(_0x3f191c[_0x33c753(0x224)][_0x33c753(0x217)][_0x33c753(0x202)]<=0x0){log(_0x33c753(0x216),null,![]);throw new Error(_0x33c753(0x207));}firstRun&&(firstRun=![],profileThreads=parseInt(_0xe6d10e[_0x33c753(0x208)]),maxBotThreads=parseInt(_0xe6d10e[_0x33c753(0x20f)]),profileQueue=new PQueue({'concurrency':profileThreads}),delayOpenProfile=parseInt(_0xe6d10e[_0x33c753(0x1fb)])*0x3e8,profileTimeout=parseInt(_0xe6d10e['profileTimeout'])*0x3e8,botTimeout=parseInt(_0xe6d10e['botTimeout'])*0x3e8);const _0x5e2c0d=await xuLyProfiles(_0x3f191c[_0x33c753(0x224)][_0x33c753(0x217)]);if(!_0x5e2c0d){log(_0x33c753(0x1ee)+json(_0x5e2c0d),null,![]);throw new Error(_0x33c753(0x207));}return log(_0x33c753(0x1eb)+_0xe6d10e[_0x33c753(0x1ea)]+_0x33c753(0x21e)),await delay(0x7d0),log(_0x33c753(0x21f)+JSON[_0x33c753(0x214)](_0xe6d10e[_0x33c753(0x1ea)])),!![];}catch(_0x1fa5b8){return log(_0x33c753(0x226)+_0x1fa5b8,null,![]),null;}}async function xuLyProfiles(_0x5698a3){const _0x4c83ce=a29_0x509ba9;try{if(signal[_0x4c83ce(0x1f3)]){log('[xuLyProfiles]:đã\x20bị\x20hủy',null,'w');throw new Error('timeout');}const _0x942976=[];for(const _0x10e944 of _0x5698a3){if(signal[_0x4c83ce(0x1f3)]){log(_0x4c83ce(0x229)+_0x10e944+_0x4c83ce(0x1ef),null,'w');throw new Error('timeout');}log('[xuLyProfiles]:\x20Thêm\x20profile\x20'+_0x10e944+_0x4c83ce(0x1fd)+profileThreads,null,'i'),_0x942976['push'](profileQueue[_0x4c83ce(0x1f8)](()=>xuLyTungProfile(_0x10e944))),log('[xuLyProfiles]:\x20Đã\x20thêm\x20profile\x20'+_0x10e944+_0x4c83ce(0x204)),await delay(delayOpenProfile);}return await Promise['all'](_0x942976),log(_0x4c83ce(0x218)),!![];}catch(_0x1c8231){return log(_0x4c83ce(0x20c)+_0x1c8231,null,![]),null;}}async function xuLyTungProfile(_0x219d17){const _0x16a5bf=a29_0x509ba9;try{let _0x3449b5={'aborted':![]};log('[xuLyTungProfile]:\x20Đang\x20xử\x20lý\x20profile\x20'+_0x219d17,null,'i');if(signal[_0x16a5bf(0x1f3)]){log('[xuLyTungProfile]:đã\x20bị\x20hủy',null,'w'),_0x3449b5[_0x16a5bf(0x1f3)]=!![];throw new Error('timeout');}return new Promise((_0x425f13,_0x4072f6)=>{const _0x5ca0c4=_0x16a5bf,_0x492f0f=new Worker(_0x5ca0c4(0x221)),_0x5ca2f8=setTimeout(()=>{const _0x5524a4=_0x5ca0c4;_0x492f0f['postMessage']({'profile':_0x5524a4(0x1f6)}),_0x4072f6(new Error(_0x5524a4(0x21c)+_0x219d17+_0x5524a4(0x1f5)));},profileTimeout);log(_0x5ca0c4(0x20a)+_0x219d17+_0x5ca0c4(0x1fa)+profileTimeout,null,'w');const _0x34bd41=setInterval(()=>{const _0x47554c=_0x5ca0c4;signal[_0x47554c(0x1f3)]&&(log('[xuLyTungProfile]:timeout',null,'w'),_0x492f0f[_0x47554c(0x1f9)]({'profile':'timeout'}));},0x1388);if(_0x3449b5['aborted']){_0x492f0f['postMessage']('timeout');throw new Error(_0x5ca0c4(0x1f6));}log('maxBotThreadsmaxBotThreadsmaxBotThreads'+maxBotThreads),_0x492f0f[_0x5ca0c4(0x1f9)]({'profile':_0x219d17,'maxBot':maxBotThreads}),_0x492f0f['on'](_0x5ca0c4(0x1f1),_0x49e877=>{const _0x3d1324=_0x5ca0c4;clearTimeout(_0x5ca2f8),clearInterval(_0x34bd41),_0x49e877[_0x3d1324(0x21b)]?(log(_0x3d1324(0x201)+_0x219d17,null,'i'),_0x425f13(!![])):(log('[xuLyTungProfile]2:\x20Lỗi\x20xử\x20lý\x20profile\x20'+_0x219d17+':\x20'+json(_0x49e877['error']),null,![]),_0x4072f6(_0x49e877[_0x3d1324(0x1fc)])),log(_0x3d1324(0x220)+_0x219d17,null,'w');}),_0x492f0f['on'](_0x5ca0c4(0x1fc),_0x461adb=>{const _0x547f69=_0x5ca0c4;clearInterval(_0x34bd41),clearTimeout(_0x5ca2f8),log(_0x547f69(0x1e4)+_0x219d17+':\x20'+json(_0x461adb),null,![]),_0x4072f6(_0x461adb);}),_0x492f0f['on'](_0x5ca0c4(0x215),_0x3975a4=>{const _0x18c8af=_0x5ca0c4;clearInterval(_0x34bd41),_0x3975a4!==0x0&&(log(_0x18c8af(0x205)+_0x219d17+_0x18c8af(0x1f7)+_0x3975a4,null,![]),_0x4072f6(new Error('Worker\x20stopped\x20with\x20exit\x20code\x20'+_0x3975a4)));});});}catch(_0x335212){clearInterval(intervalId),log('[xuLyTungProfile]:\x20Lỗi:\x20'+_0x335212[_0x16a5bf(0x1f1)],null,![]);throw _0x335212;}}async function delay(_0x1591d6){return new Promise(_0xb2ccf3=>{const _0x205241=a29_0x5764;if(signal[_0x205241(0x1f3)])throw new Error('timeout');setTimeout(_0xb2ccf3,_0x1591d6);});}