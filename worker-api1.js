function a29_0x10fe(_0x106595,_0x20631b){const _0x46b045=a29_0x46b0();return a29_0x10fe=function(_0x10fe76,_0x510220){_0x10fe76=_0x10fe76-0x1ab;let _0x543b13=_0x46b045[_0x10fe76];return _0x543b13;},a29_0x10fe(_0x106595,_0x20631b);}const a29_0x5a0410=a29_0x10fe;(function(_0x41cac5,_0x431893){const _0x52326f=a29_0x10fe,_0x318a80=_0x41cac5();while(!![]){try{const _0x39ddc8=-parseInt(_0x52326f(0x1b2))/0x1*(-parseInt(_0x52326f(0x1ef))/0x2)+-parseInt(_0x52326f(0x1c0))/0x3+parseInt(_0x52326f(0x1f5))/0x4*(-parseInt(_0x52326f(0x1cb))/0x5)+-parseInt(_0x52326f(0x1b4))/0x6*(-parseInt(_0x52326f(0x1d1))/0x7)+-parseInt(_0x52326f(0x1c5))/0x8+-parseInt(_0x52326f(0x1d5))/0x9*(-parseInt(_0x52326f(0x1d8))/0xa)+-parseInt(_0x52326f(0x1db))/0xb*(-parseInt(_0x52326f(0x1f1))/0xc);if(_0x39ddc8===_0x431893)break;else _0x318a80['push'](_0x318a80['shift']());}catch(_0x4784a7){_0x318a80['push'](_0x318a80['shift']());}}}(a29_0x46b0,0xdd4dd),require(a29_0x5a0410(0x1bf))[a29_0x5a0410(0x1cd)]());const {Worker,parentPort}=require(a29_0x5a0410(0x1d7)),{AbortController}=require(a29_0x5a0410(0x1dc)),{log,json}=require(a29_0x5a0410(0x1e0)),Genlogin=require(a29_0x5a0410(0x1eb)),httpPost=require('./modules/http'),PQueue=require('p-queue')[a29_0x5a0410(0x1ba)];let profileQueue,genlogin,profileNameId,profileId,browser,http;genlogin=new Genlogin('',!![]),http=new httpPost(process[a29_0x5a0410(0x1b7)][a29_0x5a0410(0x1dd)],process[a29_0x5a0410(0x1b7)]['APIKEY'],!![]);let signal={'aborted':![]},firstRun=!![],delayOpenProfile=0xbb8,profileTimeout=0x5265c0,botTimeout=0x5265c0,profileThreads=0x1,maxBotThreads=0x1;parentPort['on'](a29_0x5a0410(0x1af),async _0x1a1bc1=>{const _0xe3dfe2=a29_0x5a0410;try{if(_0x1a1bc1===_0xe3dfe2(0x1d3))signal['aborted']=!![];else{const {task:_0x585d78}=_0x1a1bc1;log(_0xe3dfe2(0x1e6)+_0x585d78['name']+']:\x20Api\x20Mode',null,'w');if(signal['aborted'])throw new Error(_0xe3dfe2(0x1d3));const _0x4cd66a=await xuLyTask(_0x585d78);log(_0xe3dfe2(0x1c2)+json(_0x4cd66a),null,'w'),!_0x4cd66a?parentPort[_0xe3dfe2(0x1ae)]({'success':![],'result':_0x4cd66a}):parentPort['postMessage']({'success':!![],'result':_0x4cd66a});}}catch(_0x59a529){parentPort[_0xe3dfe2(0x1ae)]({'success':![],'error':_0x59a529[_0xe3dfe2(0x1af)]});}});async function xuLyTask(_0x25c4b0){const _0x29470a=a29_0x5a0410;try{if(signal[_0x29470a(0x1e9)]){log(_0x29470a(0x1d6)+_0x25c4b0[_0x29470a(0x1f2)]+_0x29470a(0x1c9),null,'w');throw new Error(_0x29470a(0x1d3));}const _0x5d72cc=await genlogin[_0x29470a(0x1b1)](),_0xd83200=_0x5d72cc[_0x29470a(0x1c7)];if(_0xd83200<_0x25c4b0[_0x29470a(0x1d0)])return log(_0x29470a(0x1d6)+JSON[_0x29470a(0x1e8)](_0x25c4b0[_0x29470a(0x1f2)])+_0x29470a(0x1bc),null,'i'),log(_0x29470a(0x1b0)+JSON['stringify'](_0x5d72cc)+_0x29470a(0x1bb)+JSON['stringify'](_0x25c4b0[_0x29470a(0x1ee)]),null,'w'),log(_0x29470a(0x1b0)+JSON[_0x29470a(0x1e8)](_0xd83200)+_0x29470a(0x1bb)+JSON[_0x29470a(0x1e8)](taskNextRunDateTime),null,'w'),log(_0x29470a(0x1c6),null,'i'),await delay(0x1388),null;let _0x302dc7=await http[_0x29470a(0x1c1)](_0x25c4b0['name']);if(_0x302dc7[_0x29470a(0x1cc)]['profiles']['length']<=0x0){log(_0x29470a(0x1e5),null,![]);throw new Error('No\x20profile\x20found');}firstRun&&(firstRun=![],profileThreads=parseInt(_0x25c4b0[_0x29470a(0x1da)]),maxBotThreads=parseInt(_0x25c4b0['botThreads']),profileQueue=new PQueue({'concurrency':profileThreads}),delayOpenProfile=parseInt(_0x25c4b0[_0x29470a(0x1b8)])*0x3e8,profileTimeout=parseInt(_0x25c4b0['profileTimeout'])*0x3e8,botTimeout=parseInt(_0x25c4b0['botTimeout'])*0x3e8);const _0x295f31=await xuLyProfiles(_0x302dc7['value'][_0x29470a(0x1ce)]);if(!_0x295f31){log(_0x29470a(0x1ec)+json(_0x295f31),null,![]);throw new Error(_0x29470a(0x1ad));}return log(_0x29470a(0x1ac)+_0x25c4b0[_0x29470a(0x1f2)]+'\x20ok'),await delay(0x7d0),log(_0x29470a(0x1ca)+JSON['stringify'](_0x25c4b0['name'])),!![];}catch(_0x2a8fd4){return log(_0x29470a(0x1be)+_0x2a8fd4,null,![]),null;}}async function xuLyProfiles(_0x4bff88){const _0x3ae960=a29_0x5a0410;try{if(signal[_0x3ae960(0x1e9)]){log(_0x3ae960(0x1f3),null,'w');throw new Error(_0x3ae960(0x1d3));}const _0x311f8f=[];for(const _0x4d89b0 of _0x4bff88){if(signal[_0x3ae960(0x1e9)]){log(_0x3ae960(0x1e1)+_0x4d89b0+_0x3ae960(0x1c3),null,'w');throw new Error(_0x3ae960(0x1d3));}log(_0x3ae960(0x1e7)+_0x4d89b0+_0x3ae960(0x1ab)+profileThreads,null,'i'),_0x311f8f['push'](profileQueue[_0x3ae960(0x1f0)](()=>xuLyTungProfile(_0x4d89b0))),log('[xuLyProfiles]:\x20Đã\x20thêm\x20profile\x20'+_0x4d89b0+_0x3ae960(0x1df)),await delay(delayOpenProfile);}return await Promise[_0x3ae960(0x1ea)](_0x311f8f),log(_0x3ae960(0x1f6)),!![];}catch(_0x39da9f){return log(_0x3ae960(0x1ed)+_0x39da9f,null,![]),null;}}async function xuLyTungProfile(_0x4fbaa1){const _0x53e29c=a29_0x5a0410;try{let _0x49aa89={'aborted':![]};log(_0x53e29c(0x1d9)+_0x4fbaa1,null,'i');if(signal[_0x53e29c(0x1e9)]){log(_0x53e29c(0x1d2),null,'w'),_0x49aa89[_0x53e29c(0x1e9)]=!![];throw new Error('timeout');}return new Promise((_0x2d6b8e,_0x22425c)=>{const _0x59726b=_0x53e29c,_0x48ffc6=new Worker(_0x59726b(0x1b9)),_0x18956c=setTimeout(()=>{const _0x43ca10=_0x59726b;_0x48ffc6[_0x43ca10(0x1ae)]({'profile':_0x43ca10(0x1d3)}),_0x22425c(new Error(_0x43ca10(0x1e3)+_0x4fbaa1+_0x43ca10(0x1f4)));},profileTimeout);log(_0x59726b(0x1c4)+_0x4fbaa1+'\x20set\x20timeout:\x20'+profileTimeout,null,'w');const _0x30142b=setInterval(()=>{const _0x376185=_0x59726b;signal[_0x376185(0x1e9)]&&(log(_0x376185(0x1de),null,'w'),_0x48ffc6['postMessage']({'profile':'timeout'}));},0x1388);if(_0x49aa89[_0x59726b(0x1e9)]){_0x48ffc6[_0x59726b(0x1ae)]('timeout');throw new Error(_0x59726b(0x1d3));}log(_0x59726b(0x1c8)+maxBotThreads),_0x48ffc6[_0x59726b(0x1ae)]({'profile':_0x4fbaa1,'maxBot':maxBotThreads}),_0x48ffc6['on']('message',_0x4cdfa8=>{const _0x1d716d=_0x59726b;clearTimeout(_0x18956c),clearInterval(_0x30142b),_0x4cdfa8[_0x1d716d(0x1d4)]?(log('[xuLyTungProfile]1:\x20Đã\x20xử\x20lý\x20profile\x20'+_0x4fbaa1,null,'i'),_0x2d6b8e(!![])):(log(_0x1d716d(0x1b5)+_0x4fbaa1+':\x20'+json(_0x4cdfa8[_0x1d716d(0x1bd)]),null,![]),_0x22425c(_0x4cdfa8[_0x1d716d(0x1bd)])),log(_0x1d716d(0x1e4)+_0x4fbaa1,null,'w');}),_0x48ffc6['on'](_0x59726b(0x1bd),_0x2c0858=>{const _0x304d6a=_0x59726b;clearInterval(_0x30142b),clearTimeout(_0x18956c),log(_0x304d6a(0x1e2)+_0x4fbaa1+':\x20'+json(_0x2c0858),null,![]),_0x22425c(_0x2c0858);}),_0x48ffc6['on'](_0x59726b(0x1cf),_0x1364b4=>{const _0x5f0956=_0x59726b;clearInterval(_0x30142b),_0x1364b4!==0x0&&(log('[xuLyTungProfile]4:\x20Worker\x20'+_0x4fbaa1+_0x5f0956(0x1b3)+_0x1364b4,null,![]),_0x22425c(new Error(_0x5f0956(0x1b6)+_0x1364b4)));});});}catch(_0xd3ddd7){clearInterval(intervalId),log('[xuLyTungProfile]:\x20Lỗi:\x20'+_0xd3ddd7[_0x53e29c(0x1af)],null,![]);throw _0xd3ddd7;}}function a29_0x46b0(){const _0x3ea61f=['[xuLyTungProfile]:timeout','\x20vào\x20hàng\x20đợi.','./modules/logger','[xuLyProfiles]:\x20Task\x20','[xuLyTungProfile]3:\x20Lỗi\x20xử\x20lý\x20profile\x20','profile\x20','[xuLyTungProfile]:\x20Kết\x20thúc\x20worker\x20','[xuLyTask]:\x20không\x20lấy\x20được\x20profile','[\x27worker-api1][','[xuLyProfiles]:\x20Thêm\x20profile\x20','stringify','aborted','all','./modules/Genlogin','[xuLyTask]:\x20Không\x20lấy\x20được\x20dữ\x20liệu\x20profiles\x20','[xuLyProfiles]:\x20Lỗi\x20:\x20','nextrun','8MpHtHi','add','48hwRQNm','name','[xuLyProfiles]:đã\x20bị\x20hủy','\x20timed\x20out.','974812ecubhG','[xuLyProfiles]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20profiles\x20thành\x20công','\x20vào\x20hàng\x20đợi\x20max:','[xuLyTask]:\x20Tasks:\x20','No\x20profile\x20found','postMessage','message','[xuLyTask]:\x20currentDateTime:\x20','nowTime','175751mMJfdP','\x20đã\x20thoát\x20với\x20mã\x20lỗi\x20','543606NDPTVZ','[xuLyTungProfile]2:\x20Lỗi\x20xử\x20lý\x20profile\x20','Worker\x20stopped\x20with\x20exit\x20code\x20','env','delayOpenProfile','./worker-api2.js','default','\x20|\x20nextrun:\x20','\x20chưa\x20đến\x20thời\x20gian\x20chạy','error','[xuLyTask]:\x20Lỗi\x20while:\x20','dotenv','1159884hAliMh','getTask','[\x27worker-api1]:\x20','\x20đã\x20bị\x20hủy','[xuLyTungProfile]:profile\x20','2861512aCyFRE','[xuLyTask]:\x20Chờ\x205\x20giây\x20trước\x20khi\x20xử\x20lý\x20task\x20tiếp\x20theo...','date','maxBotThreadsmaxBotThreadsmaxBotThreads','\x20đã\x20bị\x20hủy\x20trước\x20khi\x20bắt\x20đầu','[xuLyTask]:\x20Hoàn\x20thành\x20xử\x20lý\x20task:\x20','5lOdZnu','value','config','profiles','exit','nextrunstamp','14GxHVVy','[xuLyTungProfile]:đã\x20bị\x20hủy','timeout','success','747bvLtKK','[xuLyTask]:\x20Task\x20','worker_threads','67810PwrFrF','[xuLyTungProfile]:\x20Đang\x20xử\x20lý\x20profile\x20','profileThreads','1230493ugOvqm','abort-controller','SERVER_HOST'];a29_0x46b0=function(){return _0x3ea61f;};return a29_0x46b0();}async function delay(_0x19ccc0){return new Promise(_0x788960=>{const _0x49843b=a29_0x10fe;if(signal[_0x49843b(0x1e9)])throw new Error(_0x49843b(0x1d3));setTimeout(_0x788960,_0x19ccc0);});}