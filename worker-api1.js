function a29_0x53bb(_0x4d47ae,_0x48fe13){const _0x4042fb=a29_0x4042();return a29_0x53bb=function(_0x53bb50,_0x1ec7b2){_0x53bb50=_0x53bb50-0x7e;let _0xd00eb2=_0x4042fb[_0x53bb50];return _0xd00eb2;},a29_0x53bb(_0x4d47ae,_0x48fe13);}const a29_0x5299b0=a29_0x53bb;(function(_0x3f73e7,_0x442fa1){const _0x19a945=a29_0x53bb,_0x13ba37=_0x3f73e7();while(!![]){try{const _0xefbbcf=-parseInt(_0x19a945(0x9c))/0x1+-parseInt(_0x19a945(0xb6))/0x2+parseInt(_0x19a945(0xa2))/0x3*(-parseInt(_0x19a945(0xa4))/0x4)+-parseInt(_0x19a945(0xb3))/0x5+-parseInt(_0x19a945(0x7f))/0x6+parseInt(_0x19a945(0xa9))/0x7+parseInt(_0x19a945(0xad))/0x8*(parseInt(_0x19a945(0xa0))/0x9);if(_0xefbbcf===_0x442fa1)break;else _0x13ba37['push'](_0x13ba37['shift']());}catch(_0x74eaf8){_0x13ba37['push'](_0x13ba37['shift']());}}}(a29_0x4042,0xace51),require('dotenv')['config']());const {Worker,parentPort}=require(a29_0x5299b0(0xa3)),{AbortController}=require('abort-controller'),{log,json}=require('./modules/logger'),Genlogin=require(a29_0x5299b0(0x92)),httpPost=require(a29_0x5299b0(0xba)),PQueue=require('p-queue')[a29_0x5299b0(0x88)];let profileQueue,genlogin,profileNameId,profileId,browser,http;genlogin=new Genlogin('',!![]),http=new httpPost(process[a29_0x5299b0(0x91)][a29_0x5299b0(0xbb)],process[a29_0x5299b0(0x91)][a29_0x5299b0(0x81)],!![]);let signal={'aborted':![]},firstRun=!![],delayOpenProfile=0xbb8,profileTimeout=0x5265c0,botTimeout=0x5265c0,profileThreads=0x1,maxBotThreads=0x1;parentPort['on'](a29_0x5299b0(0xb9),async _0x595c1c=>{const _0x3e5935=a29_0x5299b0;try{if(_0x595c1c===_0x3e5935(0xb5))signal['aborted']=!![];else{const {task:_0x4d3ada}=_0x595c1c;log(_0x3e5935(0x9a)+_0x4d3ada['name']+_0x3e5935(0xbd),null,'w');if(signal[_0x3e5935(0x95)])throw new Error('timeout');const _0x52ab12=await xuLyTask(_0x4d3ada);log(_0x3e5935(0xaf)+json(_0x52ab12),null,'w'),!_0x52ab12?parentPort['postMessage']({'success':![],'result':_0x52ab12}):parentPort[_0x3e5935(0xa7)]({'success':!![],'result':_0x52ab12});}}catch(_0x4dba60){parentPort[_0x3e5935(0xa7)]({'success':![],'error':_0x4dba60['message']});}});function a29_0x4042(){const _0x327985=['all','aborted','[xuLyTask]:\x20Chờ\x205\x20giây\x20trước\x20khi\x20xử\x20lý\x20task\x20tiếp\x20theo...','\x20|\x20nextrun:\x20','[xuLyTask]:\x20Task\x20','profileThreads','[\x27worker-api1][','./worker-api2.js','596072kKpkmB','push','botTimeout','No\x20profile\x20found','117ZLPlul','botThreads','669vRSuUl','worker_threads','15788bXmNZG','profiles','[xuLyTask]:\x20Lỗi\x20while:\x20','postMessage','length','7156422eMgNEh','error','[xuLyTungProfile]:đã\x20bị\x20hủy','\x20vào\x20hàng\x20đợi.','2844608GIbenf','stringify','[\x27worker-api1]:\x20','[xuLyTungProfile]:\x20Kết\x20thúc\x20worker\x20','[xuLyTask]:\x20không\x20lấy\x20được\x20profile','[xuLyTask]:\x20Tasks:\x20','4216225rJAPTT','add','timeout','2809698PkDjup','\x20đã\x20bị\x20hủy','[xuLyTask]:\x20currentDateTime:\x20','message','./modules/http','SERVER_HOST','maxBotThreadsmaxBotThreadsmaxBotThreads',']:\x20Api\x20Mode','[xuLyTungProfile]:\x20Đang\x20xử\x20lý\x20profile\x20','[xuLyProfiles]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20profiles\x20thành\x20công','\x20đã\x20bị\x20hủy\x20trước\x20khi\x20bắt\x20đầu','value','7273860SIQlTt','name','APIKEY','[xuLyTungProfile]:\x20Lỗi:\x20','nextrun','Worker\x20stopped\x20with\x20exit\x20code\x20','getTask','\x20ok','date','default','[xuLyProfiles]:đã\x20bị\x20hủy','[xuLyTungProfile]1:\x20Đã\x20xử\x20lý\x20profile\x20','[xuLyTask]:\x20Không\x20lấy\x20được\x20dữ\x20liệu\x20profiles\x20','[xuLyProfiles]:\x20Lỗi\x20:\x20','\x20vào\x20hàng\x20đợi\x20max:','\x20timed\x20out.','profile\x20','nextrunstamp','env','./modules/Genlogin','exit'];a29_0x4042=function(){return _0x327985;};return a29_0x4042();}async function xuLyTask(_0x2b8155){const _0x2b0da8=a29_0x5299b0;try{if(signal['aborted']){log(_0x2b0da8(0x98)+_0x2b8155[_0x2b0da8(0x80)]+_0x2b0da8(0xc0),null,'w');throw new Error(_0x2b0da8(0xb5));}const _0x528e80=await genlogin['nowTime'](),_0x202820=_0x528e80[_0x2b0da8(0x87)];if(_0x202820<_0x2b8155[_0x2b0da8(0x90)])return log(_0x2b0da8(0x98)+JSON[_0x2b0da8(0xae)](_0x2b8155[_0x2b0da8(0x80)])+'\x20chưa\x20đến\x20thời\x20gian\x20chạy',null,'i'),log('[xuLyTask]:\x20currentDateTime:\x20'+JSON[_0x2b0da8(0xae)](_0x528e80)+_0x2b0da8(0x97)+JSON['stringify'](_0x2b8155[_0x2b0da8(0x83)]),null,'w'),log(_0x2b0da8(0xb8)+JSON[_0x2b0da8(0xae)](_0x202820)+'\x20|\x20nextrun:\x20'+JSON['stringify'](taskNextRunDateTime),null,'w'),log(_0x2b0da8(0x96),null,'i'),await delay(0x1388),null;let _0x4c36a8=await http[_0x2b0da8(0x85)](_0x2b8155[_0x2b0da8(0x80)]);if(_0x4c36a8[_0x2b0da8(0x7e)]['profiles'][_0x2b0da8(0xa8)]<=0x0){log(_0x2b0da8(0xb1),null,![]);throw new Error(_0x2b0da8(0x9f));}firstRun&&(firstRun=![],profileThreads=parseInt(_0x2b8155[_0x2b0da8(0x99)]),maxBotThreads=parseInt(_0x2b8155[_0x2b0da8(0xa1)]),profileQueue=new PQueue({'concurrency':profileThreads}),delayOpenProfile=parseInt(_0x2b8155['delayOpenProfile'])*0x3e8,profileTimeout=parseInt(_0x2b8155['profileTimeout'])*0x3e8,botTimeout=parseInt(_0x2b8155[_0x2b0da8(0x9e)])*0x3e8);const _0xe5e3f8=await xuLyProfiles(_0x4c36a8['value'][_0x2b0da8(0xa5)]);if(!_0xe5e3f8){log(_0x2b0da8(0x8b)+json(_0xe5e3f8),null,![]);throw new Error('No\x20profile\x20found');}return log(_0x2b0da8(0xb2)+_0x2b8155[_0x2b0da8(0x80)]+_0x2b0da8(0x86)),await delay(0x7d0),log('[xuLyTask]:\x20Hoàn\x20thành\x20xử\x20lý\x20task:\x20'+JSON[_0x2b0da8(0xae)](_0x2b8155[_0x2b0da8(0x80)])),!![];}catch(_0x6cb548){return log(_0x2b0da8(0xa6)+_0x6cb548,null,![]),null;}}async function xuLyProfiles(_0x23f39f){const _0x4da0f2=a29_0x5299b0;try{if(signal[_0x4da0f2(0x95)]){log(_0x4da0f2(0x89),null,'w');throw new Error('timeout');}const _0x1de68d=[];for(const _0x4e9ec8 of _0x23f39f){if(signal[_0x4da0f2(0x95)]){log('[xuLyProfiles]:\x20Task\x20'+_0x4e9ec8+_0x4da0f2(0xb7),null,'w');throw new Error('timeout');}log('[xuLyProfiles]:\x20Thêm\x20profile\x20'+_0x4e9ec8+_0x4da0f2(0x8d)+profileThreads,null,'i'),_0x1de68d[_0x4da0f2(0x9d)](profileQueue[_0x4da0f2(0xb4)](()=>xuLyTungProfile(_0x4e9ec8))),log('[xuLyProfiles]:\x20Đã\x20thêm\x20profile\x20'+_0x4e9ec8+_0x4da0f2(0xac)),await delay(delayOpenProfile);}return await Promise[_0x4da0f2(0x94)](_0x1de68d),log(_0x4da0f2(0xbf)),!![];}catch(_0x27dc7e){return log(_0x4da0f2(0x8c)+_0x27dc7e,null,![]),null;}}async function xuLyTungProfile(_0x16d54d){const _0x3bd53b=a29_0x5299b0;try{let _0x185e15={'aborted':![]};log(_0x3bd53b(0xbe)+_0x16d54d,null,'i');if(signal[_0x3bd53b(0x95)]){log(_0x3bd53b(0xab),null,'w'),_0x185e15[_0x3bd53b(0x95)]=!![];throw new Error(_0x3bd53b(0xb5));}return new Promise((_0x426364,_0x3aa785)=>{const _0x326701=_0x3bd53b,_0x136e12=new Worker(_0x326701(0x9b)),_0x56657e=setTimeout(()=>{const _0x18665a=_0x326701;_0x136e12[_0x18665a(0xa7)]({'profile':_0x18665a(0xb5)}),_0x3aa785(new Error(_0x18665a(0x8f)+_0x16d54d+_0x18665a(0x8e)));},profileTimeout);log('[xuLyTungProfile]:profile\x20'+_0x16d54d+'\x20set\x20timeout:\x20'+profileTimeout,null,'w');const _0x53f946=setInterval(()=>{const _0x5865f7=_0x326701;signal['aborted']&&(log('[xuLyTungProfile]:timeout',null,'w'),_0x136e12[_0x5865f7(0xa7)]({'profile':_0x5865f7(0xb5)}));},0x1388);if(_0x185e15[_0x326701(0x95)]){_0x136e12[_0x326701(0xa7)](_0x326701(0xb5));throw new Error('timeout');}log(_0x326701(0xbc)+maxBotThreads),_0x136e12[_0x326701(0xa7)]({'profile':_0x16d54d,'maxBot':maxBotThreads}),_0x136e12['on'](_0x326701(0xb9),_0x1ee945=>{const _0x5c24e5=_0x326701;clearTimeout(_0x56657e),clearInterval(_0x53f946),_0x1ee945['success']?(log(_0x5c24e5(0x8a)+_0x16d54d,null,'i'),_0x426364(!![])):(log('[xuLyTungProfile]2:\x20Lỗi\x20xử\x20lý\x20profile\x20'+_0x16d54d+':\x20'+json(_0x1ee945[_0x5c24e5(0xaa)]),null,![]),_0x3aa785(_0x1ee945['error'])),log(_0x5c24e5(0xb0)+_0x16d54d,null,'w');}),_0x136e12['on'](_0x326701(0xaa),_0x2c16ce=>{clearInterval(_0x53f946),clearTimeout(_0x56657e),log('[xuLyTungProfile]3:\x20Lỗi\x20xử\x20lý\x20profile\x20'+_0x16d54d+':\x20'+json(_0x2c16ce),null,![]),_0x3aa785(_0x2c16ce);}),_0x136e12['on'](_0x326701(0x93),_0x4a7824=>{const _0x15b86c=_0x326701;clearInterval(_0x53f946),_0x4a7824!==0x0&&(log('[xuLyTungProfile]4:\x20Worker\x20'+_0x16d54d+'\x20đã\x20thoát\x20với\x20mã\x20lỗi\x20'+_0x4a7824,null,![]),_0x3aa785(new Error(_0x15b86c(0x84)+_0x4a7824)));});});}catch(_0x5e28b3){clearInterval(intervalId),log(_0x3bd53b(0x82)+_0x5e28b3[_0x3bd53b(0xb9)],null,![]);throw _0x5e28b3;}}async function delay(_0x366244){return new Promise(_0x24a7e5=>{const _0x3530c9=a29_0x53bb;if(signal['aborted'])throw new Error(_0x3530c9(0xb5));setTimeout(_0x24a7e5,_0x366244);});}