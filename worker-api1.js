const a29_0x273165=a29_0x4735;(function(_0x2dd26b,_0x247f30){const _0x3e29af=a29_0x4735,_0x25f0d4=_0x2dd26b();while(!![]){try{const _0x3f12f7=parseInt(_0x3e29af(0x1e1))/0x1*(-parseInt(_0x3e29af(0x1f2))/0x2)+-parseInt(_0x3e29af(0x207))/0x3+-parseInt(_0x3e29af(0x1ec))/0x4*(-parseInt(_0x3e29af(0x1ca))/0x5)+-parseInt(_0x3e29af(0x20c))/0x6+-parseInt(_0x3e29af(0x1db))/0x7+parseInt(_0x3e29af(0x20b))/0x8+-parseInt(_0x3e29af(0x1f5))/0x9*(-parseInt(_0x3e29af(0x1cf))/0xa);if(_0x3f12f7===_0x247f30)break;else _0x25f0d4['push'](_0x25f0d4['shift']());}catch(_0x28c2ee){_0x25f0d4['push'](_0x25f0d4['shift']());}}}(a29_0xdd0a,0x5110f),require(a29_0x273165(0x1fb))['config']());const {Worker,parentPort}=require(a29_0x273165(0x1d6)),{AbortController}=require(a29_0x273165(0x1e7)),{log,json}=require(a29_0x273165(0x1c5)),Genlogin=require(a29_0x273165(0x1e3)),httpPost=require(a29_0x273165(0x1c7)),PQueue=require('p-queue')['default'];function a29_0x4735(_0x163f92,_0x59c3e1){const _0xdd0ad2=a29_0xdd0a();return a29_0x4735=function(_0x4735a6,_0x59364d){_0x4735a6=_0x4735a6-0x1c5;let _0x342f63=_0xdd0ad2[_0x4735a6];return _0x342f63;},a29_0x4735(_0x163f92,_0x59c3e1);}let profileQueue,genlogin,profileNameId,profileId,browser,http;genlogin=new Genlogin('',!![]),http=new httpPost(process['env'][a29_0x273165(0x1fd)],process[a29_0x273165(0x1f0)][a29_0x273165(0x206)],!![]);let signal={'aborted':![]},firstRun=!![],delayOpenProfile=0xbb8,profileTimeout=0x5265c0,botTimeout=0x5265c0,profileThreads=0x1,maxBotThreads=0x1;parentPort['on']('message',async _0x26fc32=>{const _0x324037=a29_0x273165;try{if(_0x26fc32==='timeout')signal[_0x324037(0x1da)]=!![];else{const {task:_0x483ec1}=_0x26fc32;log(_0x324037(0x1dc)+_0x483ec1[_0x324037(0x1c6)]+_0x324037(0x1ce),null,'w');if(signal[_0x324037(0x1da)])throw new Error(_0x324037(0x1e4));const _0x21ab40=await xuLyTask(_0x483ec1);log('[\x27worker-api1]:\x20'+json(_0x21ab40),null,'w'),!_0x21ab40?parentPort[_0x324037(0x1e2)]({'success':![],'result':_0x21ab40}):parentPort[_0x324037(0x1e2)]({'success':!![],'result':_0x21ab40});}}catch(_0x1504b2){parentPort[_0x324037(0x1e2)]({'success':![],'error':_0x1504b2[_0x324037(0x1ef)]});}});async function xuLyTask(_0x84bb10){const _0x39e5c8=a29_0x273165;try{if(signal['aborted']){log(_0x39e5c8(0x1cd)+_0x84bb10[_0x39e5c8(0x1c6)]+'\x20đã\x20bị\x20hủy\x20trước\x20khi\x20bắt\x20đầu',null,'w');throw new Error(_0x39e5c8(0x1e4));}const _0x1a1107=await genlogin[_0x39e5c8(0x1e5)](),_0x13309c=_0x1a1107[_0x39e5c8(0x1d8)];if(_0x13309c<_0x84bb10[_0x39e5c8(0x1eb)])return log(_0x39e5c8(0x1cd)+JSON[_0x39e5c8(0x1e0)](_0x84bb10[_0x39e5c8(0x1c6)])+'\x20chưa\x20đến\x20thời\x20gian\x20chạy',null,'i'),log(_0x39e5c8(0x1fa)+JSON[_0x39e5c8(0x1e0)](_0x1a1107)+_0x39e5c8(0x1ee)+JSON[_0x39e5c8(0x1e0)](_0x84bb10['nextrun']),null,'w'),log(_0x39e5c8(0x1fa)+JSON[_0x39e5c8(0x1e0)](_0x13309c)+'\x20|\x20nextrun:\x20'+JSON[_0x39e5c8(0x1e0)](taskNextRunDateTime),null,'w'),log(_0x39e5c8(0x1c9),null,'i'),await delay(0x1388),null;let _0x2137c9=await http['getTask'](_0x84bb10[_0x39e5c8(0x1c6)]);if(_0x2137c9[_0x39e5c8(0x201)][_0x39e5c8(0x1f7)][_0x39e5c8(0x1f8)]<=0x0){log(_0x39e5c8(0x1cb),null,![]);throw new Error('No\x20profile\x20found');}firstRun&&(firstRun=![],profileThreads=parseInt(_0x84bb10[_0x39e5c8(0x1f3)]),maxBotThreads=parseInt(_0x84bb10[_0x39e5c8(0x1dd)]),profileQueue=new PQueue({'concurrency':profileThreads}),delayOpenProfile=parseInt(_0x84bb10[_0x39e5c8(0x1d4)])*0x3e8,profileTimeout=parseInt(_0x84bb10[_0x39e5c8(0x1f9)])*0x3e8,botTimeout=parseInt(_0x84bb10[_0x39e5c8(0x1e6)])*0x3e8);const _0x20dd0c=await xuLyProfiles(_0x2137c9[_0x39e5c8(0x201)]['profiles']);if(!_0x20dd0c){log(_0x39e5c8(0x1fc)+json(_0x20dd0c),null,![]);throw new Error(_0x39e5c8(0x20a));}return log(_0x39e5c8(0x1f6)+_0x84bb10[_0x39e5c8(0x1c6)]+_0x39e5c8(0x1d5)),await delay(0x7d0),log(_0x39e5c8(0x1df)+JSON[_0x39e5c8(0x1e0)](_0x84bb10[_0x39e5c8(0x1c6)])),!![];}catch(_0x9afdfe){return log('[xuLyTask]:\x20Lỗi\x20while:\x20'+_0x9afdfe,null,![]),null;}}function a29_0xdd0a(){const _0x4e7d81=['[xuLyTask]:\x20Task\x20',']:\x20Api\x20Mode','32460nTqhxW','[xuLyTungProfile]4:\x20Worker\x20','maxBotThreadsmaxBotThreadsmaxBotThreads','all','\x20đã\x20thoát\x20với\x20mã\x20lỗi\x20','delayOpenProfile','\x20ok','worker_threads','\x20set\x20timeout:\x20','date','[xuLyProfiles]:\x20Đã\x20thêm\x20profile\x20','aborted','2881508GopWDr','[\x27worker-api1][','botThreads','profile\x20','[xuLyTask]:\x20Hoàn\x20thành\x20xử\x20lý\x20task:\x20','stringify','9ouYPHM','postMessage','./modules/Genlogin','timeout','nowTime','botTimeout','abort-controller','[xuLyProfiles]:\x20Đã\x20xử\x20lý\x20tất\x20cả\x20profiles\x20thành\x20công','exit','error','nextrunstamp','9972yvSedT','[xuLyTungProfile]:đã\x20bị\x20hủy','\x20|\x20nextrun:\x20','message','env','[xuLyTungProfile]:\x20Kết\x20thúc\x20worker\x20','8090LiGRUq','profileThreads','[xuLyTungProfile]2:\x20Lỗi\x20xử\x20lý\x20profile\x20','18teltup','[xuLyTask]:\x20Tasks:\x20','profiles','length','profileTimeout','[xuLyTask]:\x20currentDateTime:\x20','dotenv','[xuLyTask]:\x20Không\x20lấy\x20được\x20dữ\x20liệu\x20profiles\x20','SERVER_HOST','[xuLyTungProfile]1:\x20Đã\x20xử\x20lý\x20profile\x20','[xuLyTungProfile]:timeout','[xuLyTungProfile]:profile\x20','value','push','Worker\x20stopped\x20with\x20exit\x20code\x20','[xuLyProfiles]:đã\x20bị\x20hủy','./worker-api2.js','APIKEY','495867gFwfdi','[xuLyTungProfile]:\x20Lỗi:\x20','\x20timed\x20out.','No\x20profile\x20found','3564552XzLppm','16698LIhGIK','./modules/logger','name','./modules/http','[xuLyProfiles]:\x20Task\x20','[xuLyTask]:\x20Chờ\x205\x20giây\x20trước\x20khi\x20xử\x20lý\x20task\x20tiếp\x20theo...','995gzXBJf','[xuLyTask]:\x20không\x20lấy\x20được\x20profile','add'];a29_0xdd0a=function(){return _0x4e7d81;};return a29_0xdd0a();}async function xuLyProfiles(_0x14908f){const _0x3e6ab8=a29_0x273165;try{if(signal[_0x3e6ab8(0x1da)]){log(_0x3e6ab8(0x204),null,'w');throw new Error('timeout');}const _0x383dec=[];for(const _0x4da4d8 of _0x14908f){if(signal[_0x3e6ab8(0x1da)]){log(_0x3e6ab8(0x1c8)+_0x4da4d8+'\x20đã\x20bị\x20hủy',null,'w');throw new Error(_0x3e6ab8(0x1e4));}log('[xuLyProfiles]:\x20Thêm\x20profile\x20'+_0x4da4d8+'\x20vào\x20hàng\x20đợi\x20max:'+profileThreads,null,'i'),_0x383dec[_0x3e6ab8(0x202)](profileQueue[_0x3e6ab8(0x1cc)](()=>xuLyTungProfile(_0x4da4d8))),log(_0x3e6ab8(0x1d9)+_0x4da4d8+'\x20vào\x20hàng\x20đợi.'),await delay(delayOpenProfile);}return await Promise[_0x3e6ab8(0x1d2)](_0x383dec),log(_0x3e6ab8(0x1e8)),!![];}catch(_0x257496){return log('[xuLyProfiles]:\x20Lỗi\x20:\x20'+_0x257496,null,![]),null;}}async function xuLyTungProfile(_0x4f30bd){const _0x29de3d=a29_0x273165;try{let _0x12f3b6={'aborted':![]};log('[xuLyTungProfile]:\x20Đang\x20xử\x20lý\x20profile\x20'+_0x4f30bd,null,'i');if(signal['aborted']){log(_0x29de3d(0x1ed),null,'w'),_0x12f3b6[_0x29de3d(0x1da)]=!![];throw new Error('timeout');}return new Promise((_0x51df77,_0x113c6b)=>{const _0x4b2395=_0x29de3d,_0x44c01b=new Worker(_0x4b2395(0x205)),_0x2bdae7=setTimeout(()=>{const _0x46aaaa=_0x4b2395;_0x44c01b[_0x46aaaa(0x1e2)]({'profile':_0x46aaaa(0x1e4)}),_0x113c6b(new Error(_0x46aaaa(0x1de)+_0x4f30bd+_0x46aaaa(0x209)));},profileTimeout);log(_0x4b2395(0x200)+_0x4f30bd+_0x4b2395(0x1d7)+profileTimeout,null,'w');const _0xb6132b=setInterval(()=>{const _0x2fb811=_0x4b2395;signal[_0x2fb811(0x1da)]&&(log(_0x2fb811(0x1ff),null,'w'),_0x44c01b[_0x2fb811(0x1e2)]({'profile':_0x2fb811(0x1e4)}));},0x1388);if(_0x12f3b6[_0x4b2395(0x1da)]){_0x44c01b[_0x4b2395(0x1e2)](_0x4b2395(0x1e4));throw new Error(_0x4b2395(0x1e4));}log(_0x4b2395(0x1d1)+maxBotThreads),_0x44c01b[_0x4b2395(0x1e2)]({'profile':_0x4f30bd,'maxBot':maxBotThreads}),_0x44c01b['on']('message',_0x1433b9=>{const _0x35f572=_0x4b2395;clearTimeout(_0x2bdae7),clearInterval(_0xb6132b),_0x1433b9['success']?(log(_0x35f572(0x1fe)+_0x4f30bd,null,'i'),_0x51df77(!![])):(log(_0x35f572(0x1f4)+_0x4f30bd+':\x20'+json(_0x1433b9[_0x35f572(0x1ea)]),null,![]),_0x113c6b(_0x1433b9[_0x35f572(0x1ea)])),log(_0x35f572(0x1f1)+_0x4f30bd,null,'w');}),_0x44c01b['on'](_0x4b2395(0x1ea),_0x565cc1=>{clearInterval(_0xb6132b),clearTimeout(_0x2bdae7),log('[xuLyTungProfile]3:\x20Lỗi\x20xử\x20lý\x20profile\x20'+_0x4f30bd+':\x20'+json(_0x565cc1),null,![]),_0x113c6b(_0x565cc1);}),_0x44c01b['on'](_0x4b2395(0x1e9),_0x3e0f83=>{const _0xd3725d=_0x4b2395;clearInterval(_0xb6132b),_0x3e0f83!==0x0&&(log(_0xd3725d(0x1d0)+_0x4f30bd+_0xd3725d(0x1d3)+_0x3e0f83,null,![]),_0x113c6b(new Error(_0xd3725d(0x203)+_0x3e0f83)));});});}catch(_0x8c3b10){clearInterval(intervalId),log(_0x29de3d(0x208)+_0x8c3b10[_0x29de3d(0x1ef)],null,![]);throw _0x8c3b10;}}async function delay(_0x118fed){return new Promise(_0x514e41=>{const _0x19aad3=a29_0x4735;if(signal[_0x19aad3(0x1da)])throw new Error('timeout');setTimeout(_0x514e41,_0x118fed);});}